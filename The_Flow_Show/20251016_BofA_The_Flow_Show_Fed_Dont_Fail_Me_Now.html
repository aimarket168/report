<html lang="zh-Hant"><head><script>(function(firebaseConfig, initialAuthToken, appId) {
        window.__firebase_config = firebaseConfig;
        window.__initial_auth_token = initialAuthToken;
        window.__app_id = appId;
            })("\n{\n  \"apiKey\": \"AIzaSyCqyCcs2R2e7AegGjvFAwG98wlamtbHvZY\",\n  \"authDomain\": \"bard-frontend.firebaseapp.com\",\n  \"projectId\": \"bard-frontend\",\n  \"storageBucket\": \"bard-frontend.firebasestorage.app\",\n  \"messagingSenderId\": \"175205271074\",\n  \"appId\": \"1:175205271074:web:2b7bd4d34d33bf38e6ec7b\"\n}\n","eyJhbGciOiJSUzI1NiIsImtpZCI6IjQ0NGQ3Y2M2NTZhZDVlMDI2NjJkMDIzOTliOWU1YWE4YzkzOGM4YTciLCJ0eXAiOiJKV1QifQ.eyJzdWIiOiJmaXJlYmFzZS1hZG1pbnNkay1mYnN2Y0BiYXJkLWZyb250ZW5kLmlhbS5nc2VydmljZWFjY291bnQuY29tIiwiYXVkIjoiaHR0cHM6Ly9pZGVudGl0eXRvb2xraXQuZ29vZ2xlYXBpcy5jb20vZ29vZ2xlLmlkZW50aXR5LmlkZW50aXR5dG9vbGtpdC52MS5JZGVudGl0eVRvb2xraXQiLCJ1aWQiOiIwMTYyNzg3NDM4ODM1OTc2Mjk5OCIsImlzcyI6ImZpcmViYXNlLWFkbWluc2RrLWZic3ZjQGJhcmQtZnJvbnRlbmQuaWFtLmdzZXJ2aWNlYWNjb3VudC5jb20iLCJjbGFpbXMiOnsiYXBwSWQiOiJjX2YwZWQzMDdlYjZhMDA4MWRfMjAyNTEwMTZfQm9mQV9GbG93X1Nob3dfRk1TX1JlcG9ydC5odG1sLTM2NiJ9LCJleHAiOjE3NjA2OTQ3ODEsImlhdCI6MTc2MDY5MTE4MSwiYWxnIjoiUlMyNTYifQ.LeBAuuAAQSKsygjePSQ-skM0da-CewKwhuWDby2mYUl-oYRPkLfpu6mhaeBI39T3rbAGMaY4RFJzZ6fi8ionP9YDlFGzPSnl-c0NKkz0mdTi4CyBx0k4eAu9OFvbbsP6df-xGfrsZnKMDVXg5uVBa7hexRyZoNNnDGWNGkfdaKtekc4j9DQyfP_TVUjthdAEKrBZ9hyi8djYdo-o9k2Ca7xjeH8PJI2FaoXQ6ohWTsNdwTQ6l13kEuNalqlnegpUghCerCYjKYTWruYPifNoeVY_6TCPTtREXKid5JkNr-G56mmGznwrACNsO5JL5GwZU6haRhmw3-Y14FFJWBC1ZA","c_f0ed307eb6a0081d_20251016_BofA_Flow_Show_FMS_Report.html-366")</script><script>'use strict';var h=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,b,d){if(a==Array.prototype||a==Object.prototype)return a;a[b]=d.value;return a};function l(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var d=a[b];if(d&&d.Math==Math)return d}throw Error("Cannot find global object");}var n=l(this);
function p(a,b){if(b)a:{var d=n;a=a.split(".");for(var c=0;c<a.length-1;c++){var e=a[c];if(!(e in d))break a;d=d[e]}a=a[a.length-1];c=d[a];b=b(c);b!=c&&b!=null&&h(d,a,{configurable:!0,writable:!0,value:b})}}function r(a){function b(c){return a.next(c)}function d(c){return a.throw(c)}return new Promise(function(c,e){function f(g){g.done?c(g.value):Promise.resolve(g.value).then(b,d).then(f,e)}f(a.next())})}function t(a){return r(a())}
p("Object.values",function(a){return a?a:function(b){var d=[],c;for(c in b)Object.prototype.hasOwnProperty.call(b,c)&&d.push(b[c]);return d}});p("Array.prototype.includes",function(a){return a?a:function(b,d){var c=this;c instanceof String&&(c=String(c));var e=c.length;d=d||0;for(d<0&&(d=Math.max(d+e,0));d<e;d++){var f=c[d];if(f===b||Object.is(f,b))return!0}return!1}});/*

 MIT License

 Copyright (c) 2017-2023 W.Y.

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in
 all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 SOFTWARE.

*/
function u(a,b){const d=a.style;b.backgroundColor&&(d.backgroundColor=b.backgroundColor);b.width&&(d.width=`${b.width}px`);b.height&&(d.height=`${b.height}px`);const c=b.style;c!=null&&Object.keys(c).forEach(e=>{d[e]=c[e]})};var v=(()=>{let a=0;return()=>{a+=1;return`u${`0000${(Math.random()*1679616<<0).toString(36)}`.slice(-4)}${a}`}})();function w(a){const b=[];for(let d=0,c=a.length;d<c;d++)b.push(a[d]);return b}let x=null;function y(a={}){return x?x:a.l?x=a.l:x=w(window.getComputedStyle(document.documentElement))}function z(a,b){return(a=(a.ownerDocument.defaultView||window).getComputedStyle(a).getPropertyValue(b))?parseFloat(a.replace("px","")):0}
function A(a,b={}){var d;if(!(d=b.width)){d=z(a,"border-left-width");var c=z(a,"border-right-width");d=a.clientWidth+d+c}(b=b.height)||(b=z(a,"border-top-width"),c=z(a,"border-bottom-width"),b=a.clientHeight+b+c);return{width:d,height:b}}function B(a){return new Promise((b,d)=>{const c=new Image;c.onload=()=>{c.decode().then(()=>{requestAnimationFrame(()=>b(c))})};c.onerror=d;c.crossOrigin="anonymous";c.decoding="async";c.src=a})}
function C(a){return t(function*(){return Promise.resolve().then(()=>(new XMLSerializer).serializeToString(a)).then(encodeURIComponent).then(b=>`data:image/svg+xml;charset=utf-8,${b}`)})}
function D(a,b,d){return t(function*(){const c=document.createElementNS("http://www.w3.org/2000/svg","svg"),e=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");c.setAttribute("width",`${b}`);c.setAttribute("height",`${d}`);c.setAttribute("viewBox",`0 0 ${b} ${d}`);e.setAttribute("width","100%");e.setAttribute("height","100%");e.setAttribute("x","0");e.setAttribute("y","0");e.setAttribute("externalResourcesRequired","true");c.appendChild(e);e.appendChild(a);return C(c)})}
var E=(a,b)=>{if(a instanceof b)return!0;a=Object.getPrototypeOf(a);return a===null?!1:a.constructor.name===b.name||E(a,b)};function F(a,b){return y(b).map(d=>{const c=a.getPropertyValue(d),e=a.getPropertyPriority(d);return`${d}: ${c}${e?" !important":""};`}).join(" ")}
function G(a,b,d,c){a=window.getComputedStyle(a,d);var e=a.getPropertyValue("content");if(e!==""&&e!=="none"){var f=v();try{b.className=`${b.className} ${f}`}catch(k){return}e=document.createElement("style");var g=e.appendChild;d=`.${f}:${d}`;a.cssText?(c=a.getPropertyValue("content"),c=`${a.cssText} content: '${c.replace(/'|"/g,"")}';`):c=F(a,c);g.call(e,document.createTextNode(`${d}{${c}}`));b.appendChild(e)}};function H(a){return a.search(/^(data:)/)!==-1}function I(a,b,d){return t(function*(){const c=yield fetch(a,b);if(c.status===404)throw Error(`Resource "${c.url}" not found`);const e=yield c.blob();return new Promise((f,g)=>{const k=new FileReader;k.onerror=g;k.onloadend=()=>{try{f(d({o:c,result:k.result}))}catch(m){g(m)}};k.readAsDataURL(e)})})}const J={};function K(a,b,d){let c=a.replace(/\?.*/,"");d&&(c=a);/ttf|otf|eot|woff2?/i.test(c)&&(c=c.replace(/.*\//,""));return b?`[${b}]${c}`:c}
function L(a,b,d){return t(function*(){const c=K(a,b,d.C);if(J[c]!=null)return J[c];d.u&&(a+=(/\?/.test(a)?"&":"?")+(new Date).getTime());let e;try{const f=yield I(a,d.i,({o:g,result:k})=>{b||(b=g.headers.get("Content-Type")||"");return k.split(/,/)[1]});e=`data:${b};base64,${f}`}catch(f){e=d.B||""}return J[c]=e})};const M={P:"application/font-woff",R:"application/font-woff",N:"application/font-truetype",v:"application/vnd.ms-fontobject",H:"image/png",F:"image/jpeg",D:"image/jpeg",A:"image/gif",M:"image/tiff",L:"image/svg+xml",O:"image/webp"};function N(a){return(a=/\.([^./]*?)$/g.exec(a))?a[1]:""};function O(a){return t(function*(){const b=a.toDataURL();return b==="data:,"?a.cloneNode(!1):B(b)})}function aa(a,b){return t(function*(){if(a.currentSrc){var d=document.createElement("canvas");const c=d.getContext("2d");d.width=a.clientWidth;d.height=a.clientHeight;c==null||c.drawImage(a,0,0,d.width,d.height);d=d.toDataURL();return B(d)}d=a.poster;d=yield L(d,M[N(d).toLowerCase()]||"",b);return B(d)})}
function ba(a,b){return t(function*(){try{let d;if(a==null?0:(d=a.contentDocument)==null?0:d.body)return yield P(a.contentDocument.body,b,!0)}catch(d){}return a.cloneNode(!1)})}function ca(a,b){return t(function*(){return E(a,HTMLCanvasElement)?O(a):E(a,HTMLVideoElement)?aa(a,b):E(a,HTMLIFrameElement)?ba(a,b):a.cloneNode(a.tagName!=null&&a.tagName.toUpperCase()==="SVG")})}
function da(a,b,d){return t(function*(){if(b.tagName!=null&&b.tagName.toUpperCase()==="SVG")return b;let c=[];if(a.tagName!=null&&a.tagName.toUpperCase()==="SLOT"&&a.assignedNodes)c=w(a.assignedNodes());else{let e;if(E(a,HTMLIFrameElement)&&((e=a.contentDocument)==null?0:e.body))c=w(a.contentDocument.body.childNodes);else{let f;c=w(((f=a.shadowRoot)!=null?f:a).childNodes)}}if(c.length===0||E(a,HTMLVideoElement))return b;yield c.reduce((e,f)=>e.then(()=>P(f,d)).then(g=>{g&&b.appendChild(g)}),Promise.resolve());
return b})}function ea(a,b,d){const c=b.style;if(c){var e=window.getComputedStyle(a);e.cssText?(c.cssText=e.cssText,c.transformOrigin=e.transformOrigin):y(d).forEach(f=>{let g=e.getPropertyValue(f);f==="font-size"&&g.endsWith("px")&&(g=`${Math.floor(parseFloat(g.substring(0,g.length-2)))-.1}px`);E(a,HTMLIFrameElement)&&f==="display"&&g==="inline"&&(g="block");f==="d"&&b.getAttribute("d")&&(g=`path(${b.getAttribute("d")})`);c.setProperty(f,g,e.getPropertyPriority(f))})}}
function fa(a,b){E(a,HTMLSelectElement)&&(b=Array.from(b.children).find(d=>a.value===d.getAttribute("value")))&&b.setAttribute("selected","")}
function ha(a,b){return t(function*(){var d=a.querySelectorAll?a.querySelectorAll("use"):[];if(d.length===0)return a;var c={};for(var e=0;e<d.length;e++){var f=d[e].getAttribute("xlink:href");if(f){const g=document.querySelector(f);a.querySelector(f)||!g||c[f]||(c[f]=yield P(g,b,!0))}}d=Object.values(c);if(d.length){c=document.createElementNS("http://www.w3.org/1999/xhtml","svg");c.setAttribute("xmlns","http://www.w3.org/1999/xhtml");c.style.position="absolute";c.style.width="0";c.style.height="0";
c.style.overflow="hidden";c.style.display="none";e=document.createElementNS("http://www.w3.org/1999/xhtml","defs");c.appendChild(e);for(f=0;f<d.length;f++)e.appendChild(d[f]);a.appendChild(c)}return a})}
function P(a,b,d){return t(function*(){return d||!b.filter||b.filter(a)?Promise.resolve(a).then(c=>ca(c,b)).then(c=>da(a,c,b)).then(c=>{E(c,Element)&&(ea(a,c,b),G(a,c,":before",b),G(a,c,":after",b),E(a,HTMLTextAreaElement)&&(c.textContent=a.value),E(a,HTMLInputElement)&&c.setAttribute("value",a.value),fa(a,c));return c}).then(c=>ha(c,b)):null})};const Q=/url\((['"]?)([^'"]+?)\1\)/g,ia=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,ja=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function ka(a){const b=[];a.replace(Q,(d,c,e)=>{b.push(e);return d});return b.filter(d=>!H(d))}
function la(a,b,d,c){return t(function*(){try{const e=d?(new URL(b,d||void 0)).toString():b;let f;f=yield L(e,M[N(b).toLowerCase()]||"",c);return a.replace(new RegExp(`(url\\(['"]?)(${b.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")})(['"]?\\))`,"g"),`$1${f}$3`)}catch(e){}return a})}function ma(a,{I:b}){return b?a.replace(ja,d=>{for(;;){const [c,,e]=ia.exec(d)||[],f=c,g=e;if(!g)return"";if(g===b)return`src: ${f};`}}):a}
function R(a,b,d){return t(function*(){if(a.search(Q)===-1)return a;const c=ma(a,d);return ka(c).reduce((e,f)=>e.then(g=>la(g,f,b,d)),Promise.resolve(c))})};function S(a,b,d){return t(function*(){var c;const e=(c=b.style)==null?void 0:c.getPropertyValue(a);return e?(c=yield R(e,null,d),b.style.setProperty(a,c,b.style.getPropertyPriority(a)),!0):!1})}function na(a,b){return t(function*(){(yield S("background",a,b))||(yield S("background-image",a,b));(yield S("mask",a,b))||(yield S("-webkit-mask",a,b))||(yield S("mask-image",a,b))||(yield S("-webkit-mask-image",a,b))})}
function oa(a,b){return t(function*(){const d=E(a,HTMLImageElement);if(d&&!H(a.src)||E(a,SVGImageElement)&&!H(a.href.baseVal)){var c=d?a.src:a.href.baseVal,e=yield L(c,M[N(c).toLowerCase()]||"",b);yield new Promise((f,g)=>{a.onload=f;a.onerror=b.m?(...k)=>{try{f(b.m(...k))}catch(m){g(m)}}:g;a.decode&&(a.decode=f);a.loading==="lazy"&&(a.loading="eager");d?(a.srcset="",a.src=e):a.href.baseVal=e})}})}
function pa(a,b){return t(function*(){const d=w(a.childNodes).map(c=>T(c,b));yield Promise.all(d).then(()=>a)})}function T(a,b){return t(function*(){E(a,Element)&&(yield na(a,b),yield oa(a,b),yield pa(a,b))})};const U={};function V(a){return t(function*(){var b=U[a];if(b!=null)return b;b=yield(yield fetch(a)).text();b={url:a,cssText:b};return U[a]=b})}function W(a,b){return t(function*(){let d=a.cssText;const c=/url\(["']?([^"')]+)["']?\)/g,e=(d.match(/url\([^)]+\)/g)||[]).map(f=>t(function*(){let g=f.replace(c,"$1");g.startsWith("https://")||(g=(new URL(g,a.url)).href);return I(g,b.i,({result:k})=>{d=d.replace(f,`url(${k})`);return[f,k]})}));return Promise.all(e).then(()=>d)})}
function X(a){if(a==null)return[];const b=[];a=a.replace(/(\/\*[\s\S]*?\*\/)/gi,"");for(var d=RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");;){var c=d.exec(a);if(c===null)break;b.push(c[0])}a=a.replace(d,"");d=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi;for(c=RegExp("((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})","gi");;){let e=d.exec(a);if(e===null)if(e=c.exec(a),e===null)break;else d.lastIndex=c.lastIndex;else c.lastIndex=
d.lastIndex;b.push(e[0])}return b}
function qa(a,b){return t(function*(){const d=[],c=[];a.forEach(e=>{if("cssRules"in e)try{w(e.cssRules||[]).forEach((f,g)=>{if(f.type===CSSRule.IMPORT_RULE){let k=g+1;f=V(f.href).then(m=>W(m,b)).then(m=>X(m).forEach(q=>{try{e.insertRule(q,q.startsWith("@import")?k+=1:e.cssRules.length)}catch(Da){}})).catch(()=>{});c.push(f)}})}catch(f){const g=a.find(k=>k.href==null)||document.styleSheets[0];e.href!=null&&c.push(V(e.href).then(k=>W(k,b)).then(k=>X(k).forEach(m=>{g.insertRule(m,g.cssRules.length)})).catch(()=>
{}))}});return Promise.all(c).then(()=>{a.forEach(e=>{if("cssRules"in e)try{w(e.cssRules||[]).forEach(f=>{d.push(f)})}catch(f){}});return d})})}function ra(a){return a.filter(b=>b.type===CSSRule.FONT_FACE_RULE).filter(b=>b.style.getPropertyValue("src").search(Q)!==-1)}function sa(a,b){return t(function*(){if(a.ownerDocument==null)throw Error("Provided element is not within a Document");var d=w(a.ownerDocument.styleSheets);d=yield qa(d,b);return ra(d)})}
function ta(a){function b(c){(c.style.fontFamily||getComputedStyle(c).fontFamily).split(",").forEach(e=>{d.add(e.trim().replace(/["']/g,""))});Array.from(c.children).forEach(e=>{e instanceof HTMLElement&&b(e)})}const d=new Set;b(a);return d}function ua(a,b){return t(function*(){const d=yield sa(a,b),c=ta(a);return(yield Promise.all(d.filter(e=>c.has(e.style.fontFamily.trim().replace(/["']/g,""))).map(e=>R(e.cssText,e.parentStyleSheet?e.parentStyleSheet.href:null,b)))).join("\n")})}
function va(a,b){return t(function*(){const d=b.j!=null?b.j:b.K?null:yield ua(a,b);if(d){const c=document.createElement("style");c.appendChild(document.createTextNode(d));a.firstChild?a.insertBefore(c,a.firstChild):a.appendChild(c)}})};function wa(a,b={}){return t(function*(){const {width:d,height:c}=A(a,b),e=yield P(a,b,!0);yield va(e,b);yield T(e,b);u(e,b);return yield D(e,d,c)})}
function xa(a,b={}){return t(function*(){const {width:d,height:c}=A(a,b);var e=yield wa(a,b);e=yield B(e);const f=document.createElement("canvas"),g=f.getContext("2d"),k=b.G||window.devicePixelRatio||1,m=b.h||d,q=b.g||c;f.width=m*k;f.height=q*k;!b.J&&(f.width>16384||f.height>16384)&&(f.width>16384&&f.height>16384?f.width>f.height?(f.height*=16384/f.width,f.width=16384):(f.width*=16384/f.height,f.height=16384):f.width>16384?(f.height*=16384/f.width,f.width=16384):(f.width*=16384/f.height,f.height=
16384));f.style.width=`${m}`;f.style.height=`${q}`;b.backgroundColor&&(g.fillStyle=b.backgroundColor,g.fillRect(0,0,f.width,f.height));g.drawImage(e,0,0,f.width,f.height);return f})}function ya(a,b={}){return t(function*(){return(yield xa(a,b)).toDataURL()})};const za=["gemini.google.com","corp.google.com","proxy.googlers.com"];function Y(){return document.body.querySelectorAll('[class*="animate"]').length>0}function Z(a){return t(function*(){try{return yield ya(a,{h:a.offsetWidth,g:a.offsetHeight})}catch(d){var b=a.offsetHeight;const c=document.createElement("canvas");c.width=a.offsetWidth;c.height=b;return c.toDataURL("image/png")}})}
function Aa(){return t(function*(){const a=document.body.offsetWidth,b=document.body.offsetHeight,d=document.body.cloneNode(!0);d.querySelectorAll('[class*="animate"]').forEach(c=>{c.classList.remove(...Array.from(c.classList).filter(e=>e.startsWith("animate")))});d.style.width=`${a}px`;d.style.height=`${b}px`;return d})}
function Ba(a){return t(function*(){let b=document.body;if(Y()){var d=yield Aa();b=d;document.body.appendChild(d)}d=yield Z(b);Y()&&document.body.removeChild(b);window.parent.postMessage({type:"SEND_SCREENSHOT",image:d,topOffset:document.documentElement.scrollTop},a.origin)})}function Ca(a){return t(function*(){const b={type:"SEND_SCREENSHOT_FOR_DATA_VISUALIZATION",image:yield Z(document.body),topOffset:0};window.parent.postMessage(b,a.origin)})}
window.addEventListener("message",a=>t(function*(){if(za.some(d=>a.origin.includes(d))){var b=a.data;b&&(b.type==="MAKE_SCREENSHOT"&&(yield Ba(a)),b.type==="MAKE_SCREENSHOT_FOR_DATA_VISUALIZATION"&&(yield Ca(a)))}}));
</script><script>(function() {
  // Ensure this script is executed only once
  if (window.firebaseAuthBridgeScriptLoaded) {
    return;
  }
  window.firebaseAuthBridgeScriptLoaded = true;

  let nextTokenPromiseId = 0;

  // Stores { resolve, reject } for ongoing token requests
  const pendingTokenPromises = {};

  // Listen for messages from the Host Application
  window.addEventListener('message', function(event) {

    const messageData = event.data;

  if (messageData && messageData.type === 'RESOLVE_NEW_FIREBASE_TOKEN') {
      const { success, token, error, promiseId } = messageData ?? {};
      if (pendingTokenPromises[promiseId]) {
        if (success) {
          pendingTokenPromises[promiseId].resolve(token);
        } else {
          pendingTokenPromises[promiseId].reject(new Error(error || 'Token refresh failed from host.'));
        }
        delete pendingTokenPromises[promiseId];
      }
    }
  });

  // Expose a function for the Generated App to request a new Firebase token
  window.requestNewFirebaseToken = function() {
    const currentPromiseId = nextTokenPromiseId++;
    const promise = new Promise((resolve, reject) => {
      pendingTokenPromises[currentPromiseId] = { resolve, reject };
    });
    if (window.parent && window.parent !== window) {
      window.parent.postMessage({
        type: 'REQUEST_NEW_FIREBASE_TOKEN',
        promiseId: currentPromiseId
      }, '*');
    } else {
      pendingTokenPromises[currentPromiseId].reject(new Error('No parent window to request token from.'));
      delete pendingTokenPromises[currentPromiseId];
    }
    return promise;
  };
})();</script><script>
let realOriginalGetUserMedia = null;
if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
  realOriginalGetUserMedia = navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);
}

(function() {
  if (navigator.mediaDevices && navigator.mediaDevices.__proto__) {
    try {
      Object.defineProperty(navigator.mediaDevices.__proto__, 'getUserMedia', {
        get: function() {
          return undefined; // Or throw an error
        },
        configurable: false
      });
    } catch (error) {
      console.error("Error defining prototype getter:", error);
    }
  }
})();

(function() {
  const pendingMediaResolvers = {};
  let nextMediaPromiseId = 0;

  function requestMediaPermissions(constraints) {
    const mediaPromiseId = nextMediaPromiseId++;
    const promise = new Promise((resolve, reject) => {
      pendingMediaResolvers[mediaPromiseId] = (granted) => {
        delete pendingMediaResolvers[mediaPromiseId];
        resolve(granted);
      };
    });

    window.parent.postMessage({
      type: 'requestMediaPermission',
      constraints: constraints,
      promiseId: mediaPromiseId,
    }, '*');

    return promise;
  }

  let originalGetUserMedia = realOriginalGetUserMedia;

  function interceptGetUserMedia() {
    if (navigator.mediaDevices) {
      Object.defineProperty(navigator.mediaDevices, 'getUserMedia', {
        value: function(constraints) {
          return requestMediaPermissions(constraints).then((granted) => {
            if (granted) {
              if (originalGetUserMedia) {
                return originalGetUserMedia(constraints);
              } else {
                throw new Error("Original getUserMedia not available.");
              }
            } else {
              throw new DOMException('Permission denied', 'NotAllowedError');
            }
          });
        },
        writable: false,
        configurable: false
      });
    }
  }

  interceptGetUserMedia();

  const observer = new MutationObserver(function(mutationsList, observer) {
    for (const mutation of mutationsList) {
      if (mutation.type === 'reconfigured' && mutation.name === 'getUserMedia' && mutation.object === navigator.mediaDevices) {
        interceptGetUserMedia();
      } else if (mutation.type === 'attributes' && mutation.attributeName === 'getUserMedia' && mutation.target === navigator.mediaDevices) {
        interceptGetUserMedia();
      } else if (mutation.type === 'childList' && mutation.addedNodes) {
        mutation.addedNodes.forEach(node => {
          if (node === navigator.mediaDevices) {
            interceptGetUserMedia();
          }
        });
      }
    }
  });

  function interceptSpeechRecognition() {
    if (!window.SpeechRecognition && !window.webkitSpeechRecognition) {
      return;
    }

    const OriginalSpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;

    const SpeechRecognitionWrapper = function(...args) {
      const recognizer = new OriginalSpeechRecognition(...args);
      const originalStart = recognizer.start.bind(recognizer);

      recognizer.start = function() {
        requestMediaPermissions({ audio: true }).then(granted => {
          if (granted) {
            originalStart();
          } else {
            const errorEvent = new SpeechRecognitionErrorEvent('error');
            errorEvent.error = 'not-allowed'; // This is the standard error for permission denial.
            recognizer.dispatchEvent(errorEvent);
          }
        });
      };

      return recognizer;
    };

    SpeechRecognitionWrapper.prototype = OriginalSpeechRecognition.prototype;
    SpeechRecognitionWrapper.prototype.constructor = SpeechRecognitionWrapper;

    if (window.SpeechRecognition) {
      window.SpeechRecognition = SpeechRecognitionWrapper;
    }
    if (window.webkitSpeechRecognition) {
      window.webkitSpeechRecognition = SpeechRecognitionWrapper;
    }
  }

  interceptSpeechRecognition();

  window.addEventListener('message', function(event) {
    if (event.data) {
      if (event.data.type === 'resolveMediaPermission') {
        const { promiseId, granted } = event.data;
        if (pendingMediaResolvers[promiseId]) {
          pendingMediaResolvers[promiseId](granted);
        }
      }
    }
  });

})();</script><script>((function(modelInformation) {
  const originalFetch = window.fetch;
  // TODO: b/421908508 - Move these out of the script and match all generative AI model calls.
  let googleLlmBaseApiUrls = [
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.textModelName + ':streamGenerateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.textModelName + ':generateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageModelName + ':predict',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageModelName + ':predictLongRunning',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageEditModelName + ':generateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.videoModelName + ':predict',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.videoModelName + ':predictLongRunning',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.ttsModelName + ':generateContent',
  ];
  modelInformation.deprecatedTextModelNames.forEach((modelName) => {
    googleLlmBaseApiUrls.push(
      'https://generativelanguage.googleapis.com/v1beta/models/' + modelName + ':streamGenerateContent',
      'https://generativelanguage.googleapis.com/v1beta/models/' + modelName + ':generateContent',
    );
  });

  const pendingFetchResolvers = {};
  let nextPromiseId = 0;

  function handleStringInput(input, optionsArgument) {
    const actualUrl = input;
    const fetchCallArgs = [actualUrl, optionsArgument];
    const effectiveOptions = optionsArgument || {};
    const bodyForApiKeyCheck = effectiveOptions.body;
    const bodyForPostMessage = effectiveOptions.body;
    return { actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage };
  }

  function handleRequestInput(input, optionsArgument) {
    const actualUrl = input.url;
    const fetchCallArgs = [input, optionsArgument];
    const effectiveOptions = { method: input.method, headers: new Headers(input.headers) };
    let bodyForApiKeyCheck;
    let bodyForPostMessage;

    if (optionsArgument) {
      if (optionsArgument.method) effectiveOptions.method = optionsArgument.method;
      if (optionsArgument.headers) effectiveOptions.headers = new Headers(optionsArgument.headers);
      if ('body' in optionsArgument) {
        bodyForApiKeyCheck = optionsArgument.body;
        bodyForPostMessage = optionsArgument.body;
      } else {
        bodyForApiKeyCheck = undefined;
        bodyForPostMessage = input.body;
      }
    } else {
      bodyForApiKeyCheck = undefined;
      bodyForPostMessage = input.body;
    }
    return { actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage };
  }

  window.fetch = function(input, optionsArgument) {
    let actualUrl;
    let fetchCallArgs;
    let effectiveOptions = {};
    let bodyForApiKeyCheck;
    let bodyForPostMessage;

    if (typeof input === 'string') {
      ({actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage} = handleStringInput(input, optionsArgument));
    } else if (input instanceof Request) {
      ({actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage} = handleRequestInput(input, optionsArgument));
    } else {
      return originalFetch.apply(window, [input, optionsArgument]);
    }

    effectiveOptions.method = effectiveOptions.method || 'GET';
    if (!effectiveOptions.headers) {
      effectiveOptions.headers = new Headers();
    }


    if (typeof actualUrl === 'string' && googleLlmBaseApiUrls.some((url) => actualUrl.startsWith(url))) {
      let apiKeyIsNull = true;

      const regex = new RegExp("models/([^:]+)");
      const modelNameMatch = actualUrl.match(regex);
      const modelName = modelNameMatch ? modelNameMatch[1] : 'unspecified';


      try {
        const urlObject = new URL(actualUrl);  // Use URL object for robust parsing
        const apiKeyParam = urlObject.searchParams.get('key');
        if (apiKeyParam) {
          apiKeyIsNull = false;
        }
      } catch (e) {
        // Continue checks even if URL parsing fails
      }

      if (apiKeyIsNull && effectiveOptions.headers) {
        const h = new Headers(effectiveOptions.headers);
        const apiKeyHeaderValue = h.get('X-API-Key') || h.get('x-api-key');
        if (apiKeyHeaderValue) {
          apiKeyIsNull = false;
          return originalFetch.apply(window, fetchCallArgs);
        }
      }

      if (apiKeyIsNull && effectiveOptions.method && ['POST', 'PUT', 'PATCH'].includes(effectiveOptions.method.toUpperCase()) && typeof bodyForApiKeyCheck === 'string') {
        try {
          const bodyData = JSON.parse(bodyForApiKeyCheck);
          if (bodyData && bodyData.apiKey) {
            apiKeyIsNull = false;
            return originalFetch.apply(window, fetchCallArgs);
          }
        } catch (e) {
          // Ignore JSON parsing errors
        }
      }

      if(apiKeyIsNull) {
        const promiseId = nextPromiseId++;
        const promise = new Promise((resolve) => {
          pendingFetchResolvers[promiseId] = (resolvedResponse) => {
            delete pendingFetchResolvers[promiseId];
            resolve(resolvedResponse);
          };
        });

        let serializedBodyForPostMessage;
        if (typeof bodyForPostMessage === 'string' || bodyForPostMessage == null) {
            serializedBodyForPostMessage = bodyForPostMessage;
        } else if (bodyForPostMessage instanceof ReadableStream) {
            serializedBodyForPostMessage = null;
        } else {
            try {
                serializedBodyForPostMessage = JSON.stringify(bodyForPostMessage);
            } catch (e) {
                serializedBodyForPostMessage = null;
            }
        }

        const messageOptions = {
            method: effectiveOptions.method,
            headers: Object.fromEntries(new Headers(effectiveOptions.headers).entries()),
            body: serializedBodyForPostMessage
        };

        window.parent.postMessage({
          type: 'requestFetch',
          url: actualUrl,
          modelName: modelName,
          options: messageOptions,
          promiseId: promiseId,
        }, '*');

        return promise;
      }
      return originalFetch.apply(window, fetchCallArgs);
    }
    return originalFetch.apply(window, fetchCallArgs);
  };

  window.addEventListener('message', function(event) {
    if (event.data && event.data.type === 'resolveFetch') {
      const { promiseId, response } = event.data;
      if (pendingFetchResolvers[promiseId]) {
        try {
          const reconstructedResponse = new Response(response.body, {
            status: response.status,
            statusText: response.statusText,
            headers: new Headers(response.headers),
          });
          pendingFetchResolvers[promiseId](reconstructedResponse);
        } catch (error) {
          pendingFetchResolvers[promiseId](new Response(null, { status: 500, statusText: "Interceptor Response Reconstruction Error" }));
        }
      }
    }
  });

}))({"textModelName":"gemini-2.5-flash-preview-09-2025","imageModelName":"imagen-3.0-generate-002","imageEditModelName":"gemini-2.5-flash-image-preview","videoModelName":"veo-2.0-generate-001","ttsModelName":"gemini-2.5-flash-preview-tts","deprecatedTextModelNames":["gemini-2.0-flash","gemini-2.5-flash-preview-04-17","gemini-2.5-flash-preview-05-20"]})</script><script>(function() {
  const originalConsoleLog = console.log;
  const originalConsoleError = console.error;

    /**
   * Normalizes an error event or a promise rejection reason into a structured error object.
   * @param {*} errorEventOrReason The error object or reason.
   * @return {object} Structured error data { message, name, stack }.
   */
  function getErrorObject(errorEventOrReason) {
    if (errorEventOrReason instanceof Error) {
      return {
        message: errorEventOrReason.message,
        name: errorEventOrReason.name,
        stack: errorEventOrReason.stack,
      };
    }
    // Fallback for non-Error objects.
    try {
      return {
        message: JSON.stringify(errorEventOrReason),
        name: 'UnknownErrorType',
        stack: null,
      };
    } catch (e) {
      return {
        message: String(errorEventOrReason),
        name: 'UnknownErrorTypeNonStringifiable',
        stack: null,
      };
    }
  }

  /**
   * Converts an array of arguments (from log/error) into a single string.
   * Handles Error objects specially to include their message and stack.
   * @param {Array<*>} args - Arguments passed to console methods.
   * @return {string} A string representation of the arguments.
   */
  function stringifyArgs(args) {
    return args
      .map((arg) => {
        if (arg instanceof Error) {
          const {message, stack} = arg;
          return `Error: ${message}${stack ? ('\nStack: ' + stack) : ''}`;
        }
        if (typeof arg === 'object' && arg !== null) {
          try {
            return JSON.stringify(arg);
          } catch (error) {
            return '[Circular Object]';
          }
        } else {
          return String(arg);
        }
      })
      .join(' ');
  }

  console.log = function(...args) {
    const logString = stringifyArgs(args);
    window.parent.postMessage({ type: 'log', message: logString }, '*');
    originalConsoleLog.apply(console, args);
  };

  console.error = function(...args) {
    let errorData;
    if (args.length > 0 && args[0] instanceof Error) {
      const err = args[0];
      // If the first arg is an Error, capture its details.
      errorData = {
        type: 'error',
        source: 'CONSOLE_ERROR',
        ...getErrorObject(err),
        rawArgsString: stringifyArgs(args.slice(1)),
        timestamp: new Date().toISOString(),
      };
    } else {
      // If not an Error object, treat all args as a general error message.
      errorData = {
        type: 'error',
        source: 'CONSOLE_ERROR',
        message: stringifyArgs(args),
        name: 'ConsoleLoggedError',
        stack: null,
        timestamp: new Date().toISOString(),
      };
    }
    window.parent.postMessage(errorData, '*');
    originalConsoleError.apply(console, args);
  };

  // Listen for global unhandled synchronous errors.
  window.addEventListener('error', function(event) {
    const errorDetails = event.error ? getErrorObject(event.error) : {
      message: event.message,
      name: 'GlobalError',
      stack: null,
      filename: event.filename,
      lineno: event.lineno,
      colno: event.colno,
    };

    window.parent.postMessage({
      type: 'error',
      source: 'global',
      ...errorDetails,
      message: errorDetails.message || event.message,
      timestamp: new Date().toISOString(),
    }, '*');
  });

  // Listen for unhandled promise rejections (asynchronous errors).
  window.addEventListener('unhandledrejection', function(event) {
    const errorDetails = getErrorObject(event.reason);

    window.parent.postMessage({
      type: 'error',
      source: 'unhandledrejection',
      ...errorDetails,
      message: errorDetails.message || 'Unhandled Promise Rejection',
      timestamp: new Date().toISOString(),
    }, '*');
  });

})();</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BofA資金流向報告_市場情緒兩極化：貪婪與恐懼的拉鋸戰</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0" crossorigin="anonymous"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&amp;display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #FDFBF7;
            color: #3C3633;
        }
        .card-shadow {
             box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        }
        h2.story-title {
            text-align: center;
            font-size: 1.875rem;
            line-height: 2.25rem;
            font-weight: 700;
            color: #655A4E;
            margin-bottom: 1.5rem;
            border-bottom: 2px solid #C8B6A6;
            padding-bottom: 1rem;
        }
        h3 {
            border-bottom: 2px solid #EAE0D5;
            padding-bottom: 0.5rem;
            margin-top: 2rem;
            margin-bottom: 1rem;
            font-size: 1.25rem;
            font-weight: 700;
            color: #8D7B68;
        }
        .chart-container {
            position: relative;
            width: 100%;
            margin: 1.5rem auto;
        }
        .gauge-chart-container {
            position: relative;
            width: 100%;
            max-width: 350px;
            margin: 0 auto;
            height: 175px;
            margin-bottom: 1rem;
        }
        .pulse-item {
            background-color: #F9F6F2;
            padding: 1rem;
            border-radius: 0.5rem;
            border-left: 4px solid #C8B6A6;
        }
        .emphasis {
            background-color: #FFF8E1;
            padding: 1rem;
            border-left: 4px solid #FFC107;
            border-radius: 0.25rem;
            margin: 1.5rem 0;
        }
        .download-btn {
            position: fixed;
            bottom: 1.5rem;
            right: 1.5rem;
            z-index: 50;
        }
    </style>
<style>*, ::before, ::after{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }/* ! tailwindcss v3.4.17 | MIT License | https://tailwindcss.com */*,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}::after,::before{--tw-content:''}:host,html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}.container{width:100%}@media (min-width: 640px){.container{max-width:640px}}@media (min-width: 768px){.container{max-width:768px}}@media (min-width: 1024px){.container{max-width:1024px}}@media (min-width: 1280px){.container{max-width:1280px}}@media (min-width: 1536px){.container{max-width:1536px}}.mx-auto{margin-left:auto;margin-right:auto}.mb-10{margin-bottom:2.5rem}.mb-12{margin-bottom:3rem}.mb-4{margin-bottom:1rem}.mb-6{margin-bottom:1.5rem}.mb-8{margin-bottom:2rem}.mt-1{margin-top:0.25rem}.mt-12{margin-top:3rem}.mt-2{margin-top:0.5rem}.mt-8{margin-top:2rem}.grid{display:grid}.h-6{height:1.5rem}.h-80{height:20rem}.h-96{height:24rem}.w-6{width:1.5rem}.max-w-7xl{max-width:80rem}.grid-cols-1{grid-template-columns:repeat(1, minmax(0, 1fr))}.gap-8{gap:2rem}.space-y-4 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(1rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1rem * var(--tw-space-y-reverse))}.rounded-full{border-radius:9999px}.rounded-lg{border-radius:0.5rem}.bg-\[\#655A4E\]{--tw-bg-opacity:1;background-color:rgb(101 90 78 / var(--tw-bg-opacity, 1))}.bg-white{--tw-bg-opacity:1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.p-3{padding:0.75rem}.p-4{padding:1rem}.text-left{text-align:left}.text-center{text-align:center}.text-2xl{font-size:1.5rem;line-height:2rem}.text-3xl{font-size:1.875rem;line-height:2.25rem}.text-base{font-size:1rem;line-height:1.5rem}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-sm{font-size:0.875rem;line-height:1.25rem}.text-xs{font-size:0.75rem;line-height:1rem}.font-bold{font-weight:700}.font-semibold{font-weight:600}.italic{font-style:italic}.leading-relaxed{line-height:1.625}.text-\[\#655A4E\]{--tw-text-opacity:1;color:rgb(101 90 78 / var(--tw-text-opacity, 1))}.text-\[\#8D7B68\]{--tw-text-opacity:1;color:rgb(141 123 104 / var(--tw-text-opacity, 1))}.text-gray-500{--tw-text-opacity:1;color:rgb(107 114 128 / var(--tw-text-opacity, 1))}.text-gray-600{--tw-text-opacity:1;color:rgb(75 85 99 / var(--tw-text-opacity, 1))}.text-gray-700{--tw-text-opacity:1;color:rgb(55 65 81 / var(--tw-text-opacity, 1))}.text-gray-800{--tw-text-opacity:1;color:rgb(31 41 55 / var(--tw-text-opacity, 1))}.text-white{--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.shadow-lg{--tw-shadow:0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.transition-colors{transition-property:color, background-color, border-color, fill, stroke, -webkit-text-decoration-color;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, -webkit-text-decoration-color;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.hover\:bg-\[\#8D7B68\]:hover{--tw-bg-opacity:1;background-color:rgb(141 123 104 / var(--tw-bg-opacity, 1))}.focus\:outline-none:focus{outline:2px solid transparent;outline-offset:2px}.focus\:ring-2:focus{--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 #0000)}.focus\:ring-\[\#655A4E\]:focus{--tw-ring-opacity:1;--tw-ring-color:rgb(101 90 78 / var(--tw-ring-opacity, 1))}.focus\:ring-offset-2:focus{--tw-ring-offset-width:2px}@media (min-width: 768px){.md\:grid-cols-2{grid-template-columns:repeat(2, minmax(0, 1fr))}.md\:grid-cols-3{grid-template-columns:repeat(3, minmax(0, 1fr))}.md\:p-8{padding:2rem}.md\:text-4xl{font-size:2.25rem;line-height:2.5rem}}</style></head>
<body class="text-gray-800">

    <div class="container mx-auto p-4 md:p-8 max-w-7xl">
        <header class="text-center mb-10">
            <h1 class="text-3xl md:text-4xl font-bold text-[#655A4E]">市場情緒兩極化：貪婪與恐懼的拉鋸戰</h1>
            <p class="text-lg text-[#8D7B68]">一份整合BofA資金流向與基金經理調查的深度解讀 (截至2025年10月16日)</p>
        </header>

        <main>
            <section class="mb-12">
                <h2 class="story-title">序章：市場的脈動，三分鐘速覽</h2>
                <p class="text-lg text-gray-700 leading-relaxed mb-6">
                    本週的市場，呈現出一種極度矛盾的「兩極化」(Buypolar) 情緒。一方面，在聯準會降息預期下，基金經理們的現金水平降至3.8%的低位，股票配置創下8個月新高，顯示出強烈的看漲心態；但另一方面，他們又將「AI泡沫」和「私募信貸」視為最大的潛在風險。貪婪與恐懼，正在市場的天平兩端激烈拉鋸。
                </p>
                <div class="space-y-4">
                     <div class="pulse-item">
                        <p class="font-bold">市場的熱議話題 (Zeitgeist):</p>
                        <p class="italic text-gray-700">「如果資產價格下跌並衝擊到富人，那麼『K型』經濟就將變成『梨形』(pear-shaped，意指情況變糟)。」，「貨幣市場的收益率在未來幾季將至少下降100個基點，那麼，在政府負債38兆美元的情況下，我該買公債？還是買利差處於20年低點的公司債？或是本益比高達40倍的股票？還是那個已經垂直上漲的黃金？真難。」</p>
                        <p class="text-gray-600 text-sm mt-1">解讀：市場的困境在於，避險資產（公債）風險高，安全資產（黃金）價格貴，風險資產（股票）有泡沫。錢無處可去，只能在不同資產中快速輪動。</p>
                    </div>
                    <div class="pulse-item">
                        <p class="font-bold">數據背後的故事 (Tale of the Tape):</p>
                        <p class="text-gray-700">今年以來全球123次的降息，為全球股市市值增加了20.8兆美元，相當於每一次降息就帶來1700億美元的市值增長！市場的投機情緒高漲，槓桿股票ETF的數量從年初的470檔暴增至701檔，5倍槓桿的個股ETF也即將問世。</p>
                    </div>
                    <div class="pulse-item">
                        <p class="font-bold">價格，最誠實的指標 (The Price is Right):</p>
                        <p class="text-gray-700">聯準會正在降息，但「脆弱的信貸」(Krunchy Kredit) 裂縫卻在擴大。如果銀行股、券商股和高收益債利差等指標發出更深的去槓桿或清算信號，聯準會將被迫採取更激進的降息措施。</p>
                    </div>
                    <div class="pulse-item">
                        <p class="font-bold">真正的大趨勢 (The Biggest Picture):</p>
                        <p class="text-gray-700">十月份的基金經理調查顯示，市場情緒是自25年2月以來最樂觀的，但債券配置卻是22年10月以來最低的。這種分歧正是逆向投資者最愛的機會。根據調查數據，最佳的長短倉交易是：做多債券/做空股票、做多英國/做空新興市場、做多必需消費品/做空銀行、做多能源/做空科技。</p>
                    </div>
                </div>
            </section>

            <section class="mb-12">
                <h2 class="story-title">第一章：極度貪婪下的資金流向</h2>
                <p class="text-lg text-gray-700 leading-relaxed mb-6">
                    從資金流向和經理人倉位來看，市場的樂觀情緒已達到自今年2月以來的最高點。基金經理的現金水平已降至3.8%，觸發了BofA現金規則的「賣出」信號。投資人正大舉從現金轉向風險資產，對大宗商品的增持達到23年3月以來新高，對新興市場股票的增持更是創下21年2月以來的新紀錄。
                </p>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
                    <div class="bg-white p-4 rounded-lg card-shadow">
                        <div class="chart-container h-96"><canvas id="ytdReturnsChart" width="1007" height="768" style="display: block; box-sizing: border-box; height: 384px; width: 503.5px;"></canvas></div>
                    </div>
                    <div class="bg-white p-4 rounded-lg card-shadow text-center">
                         <div class="gauge-chart-container"><canvas id="bullBearIndicator" width="700" height="350" style="display: block; box-sizing: border-box; height: 175px; width: 350px;"></canvas></div>
                         <p class="text-base text-left text-gray-600 leading-relaxed">本週牛熊指標從6.5微降至<strong>6.4</strong>。這主要是由於高收益債和新興市場債券的資金流出，以及全球股指廣度的減弱所致。儘管有所降溫，但指標仍然處於相對高的貪婪區間。</p>
                    </div>
                </div>

                <p class="text-lg text-gray-700 leading-relaxed mb-6">
                    本週的資金流動數據也印證了這種風險偏好：全球資金在本週淨流入股市281億美元、債市58億美元，同時有高達246億美元從貨幣市場基金中流出。這是一場典型的「現金變垃圾」(Cash is Trash) 的行情，資金正從避風港湧入風險資產。其中，科技股吸納了創紀錄的104億美元，中國股市也迎來了自4月以來的最大單週流入（134億美元）。黃金的吸金能力依然強勁，過去10週累計流入342億美元，創下歷史紀錄。然而，值得注意的是，高收益債券和新興市場債券自4月以來首次出現資金淨流出，顯示市場對高風險信貸的擔憂正在升溫。
                </p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div class="bg-white p-4 rounded-lg card-shadow">
                        <div class="chart-container h-80"><canvas id="weeklyFlowsChart" width="1007" height="640" style="display: block; box-sizing: border-box; height: 320px; width: 503.5px;"></canvas></div>
                    </div>
                    <div class="bg-white p-4 rounded-lg card-shadow">
                        <div class="chart-container h-80"><canvas id="techFlowsChart" width="1007" height="640" style="display: block; box-sizing: border-box; height: 320px; width: 503.5px;"></canvas></div>
                    </div>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mt-8">
                    <div class="bg-white p-4 rounded-lg card-shadow">
                        <div class="chart-container h-80"><canvas id="goldFlowsChart" width="1007" height="640" style="display: block; box-sizing: border-box; height: 320px; width: 503.5px;"></canvas></div>
                    </div>
                    <div class="bg-white p-4 rounded-lg card-shadow">
                        <div class="chart-container h-80"><canvas id="hyFlowsChart" width="1007" height="640" style="display: block; box-sizing: border-box; height: 320px; width: 503.5px;"></canvas></div>
                    </div>
                </div>
            </section>

            <section class="mb-12">
                <h2 class="story-title">第二章：專業投資人的分裂人格</h2>
                <p class="text-lg text-gray-700 leading-relaxed mb-6">
                    如果說散戶的資金流向代表了市場的「熱度」，那麼專業基金經理的倉位配置則揭示了他們內心的「盤算」。本月的基金經理調查(FMS)顯示，這些市場上的「聰明錢」正處於一種極度分裂的狀態——BofA稱之為「Buypolar」(買入兩極化)。
                </p>
                
                <div class="emphasis">
                    <p class="text-lg font-semibold">
                       一方面，他們極度看多。基金經理們正在大舉拋棄現金，將股票配置比例推升至8個月高點，同時將債券配置降至近一年來的最低點。他們對大宗商品和新興市場的看好程度，甚至達到了幾年來的頂峰。但另一方面，他們又極度恐懼。高達54%的經理人認為AI股票是泡沫，創下歷史新高；同時，創紀錄的60%的人認為全球股市「被高估」。
                    </p>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div class="bg-white p-4 rounded-lg card-shadow">
                        <div class="chart-container h-80"><canvas id="fmsSentimentChart" width="1007" height="640" style="display: block; box-sizing: border-box; height: 320px; width: 503.5px;"></canvas></div>
                    </div>
                    <div class="bg-white p-4 rounded-lg card-shadow">
                        <div class="chart-container h-80"><canvas id="fmsCashLevelChart" width="1007" height="640" style="display: block; box-sizing: border-box; height: 320px; width: 503.5px;"></canvas></div>
                    </div>
                </div>
                
                <div style="margin-top: 6rem;">
                    <h3 class="text-2xl font-bold">最擁擠的交易 vs 最大的恐懼</h3>
                </div>
                <p class="text-lg text-gray-700 leading-relaxed mb-6">
                    這種矛盾心態在具體交易上體現得淋漓盡致。調查顯示，「做多黃金」以43%的得票率，成為基金經理眼中最擁擠的交易，緊隨其後的是「做多科技七巨頭」(39%)。然而，當被問及市場最大的尾部風險時，「AI泡沫」卻以33%的得票率高居榜首。這意味著，<strong>市場上一邊倒地追捧科技股，同時又極度擔憂科技股的泡沫破裂。</strong>
                </p>
                 <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div class="bg-white p-4 rounded-lg card-shadow">
                        <div class="chart-container h-80"><canvas id="mostCrowdedTradeChart" width="1007" height="640" style="display: block; box-sizing: border-box; height: 320px; width: 503.5px;"></canvas></div>
                    </div>
                    <div class="bg-white p-4 rounded-lg card-shadow">
                        <div class="chart-container h-80"><canvas id="biggestTailRiskChart" width="1007" height="640" style="display: block; box-sizing: border-box; height: 320px; width: 503.5px;"></canvas></div>
                    </div>
                </div>

                <div style="margin-top: 5rem;">
                    <h2 class="story-title">信貸危機的幽靈：下一個雷曼時刻？</h2>
                </div>
                
                 <p class="text-lg text-gray-700 leading-relaxed mb-6">
                    比泡沫更令人擔憂的，是信貸市場潛藏的危機。基金經理調查顯示，當被問及下一次系統性信貸危機最可能來自何方時，高達57%的經理人將矛頭指向了「私募股權/信貸」（PE/PC），這一比例創下了2022年以來的新高，顯示市場對這個監管較少的領域充滿了極大的憂慮。
                </p>
                 <div class="bg-white p-4 rounded-lg card-shadow">
                    <div class="chart-container h-80"><canvas id="creditEventSourceChart" width="2142" height="640" style="display: block; box-sizing: border-box; height: 320px; width: 1071px;"></canvas></div>
                </div>
            </section>
            
            <section>
                <h2 class="story-title">第三章：富裕階層的動向：BofA私人客戶數據解析</h2>
                <p class="text-lg text-gray-700 leading-relaxed mb-6">
                    在分裂的市場中，高淨值人群的動向尤其值得關注。BofA的私人客戶管理著高達4.2兆美元的資產，他們的行為模式，往往能為我們提供領先的信號。本週的數據顯示，這些富裕的投資者也在進行微妙的倉位調整。
                </p>
                <p class="text-lg text-gray-700 leading-relaxed mb-6">
                    從長期資產配置來看，他們對股票的配置比例(64.3%)雖然從高點略有回落，但仍處於歷史高位；而現金配置(10.4%)則持續下降，處於相對低位。這表明他們的整體風險偏好依然較高。
                </p>
                 <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    <div class="bg-white p-4 rounded-lg card-shadow">
                        <div class="chart-container" style="height: 250px;"><canvas id="privateClientEquityChart" width="628" height="500" style="display: block; box-sizing: border-box; height: 250px; width: 314.3px;"></canvas></div>
                    </div>
                    <div class="bg-white p-4 rounded-lg card-shadow">
                        <div class="chart-container" style="height: 250px;"><canvas id="privateClientDebtChart" width="628" height="500" style="display: block; box-sizing: border-box; height: 250px; width: 314.3px;"></canvas></div></div>
                    <div class="bg-white p-4 rounded-lg card-shadow">
                        <div class="chart-container" style="height: 250px;"><canvas id="privateClientCashChart" width="628" height="500" style="display: block; box-sizing: border-box; height: 250px; width: 314.3px;"></canvas></div></div>
                </div>
                <div class="emphasis">
                    <p class="text-lg font-semibold">
                        然而，從近四周的ETF資金流向來看，他們的操作卻顯得非常謹慎。他們正在大舉買入"市政債、投資級債和高收益債券ETF"，同時賣出"公用事業、成長股和必需消費品ETF"。這與基金經理的行為形成了有趣的對比，顯示出私人客戶在戰術層面更傾向於「防禦」，他們正在利用ETF工具，悄悄地從股市輪動到債市，為潛在的波動做準備。
                    </p>
                </div>
                 <div class="bg-white p-4 rounded-lg card-shadow">
                    <div class="chart-container" style="height: 600px;"><canvas id="privateClientFlowsChart" width="2142" height="1200" style="display: block; box-sizing: border-box; height: 600px; width: 1071px;"></canvas></div>
                </div>
            </section>

            <section class="mb-12">
                 <h2 class="story-title" style="margin-top: 5rem;">最終章：當前市場的投資佈局建議</h2>
                 <p class="text-lg text-gray-700 leading-relaxed mb-6">
                    在這樣一個充滿矛盾的市場中，單純追漲或看空都存在巨大風險。BofA在報告中給出了三大方向的策略建議，核心思想是在順應趨勢的同時，為潛在的「黑天鵝」做好準備。
                </p>
                <h3>1. 做多長天期債券 (Long the Long Bond)</h3>
                <p class="text-gray-700 mb-4">儘管基金經理們正在減持債券，但BofA認為這是一個逆向機會。他們預計30年期美債殖利率將跌破4%。理由包括：信貸市場的裂縫將迫使聯準會更激進地降息、AI對勞動力和企業成本的長期通縮效應，以及零息債券是對沖信貸危機的最佳工具。</p>

                <h3>2. 做多國際市場 (Long International)</h3>
                <p class="text-gray-700 mb-4">BofA堅信，市場正從過去十年的「美國獨強」轉向未來十年的「全球再平衡」。儘管做多新興市場已成為共識，面臨回調風險，但非美市場的估值（15倍本益比）遠低於美股（19.6倍）。BofA的EPS增長模型預測未來12個月全球EPS將增長9%，高於市場共識的7%，主要動力來自亞洲出口復甦。油價下跌也將利好中國、日本和歐洲。</p>

                <h3>3. 謹慎做多黃金 (Long Gold)</h3>
                <p class="text-gray-700 mb-4">「做多黃金」已是市場最擁擠的交易，短期內投機情緒過熱，面臨獲利了結的壓力。但從長期來看，無論是機構還是散戶，對黃金的配置比例都還非常低。在央行重新評估黃金價值、地緣政治緩和或AI泡沫破裂引發實質利率飆升等宏觀變局出現前，黃金的牛市難言結束。</p>
            </section>
            
            <section>
                <h2 class="story-title">結語</h2>
                <div class="mt-8 space-y-4">
                    <div class="pulse-item text-center">
                        <p class="text-lg font-semibold text-gray-800 italic">"The four most dangerous words in investing are: 'This time it's different.'"</p>
                        <p class="text-sm text-gray-600 mt-2">「投資中最危險的四個字是：『這次不一樣』。」 - 約翰·坦伯頓爵士 (Sir John Templeton)</p>
                    </div>
                </div>
            </section>

        </main>

        <footer class="text-center mt-12 text-xs text-gray-500">
            <p>免責聲明：本報告內容僅為基於公開信息的市場分析，不構成任何投資建議。投資有風險，入市需謹慎。</p>
        </footer>
    </div>
    
    

<script>
// Encapsulate all chart logic in a function to ensure it runs after DOM is loaded.
function renderCharts() {
    try {
        Chart.register(ChartDataLabels);
        Chart.defaults.font.family = "'Noto Sans TC', sans-serif";
        Chart.defaults.color = '#655A4E';

        // Helper function to safely create charts
        const createChart = (elementId, config) => {
            const ctx = document.getElementById(elementId);
            if (ctx) {
                const existingChart = Chart.getChart(ctx);
                if (existingChart) {
                    existingChart.destroy();
                }
                new Chart(ctx, config);
            } else {
                console.warn(`Canvas element with id '${elementId}' not found.`);
            }
        };
        
        // Bull & Bear Indicator
        const gaugeNeedle = {
            id: 'gaugeNeedle',
            afterDraw(chart) {
                const { ctx, data, chartArea: { left, width, top, height} } = chart;
                ctx.save();
                const needleValue = 6.4; 
                const dataTotal = 10; 
                const angle = Math.PI + (1 / dataTotal * needleValue * Math.PI);
                const cx = width / 2;
                const cy = height + top;
                ctx.fillStyle = '#F57C00';
                ctx.font = 'bold 40px sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText(needleValue, cx + left, cy - (height * 0.35));
                ctx.translate(cx + left, cy);
                ctx.rotate(angle);
                ctx.beginPath();
                ctx.moveTo(0, -5);
                ctx.lineTo(height, 0); 
                ctx.lineTo(0, 5);
                ctx.fillStyle = 'rgba(101, 90, 78, 0.5)';
                ctx.fill();
                ctx.rotate(-angle);
                ctx.beginPath();
                ctx.arc(0, 0, 8, 0, Math.PI * 2);
                ctx.fillStyle = 'rgba(101, 90, 78, 0.5)';
                ctx.fill();
                ctx.closePath();
                ctx.restore();
            }
        };

        createChart('bullBearIndicator', {
            type: 'doughnut',
            data: {
                labels: ['Buy', 'Neutral', 'Sell'],
                datasets: [{ data: [2, 6, 2], backgroundColor: ['#4CAF50', '#FFC107', '#F44336'], borderWidth: 0 }]
            },
            options: {
                circumference: 180, rotation: 270, responsive: true, maintainAspectRatio: false,
                plugins: {
                    tooltip: { enabled: false },
                    title: { display: true, text: '牛熊指標', position: 'top', align: 'center', font: { size: 16, weight: 'bold' }, color: '#655A4E' },
                    datalabels: { display: false },
                    legend: { display: false }
                },
                cutout: '70%',
            },
            plugins: [gaugeNeedle]
        });

        // YTD Returns Chart
        const ytdData = { '黃金': 58.2, '股票': 19.0, '比特幣': 18.6, '投資級債': 10.1, '高收益債': 9.1, '政府公債': 7.2, '現金': 3.4, '大宗商品': 2.4, '美元': -8.9, '石油': -18.8 };
        createChart('ytdReturnsChart', {
            type: 'bar',
            data: {
                labels: Object.keys(ytdData),
                datasets: [{
                    label: '年度至今回報率 (%)',
                    data: Object.values(ytdData),
                    backgroundColor: Object.values(ytdData).map(v => v >= 0 ? 'rgba(102, 187, 106, 0.7)' : 'rgba(239, 83, 80, 0.7)'),
                }]
            },
            options: {
                responsive: true, maintainAspectRatio: false,
                plugins: { 
                    legend: { display: false }, 
                    title: { display: true, text: '年度至今各大類資產回報排行', font: {size: 16}},
                    datalabels: { anchor: 'end', align: 'end', formatter: (value) => value + '%', font: { weight: 'bold' } }
                },
                scales: { 
                    x: { ticks: { display: true, maxRotation: 90, minRotation: 90 } },
                    y: { ticks: { callback: (value) => value + '%' } } 
                }
            }
        });
        
        // Weekly Flows Chart
        const weeklyFlowsData = { '股票': 28.1, '債券': 5.8, '黃金': 4.5, '加密貨幣': 0.6, '現金': -24.6 };
        createChart('weeklyFlowsChart', {
            type: 'bar',
            data: {
                labels: Object.keys(weeklyFlowsData),
                datasets: [{
                    label: '單週資金流 (十億美元)',
                    data: Object.values(weeklyFlowsData),
                    backgroundColor: Object.values(weeklyFlowsData).map(v => v >= 0 ? 'rgba(66, 165, 245, 0.7)' : 'rgba(239, 83, 80, 0.7)'),
                }]
            },
            options: {
                responsive: true, maintainAspectRatio: false,
                plugins: { 
                    legend: { display: false }, 
                    title: { display: true, text: '本週主要資產資金流向 (十億美元)', font: { size: 16 } },
                    datalabels: { anchor: 'end', align: 'end', formatter: (value) => '$' + value + 'bn', font: { weight: 'bold' } }
                },
                scales: { 
                    x: { grid: { display: false } },
                    y: { ticks: { display: false } }
                }
            }
        });
        
        // FMS Sentiment Chart
        createChart('fmsSentimentChart', {
            type: 'line',
             data: {
                labels: ['’01', '’03', '’05', '’07', '’09', '’11', '’13', '’15', '’17', '’19', '’21', '’23', 'Oct’25'],
                datasets: [{
                    label: 'FMS Investor Sentiment',
                    data: [4, 8, 7, 5, 1, 9, 8, 7, 3, 2, 9, 1, 5.8],
                    borderColor: '#3b82f6',
                    tension: 0.4,
                    fill: false
                }]
            },
            options: {
                 responsive: true, maintainAspectRatio: false,
                plugins: {
                    legend: {display: false},
                    title: { display: true, text: '基金經理情緒指標創8個月新高', font: {size: 16}},
                    datalabels: {display: false}
                }
            }
        });

        // FMS Cash Level Chart
        createChart('fmsCashLevelChart', {
            type: 'bar',
            data: {
                labels: ['Dec’08', 'Jun’12', 'Oct’16', 'Apr’20', 'Oct’22', 'Oct’25'],
                datasets: [{
                    label: 'FMS Average Cash Level (%)',
                    data: [5.4, 5.2, 5.8, 5.9, 6.3, 3.8],
                    backgroundColor: 'rgba(0, 0, 139, 0.7)'
                }]
            },
            options: {
                responsive: true, maintainAspectRatio: false,
                plugins: {
                    legend: {display: false},
                    title: {display: true, text: '基金經理現金水平降至3.8%', font: {size: 16}},
                    datalabels: {anchor: 'end', align: 'top', formatter: (value) => value + '%'}
                }
            }
        });
        
        // Tech Flows Chart
        createChart('techFlowsChart', {
            type: 'bar',
             data: {
                labels: ['前4週', '前3週', '前2週', '本週'],
                datasets: [{
                    label: '科技股資金流 (十億美元)',
                    data: [1.2, 4.5, 0.5, 10.4],
                    backgroundColor: 'rgba(66, 165, 245, 0.7)',
                }]
            },
            options: {
                responsive: true, maintainAspectRatio: false,
                plugins: {
                    legend: { display: false },
                    title: { display: true, text: '科技股資金流入創歷史新高', font: {size: 16}},
                    datalabels: { anchor: 'end', align: 'end', formatter: (value) => '$' + value + 'bn' }
                }
            }
        });
        
        // Gold Flows Chart
        createChart('goldFlowsChart', {
            type: 'line',
            data: {
                labels: ['Wk1', 'Wk2', 'Wk3', 'Wk4', 'Wk5', 'Wk6', 'Wk7', 'Wk8', 'Wk9', 'Wk10'],
                datasets: [{
                    label: '黃金資金流 (十億美元)',
                    data: [2.1, 1.5, 3.2, 2.8, 4.1, 3.5, 5.2, 7.3, 7.8, 4.5],
                    borderColor: '#FFC107',
                    backgroundColor: 'rgba(255, 193, 7, 0.2)',
                    fill: true,
                    tension: 0.4,
                }]
            },
            options: {
                responsive: true, maintainAspectRatio: false,
                plugins: {
                    legend: { display: false },
                    title: { display: true, text: '黃金連續10週資金流入', font: {size: 16}},
                    datalabels: { display: false }
                }
            }
        });

        // High Yield Flows Chart
        createChart('hyFlowsChart', {
            type: 'bar',
            data: {
                labels: ['前4週', '前3週', '前2週', '本週'],
                datasets: [{
                    label: '高收益債資金流 (十億美元)',
                    data: [2.1, 1.8, 0.5, -3.2],
                    backgroundColor: (context) => context.dataset.data[context.dataIndex] >= 0 ? 'rgba(66, 165, 245, 0.7)' : 'rgba(239, 83, 80, 0.7)',
                }]
            },
             options: {
                responsive: true, maintainAspectRatio: false,
                plugins: {
                    legend: { display: false },
                    title: { display: true, text: '高收益債券自4月以來首次流出', font: {size: 16}},
                    datalabels: { anchor: 'end', align: 'end', formatter: (value) => '$' + value + 'bn' }
                }
            }
        });
        
        // FMS Most Crowded Trade Chart
        createChart('mostCrowdedTradeChart', {
            type: 'bar',
            data: {
                labels: ['做多黃金', '做多科技七巨頭', '做空美元'],
                datasets: [{
                    data: [43, 39, 8],
                    backgroundColor: ['#0d47a1', '#1976d2', '#42a5f5']
                }]
            },
            options: {
                indexAxis: 'y',
                 responsive: true, maintainAspectRatio: false,
                plugins: {
                    legend: { display: false },
                    title: { display: true, text: '最擁擠的交易 (%)', font: {size: 16}},
                    datalabels: { formatter: (value) => value + '%', anchor: 'end', align: 'end' }
                }
            }
        });
        
        // FMS Biggest Tail Risk Chart
        createChart('biggestTailRiskChart', {
            type: 'bar',
            data: {
                labels: ['AI泡沫', '第二波通膨', '聯準會失獨立性'],
                datasets: [{
                    data: [33, 27, 14],
                    backgroundColor: ['#b71c1c', '#d32f2f', '#f44336']
                }]
            },
            options: {
                indexAxis: 'y',
                 responsive: true, maintainAspectRatio: false,
                plugins: {
                    legend: { display: false },
                    title: { display: true, text: '最大的尾部風險 (%)', font: {size: 16}},
                    datalabels: { formatter: (value) => value + '%', anchor: 'end', align: 'end' }
                }
            }
        });
        
        // FMS Credit Event Source Chart
        createChart('creditEventSourceChart', {
            type: 'bar',
            data: {
                labels: ['私募股權/信貸', '美國公債', '加密貨幣'],
                datasets: [
                    { label: '十月', data: [57, 19, 7], backgroundColor: '#0d47a1' },
                    { label: '九月', data: [25, 22, 13], backgroundColor: '#42a5f5' }
                ]
            },
            options: {
                 responsive: true, maintainAspectRatio: false,
                plugins: {
                    title: { display: true, text: '系統性信貸危機最可能來源 (%)', font: {size: 16}},
                    datalabels: { formatter: (value) => value + '%' }
                }
            }
        });

        // Private Client Flows Chart
        createChart('privateClientFlowsChart', {
            type: 'bar',
            data: {
                labels: ['市政債', '投資級債', '高收益債', '新興市場債', '日本', '貴金屬', 'TIPS', 'REITs', '價值股', '公用事業', '成長股', '必需消費品'],
                datasets: [{
                    label: '四周累計資金流 (% AUM)',
                    data: [5.2, 3.5, 3.2, 2.8, 2.7, 2.5, 2.2, 2.0, -2.5, -2.8, -3.0, -3.5],
                    backgroundColor: (context) => context.raw >= 0 ? 'rgba(66, 165, 245, 0.7)' : 'rgba(239, 83, 80, 0.7)',
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false },
                    title: { 
                        display: true,
                        text: 'BofA 私人客戶近4週ETF資金流向 (% AUM)',
                        font: { size: 16 }
                    },
                    datalabels: {
                        anchor: 'end',
                        align: 'top',
                        formatter: (value) => value.toFixed(1) + '%',
                        color: (context) => context.dataset.data[context.dataIndex] >=0 ? '#1E88E5' : '#D32F2F',
                    }
                },
                scales: {
                    x: {
                        ticks: {
                            display: true,
                            maxRotation: 90,
                            minRotation: 90
                        }
                    },
                    y: {
                        ticks: {
                            callback: (value) => value + '%'
                        }
                    }
                }
            }
        });

        // Private Client Allocation Charts
        const allocationLabels = ['05', '07', '09', '11', '13', '15', '17', '19', '21', '23', '25'];
        
        createChart('privateClientEquityChart', {
            type: 'line',
            data: {
                labels: allocationLabels,
                datasets: [{ label: '股票配置比例', data: [54, 56, 39, 50, 56, 63, 60, 62, 66, 58, 64.3], borderColor: '#3b82f6', tension: 0.1 }]
            },
            options: {
                responsive: true, maintainAspectRatio: false,
                plugins: { legend: { display: false }, title: { display: true, text: '股票配置比例 (% AUM)' } }
            }
        });

        createChart('privateClientDebtChart', {
            type: 'line',
            data: {
                labels: allocationLabels,
                datasets: [{ label: '債券配置比例', data: [29, 26, 34, 32, 28, 25, 24, 23, 17, 22, 18.2], borderColor: '#10b981', tension: 0.1 }]
            },
            options: {
                responsive: true, maintainAspectRatio: false,
                plugins: { legend: { display: false }, title: { display: true, text: '債券配置比例 (% AUM)' } }
            }
        });
        
        createChart('privateClientCashChart', {
            type: 'line',
            data: {
                labels: allocationLabels,
                datasets: [{ label: '現金配置比例', data: [12, 11, 21, 15, 13, 12, 11, 14, 11, 12.5, 10.4], borderColor: '#f97316', tension: 0.1 }]
            },
            options: {
                responsive: true, maintainAspectRatio: false,
                plugins: { legend: { display: false }, title: { display: true, text: '現金配置比例 (% AUM)' } }
            }
        });


        // Download button logic
        const downloadBtn = document.getElementById('downloadBtn');
        if (downloadBtn) {
            downloadBtn.addEventListener('click', function() {
                const reportDate = "20251016";
                const pdfTitle = "Fed_Dont_Fail_Me_Now";
                const filename = `${reportDate}_BofA_The_Flow_Show_${pdfTitle}.html`;
                
                const clonedDoc = document.documentElement.cloneNode(true);
                const btnToRemove = clonedDoc.querySelector('#downloadBtn');
                if(btnToRemove) btnToRemove.remove();

                const blob = new Blob([clonedDoc.outerHTML], { type: 'text/html;charset=utf-8' });
                const url = URL.createObjectURL(blob);
                
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            });
        }
    } catch (e) {
        console.error("圖表渲染時發生錯誤:", e);
    }
}

// Ensure the DOM is fully loaded before trying to render charts
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', renderCharts);
} else {
    renderCharts();
}
</script>




</body></html>