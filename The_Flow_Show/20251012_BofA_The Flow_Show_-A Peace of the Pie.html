<html lang="zh-Hant"><head><script>(function(firebaseConfig, initialAuthToken, appId) {
        window.__firebase_config = firebaseConfig;
        window.__initial_auth_token = initialAuthToken;
        window.__app_id = appId;
            })("\n{\n  \"apiKey\": \"AIzaSyCqyCcs2R2e7AegGjvFAwG98wlamtbHvZY\",\n  \"authDomain\": \"bard-frontend.firebaseapp.com\",\n  \"projectId\": \"bard-frontend\",\n  \"storageBucket\": \"bard-frontend.firebasestorage.app\",\n  \"messagingSenderId\": \"175205271074\",\n  \"appId\": \"1:175205271074:web:2b7bd4d34d33bf38e6ec7b\"\n}\n","eyJhbGciOiJSUzI1NiIsImtpZCI6IjIyMGExMzQ5NmMwYWQ5MjJkZmZkZGViMjk3MzJlZDQ4ZjFlY2Q0YTMiLCJ0eXAiOiJKV1QifQ.eyJzdWIiOiJmaXJlYmFzZS1hZG1pbnNkay1mYnN2Y0BiYXJkLWZyb250ZW5kLmlhbS5nc2VydmljZWFjY291bnQuY29tIiwiYXVkIjoiaHR0cHM6Ly9pZGVudGl0eXRvb2xraXQuZ29vZ2xlYXBpcy5jb20vZ29vZ2xlLmlkZW50aXR5LmlkZW50aXR5dG9vbGtpdC52MS5JZGVudGl0eVRvb2xraXQiLCJ1aWQiOiIwMTYyNzg3NDM4ODM1OTc2Mjk5OCIsImlzcyI6ImZpcmViYXNlLWFkbWluc2RrLWZic3ZjQGJhcmQtZnJvbnRlbmQuaWFtLmdzZXJ2aWNlYWNjb3VudC5jb20iLCJjbGFpbXMiOnsiYXBwSWQiOiJjX2YwZWQzMDdlYjZhMDA4MWRfMjAyNTEwMTJfQm9mQV9UaGUgRmxvd19TaG93Lmh0bWwtMjM5In0sImV4cCI6MTc2MDI0MDc2OCwiaWF0IjoxNzYwMjM3MTY4LCJhbGciOiJSUzI1NiJ9.ISfav9qEhbl58cCFp3vwQv4QiMx_VpKUcG_OGsteQIgbzq2csnhQsc7Do8v6i7oY3gmXO7ehSMpyxHmvWTvdQ5qbRmphjBiaGbTvB4aqArRgLZYYqne4z_DjI4DnEVD9hI438LAMUe0twhLBHjbaEngIUvNkN7_MCIc0Wb1E1AXk_EQeExEIyzKpg3QxtHRt048mP9hMz0eVfhg4xS8QH3yaUuHQw4KN1mblCMsGd0VZ1GvuKqq68VMMInGVSrP1zu95QU9yVWDPyCzgWCngxUF_8irK_RsQ-i6Ox5YdKLB0Y_WIZXN7txrm4VW0H15QyNJwAeEnjfUjPs0UJaD19w","c_f0ed307eb6a0081d_20251012_BofA_The Flow_Show.html-239")</script><script>'use strict';var h=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,b,d){if(a==Array.prototype||a==Object.prototype)return a;a[b]=d.value;return a};function l(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var d=a[b];if(d&&d.Math==Math)return d}throw Error("Cannot find global object");}var n=l(this);
function p(a,b){if(b)a:{var d=n;a=a.split(".");for(var c=0;c<a.length-1;c++){var e=a[c];if(!(e in d))break a;d=d[e]}a=a[a.length-1];c=d[a];b=b(c);b!=c&&b!=null&&h(d,a,{configurable:!0,writable:!0,value:b})}}function r(a){function b(c){return a.next(c)}function d(c){return a.throw(c)}return new Promise(function(c,e){function f(g){g.done?c(g.value):Promise.resolve(g.value).then(b,d).then(f,e)}f(a.next())})}function t(a){return r(a())}
p("Object.values",function(a){return a?a:function(b){var d=[],c;for(c in b)Object.prototype.hasOwnProperty.call(b,c)&&d.push(b[c]);return d}});p("Array.prototype.includes",function(a){return a?a:function(b,d){var c=this;c instanceof String&&(c=String(c));var e=c.length;d=d||0;for(d<0&&(d=Math.max(d+e,0));d<e;d++){var f=c[d];if(f===b||Object.is(f,b))return!0}return!1}});/*

 MIT License

 Copyright (c) 2017-2023 W.Y.

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in
 all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 SOFTWARE.

*/
function u(a,b){const d=a.style;b.backgroundColor&&(d.backgroundColor=b.backgroundColor);b.width&&(d.width=`${b.width}px`);b.height&&(d.height=`${b.height}px`);const c=b.style;c!=null&&Object.keys(c).forEach(e=>{d[e]=c[e]})};var v=(()=>{let a=0;return()=>{a+=1;return`u${`0000${(Math.random()*1679616<<0).toString(36)}`.slice(-4)}${a}`}})();function w(a){const b=[];for(let d=0,c=a.length;d<c;d++)b.push(a[d]);return b}let x=null;function y(a={}){return x?x:a.l?x=a.l:x=w(window.getComputedStyle(document.documentElement))}function z(a,b){return(a=(a.ownerDocument.defaultView||window).getComputedStyle(a).getPropertyValue(b))?parseFloat(a.replace("px","")):0}
function A(a,b={}){var d;if(!(d=b.width)){d=z(a,"border-left-width");var c=z(a,"border-right-width");d=a.clientWidth+d+c}(b=b.height)||(b=z(a,"border-top-width"),c=z(a,"border-bottom-width"),b=a.clientHeight+b+c);return{width:d,height:b}}function B(a){return new Promise((b,d)=>{const c=new Image;c.onload=()=>{c.decode().then(()=>{requestAnimationFrame(()=>b(c))})};c.onerror=d;c.crossOrigin="anonymous";c.decoding="async";c.src=a})}
function C(a){return t(function*(){return Promise.resolve().then(()=>(new XMLSerializer).serializeToString(a)).then(encodeURIComponent).then(b=>`data:image/svg+xml;charset=utf-8,${b}`)})}
function D(a,b,d){return t(function*(){const c=document.createElementNS("http://www.w3.org/2000/svg","svg"),e=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");c.setAttribute("width",`${b}`);c.setAttribute("height",`${d}`);c.setAttribute("viewBox",`0 0 ${b} ${d}`);e.setAttribute("width","100%");e.setAttribute("height","100%");e.setAttribute("x","0");e.setAttribute("y","0");e.setAttribute("externalResourcesRequired","true");c.appendChild(e);e.appendChild(a);return C(c)})}
var E=(a,b)=>{if(a instanceof b)return!0;a=Object.getPrototypeOf(a);return a===null?!1:a.constructor.name===b.name||E(a,b)};function F(a,b){return y(b).map(d=>{const c=a.getPropertyValue(d),e=a.getPropertyPriority(d);return`${d}: ${c}${e?" !important":""};`}).join(" ")}
function G(a,b,d,c){a=window.getComputedStyle(a,d);var e=a.getPropertyValue("content");if(e!==""&&e!=="none"){var f=v();try{b.className=`${b.className} ${f}`}catch(k){return}e=document.createElement("style");var g=e.appendChild;d=`.${f}:${d}`;a.cssText?(c=a.getPropertyValue("content"),c=`${a.cssText} content: '${c.replace(/'|"/g,"")}';`):c=F(a,c);g.call(e,document.createTextNode(`${d}{${c}}`));b.appendChild(e)}};function H(a){return a.search(/^(data:)/)!==-1}function I(a,b,d){return t(function*(){const c=yield fetch(a,b);if(c.status===404)throw Error(`Resource "${c.url}" not found`);const e=yield c.blob();return new Promise((f,g)=>{const k=new FileReader;k.onerror=g;k.onloadend=()=>{try{f(d({o:c,result:k.result}))}catch(m){g(m)}};k.readAsDataURL(e)})})}const J={};function K(a,b,d){let c=a.replace(/\?.*/,"");d&&(c=a);/ttf|otf|eot|woff2?/i.test(c)&&(c=c.replace(/.*\//,""));return b?`[${b}]${c}`:c}
function L(a,b,d){return t(function*(){const c=K(a,b,d.C);if(J[c]!=null)return J[c];d.u&&(a+=(/\?/.test(a)?"&":"?")+(new Date).getTime());let e;try{const f=yield I(a,d.i,({o:g,result:k})=>{b||(b=g.headers.get("Content-Type")||"");return k.split(/,/)[1]});e=`data:${b};base64,${f}`}catch(f){e=d.B||""}return J[c]=e})};const M={P:"application/font-woff",R:"application/font-woff",N:"application/font-truetype",v:"application/vnd.ms-fontobject",H:"image/png",F:"image/jpeg",D:"image/jpeg",A:"image/gif",M:"image/tiff",L:"image/svg+xml",O:"image/webp"};function N(a){return(a=/\.([^./]*?)$/g.exec(a))?a[1]:""};function O(a){return t(function*(){const b=a.toDataURL();return b==="data:,"?a.cloneNode(!1):B(b)})}function aa(a,b){return t(function*(){if(a.currentSrc){var d=document.createElement("canvas");const c=d.getContext("2d");d.width=a.clientWidth;d.height=a.clientHeight;c==null||c.drawImage(a,0,0,d.width,d.height);d=d.toDataURL();return B(d)}d=a.poster;d=yield L(d,M[N(d).toLowerCase()]||"",b);return B(d)})}
function ba(a,b){return t(function*(){try{let d;if(a==null?0:(d=a.contentDocument)==null?0:d.body)return yield P(a.contentDocument.body,b,!0)}catch(d){}return a.cloneNode(!1)})}function ca(a,b){return t(function*(){return E(a,HTMLCanvasElement)?O(a):E(a,HTMLVideoElement)?aa(a,b):E(a,HTMLIFrameElement)?ba(a,b):a.cloneNode(a.tagName!=null&&a.tagName.toUpperCase()==="SVG")})}
function da(a,b,d){return t(function*(){if(b.tagName!=null&&b.tagName.toUpperCase()==="SVG")return b;let c=[];if(a.tagName!=null&&a.tagName.toUpperCase()==="SLOT"&&a.assignedNodes)c=w(a.assignedNodes());else{let e;if(E(a,HTMLIFrameElement)&&((e=a.contentDocument)==null?0:e.body))c=w(a.contentDocument.body.childNodes);else{let f;c=w(((f=a.shadowRoot)!=null?f:a).childNodes)}}if(c.length===0||E(a,HTMLVideoElement))return b;yield c.reduce((e,f)=>e.then(()=>P(f,d)).then(g=>{g&&b.appendChild(g)}),Promise.resolve());
return b})}function ea(a,b,d){const c=b.style;if(c){var e=window.getComputedStyle(a);e.cssText?(c.cssText=e.cssText,c.transformOrigin=e.transformOrigin):y(d).forEach(f=>{let g=e.getPropertyValue(f);f==="font-size"&&g.endsWith("px")&&(g=`${Math.floor(parseFloat(g.substring(0,g.length-2)))-.1}px`);E(a,HTMLIFrameElement)&&f==="display"&&g==="inline"&&(g="block");f==="d"&&b.getAttribute("d")&&(g=`path(${b.getAttribute("d")})`);c.setProperty(f,g,e.getPropertyPriority(f))})}}
function fa(a,b){E(a,HTMLSelectElement)&&(b=Array.from(b.children).find(d=>a.value===d.getAttribute("value")))&&b.setAttribute("selected","")}
function ha(a,b){return t(function*(){var d=a.querySelectorAll?a.querySelectorAll("use"):[];if(d.length===0)return a;var c={};for(var e=0;e<d.length;e++){var f=d[e].getAttribute("xlink:href");if(f){const g=document.querySelector(f);a.querySelector(f)||!g||c[f]||(c[f]=yield P(g,b,!0))}}d=Object.values(c);if(d.length){c=document.createElementNS("http://www.w3.org/1999/xhtml","svg");c.setAttribute("xmlns","http://www.w3.org/1999/xhtml");c.style.position="absolute";c.style.width="0";c.style.height="0";
c.style.overflow="hidden";c.style.display="none";e=document.createElementNS("http://www.w3.org/1999/xhtml","defs");c.appendChild(e);for(f=0;f<d.length;f++)e.appendChild(d[f]);a.appendChild(c)}return a})}
function P(a,b,d){return t(function*(){return d||!b.filter||b.filter(a)?Promise.resolve(a).then(c=>ca(c,b)).then(c=>da(a,c,b)).then(c=>{E(c,Element)&&(ea(a,c,b),G(a,c,":before",b),G(a,c,":after",b),E(a,HTMLTextAreaElement)&&(c.textContent=a.value),E(a,HTMLInputElement)&&c.setAttribute("value",a.value),fa(a,c));return c}).then(c=>ha(c,b)):null})};const Q=/url\((['"]?)([^'"]+?)\1\)/g,ia=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,ja=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function ka(a){const b=[];a.replace(Q,(d,c,e)=>{b.push(e);return d});return b.filter(d=>!H(d))}
function la(a,b,d,c){return t(function*(){try{const e=d?(new URL(b,d||void 0)).toString():b;let f;f=yield L(e,M[N(b).toLowerCase()]||"",c);return a.replace(new RegExp(`(url\\(['"]?)(${b.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")})(['"]?\\))`,"g"),`$1${f}$3`)}catch(e){}return a})}function ma(a,{I:b}){return b?a.replace(ja,d=>{for(;;){const [c,,e]=ia.exec(d)||[],f=c,g=e;if(!g)return"";if(g===b)return`src: ${f};`}}):a}
function R(a,b,d){return t(function*(){if(a.search(Q)===-1)return a;const c=ma(a,d);return ka(c).reduce((e,f)=>e.then(g=>la(g,f,b,d)),Promise.resolve(c))})};function S(a,b,d){return t(function*(){var c;const e=(c=b.style)==null?void 0:c.getPropertyValue(a);return e?(c=yield R(e,null,d),b.style.setProperty(a,c,b.style.getPropertyPriority(a)),!0):!1})}function na(a,b){return t(function*(){(yield S("background",a,b))||(yield S("background-image",a,b));(yield S("mask",a,b))||(yield S("-webkit-mask",a,b))||(yield S("mask-image",a,b))||(yield S("-webkit-mask-image",a,b))})}
function oa(a,b){return t(function*(){const d=E(a,HTMLImageElement);if(d&&!H(a.src)||E(a,SVGImageElement)&&!H(a.href.baseVal)){var c=d?a.src:a.href.baseVal,e=yield L(c,M[N(c).toLowerCase()]||"",b);yield new Promise((f,g)=>{a.onload=f;a.onerror=b.m?(...k)=>{try{f(b.m(...k))}catch(m){g(m)}}:g;a.decode&&(a.decode=f);a.loading==="lazy"&&(a.loading="eager");d?(a.srcset="",a.src=e):a.href.baseVal=e})}})}
function pa(a,b){return t(function*(){const d=w(a.childNodes).map(c=>T(c,b));yield Promise.all(d).then(()=>a)})}function T(a,b){return t(function*(){E(a,Element)&&(yield na(a,b),yield oa(a,b),yield pa(a,b))})};const U={};function V(a){return t(function*(){var b=U[a];if(b!=null)return b;b=yield(yield fetch(a)).text();b={url:a,cssText:b};return U[a]=b})}function W(a,b){return t(function*(){let d=a.cssText;const c=/url\(["']?([^"')]+)["']?\)/g,e=(d.match(/url\([^)]+\)/g)||[]).map(f=>t(function*(){let g=f.replace(c,"$1");g.startsWith("https://")||(g=(new URL(g,a.url)).href);return I(g,b.i,({result:k})=>{d=d.replace(f,`url(${k})`);return[f,k]})}));return Promise.all(e).then(()=>d)})}
function X(a){if(a==null)return[];const b=[];a=a.replace(/(\/\*[\s\S]*?\*\/)/gi,"");for(var d=RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");;){var c=d.exec(a);if(c===null)break;b.push(c[0])}a=a.replace(d,"");d=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi;for(c=RegExp("((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})","gi");;){let e=d.exec(a);if(e===null)if(e=c.exec(a),e===null)break;else d.lastIndex=c.lastIndex;else c.lastIndex=
d.lastIndex;b.push(e[0])}return b}
function qa(a,b){return t(function*(){const d=[],c=[];a.forEach(e=>{if("cssRules"in e)try{w(e.cssRules||[]).forEach((f,g)=>{if(f.type===CSSRule.IMPORT_RULE){let k=g+1;f=V(f.href).then(m=>W(m,b)).then(m=>X(m).forEach(q=>{try{e.insertRule(q,q.startsWith("@import")?k+=1:e.cssRules.length)}catch(Da){}})).catch(()=>{});c.push(f)}})}catch(f){const g=a.find(k=>k.href==null)||document.styleSheets[0];e.href!=null&&c.push(V(e.href).then(k=>W(k,b)).then(k=>X(k).forEach(m=>{g.insertRule(m,g.cssRules.length)})).catch(()=>
{}))}});return Promise.all(c).then(()=>{a.forEach(e=>{if("cssRules"in e)try{w(e.cssRules||[]).forEach(f=>{d.push(f)})}catch(f){}});return d})})}function ra(a){return a.filter(b=>b.type===CSSRule.FONT_FACE_RULE).filter(b=>b.style.getPropertyValue("src").search(Q)!==-1)}function sa(a,b){return t(function*(){if(a.ownerDocument==null)throw Error("Provided element is not within a Document");var d=w(a.ownerDocument.styleSheets);d=yield qa(d,b);return ra(d)})}
function ta(a){function b(c){(c.style.fontFamily||getComputedStyle(c).fontFamily).split(",").forEach(e=>{d.add(e.trim().replace(/["']/g,""))});Array.from(c.children).forEach(e=>{e instanceof HTMLElement&&b(e)})}const d=new Set;b(a);return d}function ua(a,b){return t(function*(){const d=yield sa(a,b),c=ta(a);return(yield Promise.all(d.filter(e=>c.has(e.style.fontFamily.trim().replace(/["']/g,""))).map(e=>R(e.cssText,e.parentStyleSheet?e.parentStyleSheet.href:null,b)))).join("\n")})}
function va(a,b){return t(function*(){const d=b.j!=null?b.j:b.K?null:yield ua(a,b);if(d){const c=document.createElement("style");c.appendChild(document.createTextNode(d));a.firstChild?a.insertBefore(c,a.firstChild):a.appendChild(c)}})};function wa(a,b={}){return t(function*(){const {width:d,height:c}=A(a,b),e=yield P(a,b,!0);yield va(e,b);yield T(e,b);u(e,b);return yield D(e,d,c)})}
function xa(a,b={}){return t(function*(){const {width:d,height:c}=A(a,b);var e=yield wa(a,b);e=yield B(e);const f=document.createElement("canvas"),g=f.getContext("2d"),k=b.G||window.devicePixelRatio||1,m=b.h||d,q=b.g||c;f.width=m*k;f.height=q*k;!b.J&&(f.width>16384||f.height>16384)&&(f.width>16384&&f.height>16384?f.width>f.height?(f.height*=16384/f.width,f.width=16384):(f.width*=16384/f.height,f.height=16384):f.width>16384?(f.height*=16384/f.width,f.width=16384):(f.width*=16384/f.height,f.height=
16384));f.style.width=`${m}`;f.style.height=`${q}`;b.backgroundColor&&(g.fillStyle=b.backgroundColor,g.fillRect(0,0,f.width,f.height));g.drawImage(e,0,0,f.width,f.height);return f})}function ya(a,b={}){return t(function*(){return(yield xa(a,b)).toDataURL()})};const za=["gemini.google.com","corp.google.com","proxy.googlers.com"];function Y(){return document.body.querySelectorAll('[class*="animate"]').length>0}function Z(a){return t(function*(){try{return yield ya(a,{h:a.offsetWidth,g:a.offsetHeight})}catch(d){var b=a.offsetHeight;const c=document.createElement("canvas");c.width=a.offsetWidth;c.height=b;return c.toDataURL("image/png")}})}
function Aa(){return t(function*(){const a=document.body.offsetWidth,b=document.body.offsetHeight,d=document.body.cloneNode(!0);d.querySelectorAll('[class*="animate"]').forEach(c=>{c.classList.remove(...Array.from(c.classList).filter(e=>e.startsWith("animate")))});d.style.width=`${a}px`;d.style.height=`${b}px`;return d})}
function Ba(a){return t(function*(){let b=document.body;if(Y()){var d=yield Aa();b=d;document.body.appendChild(d)}d=yield Z(b);Y()&&document.body.removeChild(b);window.parent.postMessage({type:"SEND_SCREENSHOT",image:d,topOffset:document.documentElement.scrollTop},a.origin)})}function Ca(a){return t(function*(){const b={type:"SEND_SCREENSHOT_FOR_DATA_VISUALIZATION",image:yield Z(document.body),topOffset:0};window.parent.postMessage(b,a.origin)})}
window.addEventListener("message",a=>t(function*(){if(za.some(d=>a.origin.includes(d))){var b=a.data;b&&(b.type==="MAKE_SCREENSHOT"&&(yield Ba(a)),b.type==="MAKE_SCREENSHOT_FOR_DATA_VISUALIZATION"&&(yield Ca(a)))}}));
</script><script>(function() {
  // Ensure this script is executed only once
  if (window.firebaseAuthBridgeScriptLoaded) {
    return;
  }
  window.firebaseAuthBridgeScriptLoaded = true;

  let nextTokenPromiseId = 0;

  // Stores { resolve, reject } for ongoing token requests
  const pendingTokenPromises = {};

  // Listen for messages from the Host Application
  window.addEventListener('message', function(event) {

    const messageData = event.data;

  if (messageData && messageData.type === 'RESOLVE_NEW_FIREBASE_TOKEN') {
      const { success, token, error, promiseId } = messageData ?? {};
      if (pendingTokenPromises[promiseId]) {
        if (success) {
          pendingTokenPromises[promiseId].resolve(token);
        } else {
          pendingTokenPromises[promiseId].reject(new Error(error || 'Token refresh failed from host.'));
        }
        delete pendingTokenPromises[promiseId];
      }
    }
  });

  // Expose a function for the Generated App to request a new Firebase token
  window.requestNewFirebaseToken = function() {
    const currentPromiseId = nextTokenPromiseId++;
    const promise = new Promise((resolve, reject) => {
      pendingTokenPromises[currentPromiseId] = { resolve, reject };
    });
    if (window.parent && window.parent !== window) {
      window.parent.postMessage({
        type: 'REQUEST_NEW_FIREBASE_TOKEN',
        promiseId: currentPromiseId
      }, '*');
    } else {
      pendingTokenPromises[currentPromiseId].reject(new Error('No parent window to request token from.'));
      delete pendingTokenPromises[currentPromiseId];
    }
    return promise;
  };
})();</script><script>
let realOriginalGetUserMedia = null;
if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
  realOriginalGetUserMedia = navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);
}

(function() {
  if (navigator.mediaDevices && navigator.mediaDevices.__proto__) {
    try {
      Object.defineProperty(navigator.mediaDevices.__proto__, 'getUserMedia', {
        get: function() {
          return undefined; // Or throw an error
        },
        configurable: false
      });
    } catch (error) {
      console.error("Error defining prototype getter:", error);
    }
  }
})();

(function() {
  const pendingMediaResolvers = {};
  let nextMediaPromiseId = 0;

  function requestMediaPermissions(constraints) {
    const mediaPromiseId = nextMediaPromiseId++;
    const promise = new Promise((resolve, reject) => {
      pendingMediaResolvers[mediaPromiseId] = (granted) => {
        delete pendingMediaResolvers[mediaPromiseId];
        resolve(granted);
      };
    });

    window.parent.postMessage({
      type: 'requestMediaPermission',
      constraints: constraints,
      promiseId: mediaPromiseId,
    }, '*');

    return promise;
  }

  let originalGetUserMedia = realOriginalGetUserMedia;

  function interceptGetUserMedia() {
    if (navigator.mediaDevices) {
      Object.defineProperty(navigator.mediaDevices, 'getUserMedia', {
        value: function(constraints) {
          return requestMediaPermissions(constraints).then((granted) => {
            if (granted) {
              if (originalGetUserMedia) {
                return originalGetUserMedia(constraints);
              } else {
                throw new Error("Original getUserMedia not available.");
              }
            } else {
              throw new DOMException('Permission denied', 'NotAllowedError');
            }
          });
        },
        writable: false,
        configurable: false
      });
    }
  }

  interceptGetUserMedia();

  const observer = new MutationObserver(function(mutationsList, observer) {
    for (const mutation of mutationsList) {
      if (mutation.type === 'reconfigured' && mutation.name === 'getUserMedia' && mutation.object === navigator.mediaDevices) {
        interceptGetUserMedia();
      } else if (mutation.type === 'attributes' && mutation.attributeName === 'getUserMedia' && mutation.target === navigator.mediaDevices) {
        interceptGetUserMedia();
      } else if (mutation.type === 'childList' && mutation.addedNodes) {
        mutation.addedNodes.forEach(node => {
          if (node === navigator.mediaDevices) {
            interceptGetUserMedia();
          }
        });
      }
    }
  });

  function interceptSpeechRecognition() {
    if (!window.SpeechRecognition && !window.webkitSpeechRecognition) {
      return;
    }

    const OriginalSpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;

    const SpeechRecognitionWrapper = function(...args) {
      const recognizer = new OriginalSpeechRecognition(...args);
      const originalStart = recognizer.start.bind(recognizer);

      recognizer.start = function() {
        requestMediaPermissions({ audio: true }).then(granted => {
          if (granted) {
            originalStart();
          } else {
            const errorEvent = new SpeechRecognitionErrorEvent('error');
            errorEvent.error = 'not-allowed'; // This is the standard error for permission denial.
            recognizer.dispatchEvent(errorEvent);
          }
        });
      };

      return recognizer;
    };

    SpeechRecognitionWrapper.prototype = OriginalSpeechRecognition.prototype;
    SpeechRecognitionWrapper.prototype.constructor = SpeechRecognitionWrapper;

    if (window.SpeechRecognition) {
      window.SpeechRecognition = SpeechRecognitionWrapper;
    }
    if (window.webkitSpeechRecognition) {
      window.webkitSpeechRecognition = SpeechRecognitionWrapper;
    }
  }

  interceptSpeechRecognition();

  window.addEventListener('message', function(event) {
    if (event.data) {
      if (event.data.type === 'resolveMediaPermission') {
        const { promiseId, granted } = event.data;
        if (pendingMediaResolvers[promiseId]) {
          pendingMediaResolvers[promiseId](granted);
        }
      }
    }
  });

})();</script><script>((function(modelInformation) {
  const originalFetch = window.fetch;
  // TODO: b/421908508 - Move these out of the script and match all generative AI model calls.
  let googleLlmBaseApiUrls = [
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.textModelName + ':streamGenerateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.textModelName + ':generateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageModelName + ':predict',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageModelName + ':predictLongRunning',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageEditModelName + ':generateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.videoModelName + ':predict',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.videoModelName + ':predictLongRunning',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.ttsModelName + ':generateContent',
  ];
  modelInformation.deprecatedTextModelNames.forEach((modelName) => {
    googleLlmBaseApiUrls.push(
      'https://generativelanguage.googleapis.com/v1beta/models/' + modelName + ':streamGenerateContent',
      'https://generativelanguage.googleapis.com/v1beta/models/' + modelName + ':generateContent',
    );
  });

  const pendingFetchResolvers = {};
  let nextPromiseId = 0;

  function handleStringInput(input, optionsArgument) {
    const actualUrl = input;
    const fetchCallArgs = [actualUrl, optionsArgument];
    const effectiveOptions = optionsArgument || {};
    const bodyForApiKeyCheck = effectiveOptions.body;
    const bodyForPostMessage = effectiveOptions.body;
    return { actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage };
  }

  function handleRequestInput(input, optionsArgument) {
    const actualUrl = input.url;
    const fetchCallArgs = [input, optionsArgument];
    const effectiveOptions = { method: input.method, headers: new Headers(input.headers) };
    let bodyForApiKeyCheck;
    let bodyForPostMessage;

    if (optionsArgument) {
      if (optionsArgument.method) effectiveOptions.method = optionsArgument.method;
      if (optionsArgument.headers) effectiveOptions.headers = new Headers(optionsArgument.headers);
      if ('body' in optionsArgument) {
        bodyForApiKeyCheck = optionsArgument.body;
        bodyForPostMessage = optionsArgument.body;
      } else {
        bodyForApiKeyCheck = undefined;
        bodyForPostMessage = input.body;
      }
    } else {
      bodyForApiKeyCheck = undefined;
      bodyForPostMessage = input.body;
    }
    return { actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage };
  }

  window.fetch = function(input, optionsArgument) {
    let actualUrl;
    let fetchCallArgs;
    let effectiveOptions = {};
    let bodyForApiKeyCheck;
    let bodyForPostMessage;

    if (typeof input === 'string') {
      ({actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage} = handleStringInput(input, optionsArgument));
    } else if (input instanceof Request) {
      ({actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage} = handleRequestInput(input, optionsArgument));
    } else {
      return originalFetch.apply(window, [input, optionsArgument]);
    }

    effectiveOptions.method = effectiveOptions.method || 'GET';
    if (!effectiveOptions.headers) {
      effectiveOptions.headers = new Headers();
    }


    if (typeof actualUrl === 'string' && googleLlmBaseApiUrls.some((url) => actualUrl.startsWith(url))) {
      let apiKeyIsNull = true;

      const regex = new RegExp("models/([^:]+)");
      const modelNameMatch = actualUrl.match(regex);
      const modelName = modelNameMatch ? modelNameMatch[1] : 'unspecified';


      try {
        const urlObject = new URL(actualUrl);  // Use URL object for robust parsing
        const apiKeyParam = urlObject.searchParams.get('key');
        if (apiKeyParam) {
          apiKeyIsNull = false;
        }
      } catch (e) {
        // Continue checks even if URL parsing fails
      }

      if (apiKeyIsNull && effectiveOptions.headers) {
        const h = new Headers(effectiveOptions.headers);
        const apiKeyHeaderValue = h.get('X-API-Key') || h.get('x-api-key');
        if (apiKeyHeaderValue) {
          apiKeyIsNull = false;
          return originalFetch.apply(window, fetchCallArgs);
        }
      }

      if (apiKeyIsNull && effectiveOptions.method && ['POST', 'PUT', 'PATCH'].includes(effectiveOptions.method.toUpperCase()) && typeof bodyForApiKeyCheck === 'string') {
        try {
          const bodyData = JSON.parse(bodyForApiKeyCheck);
          if (bodyData && bodyData.apiKey) {
            apiKeyIsNull = false;
            return originalFetch.apply(window, fetchCallArgs);
          }
        } catch (e) {
          // Ignore JSON parsing errors
        }
      }

      if(apiKeyIsNull) {
        const promiseId = nextPromiseId++;
        const promise = new Promise((resolve) => {
          pendingFetchResolvers[promiseId] = (resolvedResponse) => {
            delete pendingFetchResolvers[promiseId];
            resolve(resolvedResponse);
          };
        });

        let serializedBodyForPostMessage;
        if (typeof bodyForPostMessage === 'string' || bodyForPostMessage == null) {
            serializedBodyForPostMessage = bodyForPostMessage;
        } else if (bodyForPostMessage instanceof ReadableStream) {
            serializedBodyForPostMessage = null;
        } else {
            try {
                serializedBodyForPostMessage = JSON.stringify(bodyForPostMessage);
            } catch (e) {
                serializedBodyForPostMessage = null;
            }
        }

        const messageOptions = {
            method: effectiveOptions.method,
            headers: Object.fromEntries(new Headers(effectiveOptions.headers).entries()),
            body: serializedBodyForPostMessage
        };

        window.parent.postMessage({
          type: 'requestFetch',
          url: actualUrl,
          modelName: modelName,
          options: messageOptions,
          promiseId: promiseId,
        }, '*');

        return promise;
      }
      return originalFetch.apply(window, fetchCallArgs);
    }
    return originalFetch.apply(window, fetchCallArgs);
  };

  window.addEventListener('message', function(event) {
    if (event.data && event.data.type === 'resolveFetch') {
      const { promiseId, response } = event.data;
      if (pendingFetchResolvers[promiseId]) {
        try {
          const reconstructedResponse = new Response(response.body, {
            status: response.status,
            statusText: response.statusText,
            headers: new Headers(response.headers),
          });
          pendingFetchResolvers[promiseId](reconstructedResponse);
        } catch (error) {
          pendingFetchResolvers[promiseId](new Response(null, { status: 500, statusText: "Interceptor Response Reconstruction Error" }));
        }
      }
    }
  });

}))({"textModelName":"gemini-2.5-flash-preview-05-20","imageModelName":"imagen-3.0-generate-002","imageEditModelName":"gemini-2.5-flash-image-preview","videoModelName":"veo-2.0-generate-001","ttsModelName":"gemini-2.5-flash-preview-tts","deprecatedTextModelNames":["gemini-2.0-flash","gemini-2.5-flash-preview-04-17"]})</script><script>(function() {
  const originalConsoleLog = console.log;
  const originalConsoleError = console.error;

    /**
   * Normalizes an error event or a promise rejection reason into a structured error object.
   * @param {*} errorEventOrReason The error object or reason.
   * @return {object} Structured error data { message, name, stack }.
   */
  function getErrorObject(errorEventOrReason) {
    if (errorEventOrReason instanceof Error) {
      return {
        message: errorEventOrReason.message,
        name: errorEventOrReason.name,
        stack: errorEventOrReason.stack,
      };
    }
    // Fallback for non-Error objects.
    try {
      return {
        message: JSON.stringify(errorEventOrReason),
        name: 'UnknownErrorType',
        stack: null,
      };
    } catch (e) {
      return {
        message: String(errorEventOrReason),
        name: 'UnknownErrorTypeNonStringifiable',
        stack: null,
      };
    }
  }

  /**
   * Converts an array of arguments (from log/error) into a single string.
   * Handles Error objects specially to include their message and stack.
   * @param {Array<*>} args - Arguments passed to console methods.
   * @return {string} A string representation of the arguments.
   */
  function stringifyArgs(args) {
    return args
      .map((arg) => {
        if (arg instanceof Error) {
          const {message, stack} = arg;
          return `Error: ${message}${stack ? ('\nStack: ' + stack) : ''}`;
        }
        if (typeof arg === 'object' && arg !== null) {
          try {
            return JSON.stringify(arg);
          } catch (error) {
            return '[Circular Object]';
          }
        } else {
          return String(arg);
        }
      })
      .join(' ');
  }

  console.log = function(...args) {
    const logString = stringifyArgs(args);
    window.parent.postMessage({ type: 'log', message: logString }, '*');
    originalConsoleLog.apply(console, args);
  };

  console.error = function(...args) {
    let errorData;
    if (args.length > 0 && args[0] instanceof Error) {
      const err = args[0];
      // If the first arg is an Error, capture its details.
      errorData = {
        type: 'error',
        source: 'CONSOLE_ERROR',
        ...getErrorObject(err),
        rawArgsString: stringifyArgs(args.slice(1)),
        timestamp: new Date().toISOString(),
      };
    } else {
      // If not an Error object, treat all args as a general error message.
      errorData = {
        type: 'error',
        source: 'CONSOLE_ERROR',
        message: stringifyArgs(args),
        name: 'ConsoleLoggedError',
        stack: null,
        timestamp: new Date().toISOString(),
      };
    }
    window.parent.postMessage(errorData, '*');
    originalConsoleError.apply(console, args);
  };

  // Listen for global unhandled synchronous errors.
  window.addEventListener('error', function(event) {
    const errorDetails = event.error ? getErrorObject(event.error) : {
      message: event.message,
      name: 'GlobalError',
      stack: null,
      filename: event.filename,
      lineno: event.lineno,
      colno: event.colno,
    };

    window.parent.postMessage({
      type: 'error',
      source: 'global',
      ...errorDetails,
      message: errorDetails.message || event.message,
      timestamp: new Date().toISOString(),
    }, '*');
  });

  // Listen for unhandled promise rejections (asynchronous errors).
  window.addEventListener('unhandledrejection', function(event) {
    const errorDetails = getErrorObject(event.reason);

    window.parent.postMessage({
      type: 'error',
      source: 'unhandledrejection',
      ...errorDetails,
      message: errorDetails.message || 'Unhandled Promise Rejection',
      timestamp: new Date().toISOString(),
    }, '*');
  });

})();</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>和平的代價：黃金獨舞，石油為何被冷落？</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0/dist/chartjs-plugin-datalabels.min.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js" crossorigin="anonymous"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&amp;display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #FDFBF7;
        }
        .card-shadow {
             box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        }
        h2.story-title {
            text-align: center;
            font-size: 1.875rem;
            line-height: 2.25rem;
            font-weight: 700;
            color: #655A4E;
            margin-bottom: 1.5rem;
            border-bottom: 2px solid #C8B6A6;
            padding-bottom: 1rem;
        }
        h3 {
            border-bottom: 2px solid #EAE0D5;
            padding-bottom: 0.5rem;
            margin-top: 2rem;
            margin-bottom: 1rem;
            font-size: 1.25rem;
            font-weight: 700;
            color: #8D7B68;
        }
        .chart-container {
            position: relative;
            width: 100%;
            margin-left: auto;
            margin-right: auto;
        }
        .gauge-chart-container {
            position: relative;
            width: 100%;
            max-width: 250px;
            margin: 0 auto;
            height: 125px;
        }
        .pulse-item {
            background-color: #F9F6F2;
            padding: 1rem;
            border-radius: 0.5rem;
            border-left: 4px solid #C8B6A6;
        }
        .emphasis {
            background-color: #FFF8E1;
            padding: 1rem;
            border-left: 4px solid #FFC107;
            border-radius: 0.25rem;
            margin: 1rem 0;
        }
        .download-btn {
            position: fixed;
            bottom: 1.5rem;
            right: 1.5rem;
            z-index: 50;
        }
    </style>
<style>*, ::before, ::after{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }/* ! tailwindcss v3.4.17 | MIT License | https://tailwindcss.com */*,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}::after,::before{--tw-content:''}:host,html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}.container{width:100%}@media (min-width: 640px){.container{max-width:640px}}@media (min-width: 768px){.container{max-width:768px}}@media (min-width: 1024px){.container{max-width:1024px}}@media (min-width: 1280px){.container{max-width:1280px}}@media (min-width: 1536px){.container{max-width:1536px}}.mx-auto{margin-left:auto;margin-right:auto}.mb-10{margin-bottom:2.5rem}.mb-12{margin-bottom:3rem}.mb-2{margin-bottom:0.5rem}.mb-4{margin-bottom:1rem}.mb-6{margin-bottom:1.5rem}.mb-8{margin-bottom:2rem}.mt-12{margin-top:3rem}.mt-2{margin-top:0.5rem}.mt-8{margin-top:2rem}.grid{display:grid}.h-6{height:1.5rem}.h-64{height:16rem}.h-80{height:20rem}.h-96{height:24rem}.w-6{width:1.5rem}.max-w-7xl{max-width:80rem}.grid-cols-1{grid-template-columns:repeat(1, minmax(0, 1fr))}.gap-8{gap:2rem}.space-y-4 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(1rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1rem * var(--tw-space-y-reverse))}.rounded-full{border-radius:9999px}.rounded-lg{border-radius:0.5rem}.bg-\[\#655A4E\]{--tw-bg-opacity:1;background-color:rgb(101 90 78 / var(--tw-bg-opacity, 1))}.bg-white{--tw-bg-opacity:1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.p-3{padding:0.75rem}.p-4{padding:1rem}.text-center{text-align:center}.text-3xl{font-size:1.875rem;line-height:2.25rem}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-sm{font-size:0.875rem;line-height:1.25rem}.text-xs{font-size:0.75rem;line-height:1rem}.font-bold{font-weight:700}.font-semibold{font-weight:600}.italic{font-style:italic}.leading-relaxed{line-height:1.625}.text-\[\#655A4E\]{--tw-text-opacity:1;color:rgb(101 90 78 / var(--tw-text-opacity, 1))}.text-\[\#8D7B68\]{--tw-text-opacity:1;color:rgb(141 123 104 / var(--tw-text-opacity, 1))}.text-gray-500{--tw-text-opacity:1;color:rgb(107 114 128 / var(--tw-text-opacity, 1))}.text-gray-600{--tw-text-opacity:1;color:rgb(75 85 99 / var(--tw-text-opacity, 1))}.text-gray-700{--tw-text-opacity:1;color:rgb(55 65 81 / var(--tw-text-opacity, 1))}.text-gray-800{--tw-text-opacity:1;color:rgb(31 41 55 / var(--tw-text-opacity, 1))}.text-orange-500{--tw-text-opacity:1;color:rgb(249 115 22 / var(--tw-text-opacity, 1))}.text-white{--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.shadow-lg{--tw-shadow:0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.transition-colors{transition-property:color, background-color, border-color, fill, stroke, -webkit-text-decoration-color;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, -webkit-text-decoration-color;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.hover\:bg-\[\#8D7B68\]:hover{--tw-bg-opacity:1;background-color:rgb(141 123 104 / var(--tw-bg-opacity, 1))}.focus\:outline-none:focus{outline:2px solid transparent;outline-offset:2px}.focus\:ring-2:focus{--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 #0000)}.focus\:ring-\[\#655A4E\]:focus{--tw-ring-opacity:1;--tw-ring-color:rgb(101 90 78 / var(--tw-ring-opacity, 1))}.focus\:ring-offset-2:focus{--tw-ring-offset-width:2px}@media (min-width: 768px){.md\:h-96{height:24rem}.md\:grid-cols-2{grid-template-columns:repeat(2, minmax(0, 1fr))}.md\:p-8{padding:2rem}.md\:text-4xl{font-size:2.25rem;line-height:2.5rem}}</style></head>
<body class="text-gray-800">

    <div class="container mx-auto p-4 md:p-8 max-w-7xl">
        <header class="text-center mb-10">
            <h1 class="text-3xl md:text-4xl font-bold text-[#655A4E]">和平的代價：黃金獨舞，石油為何被冷落？</h1>
            <p class="text-lg text-[#8D7B68]">一份融合BofA報告與市場智慧的深度解讀 (截至2025年10月12日)</p>
        </header>

        <main>
             <section class="mb-12">
                <h2 class="story-title">序章：市場的脈動，三分鐘速覽</h2>
                <p class="text-lg text-gray-700 leading-relaxed mb-6">
                    在我們揭開本週市場大戲的序幕之前，先來感受一下華爾街此刻最真實的脈搏。美國銀行最新的報告，用幾句精煉的話，就捕捉到了這個充滿矛盾與機遇的時刻。這幾句話，不僅僅是數據，更是解讀市場情緒的鑰匙。
                </p>
                <div class="space-y-4">
                    <div class="pulse-item">
                        <p class="font-bold">時代精神 (Zeitgeist):</p>
                        <p class="italic text-gray-700">"我正在和X吃午餐，他問我現在投資實體黃金或白銀是否為時已晚，因為他的紅酒投資一直在虧損？" - 來自一位姊夫的真實焦慮。</p>
                        <p class="text-sm text-gray-600 mt-2">解讀：這句話生動地描繪了當前市場的氣氛——傳統避險資產（如昂貴的紅酒）失靈，資金正在瘋狂尋找新的避風港，而黃金成了最耀眼的明星。</p>
                    </div>
                    <div class="pulse-item">
                        <p class="font-bold">價格的玄機 (The Price is Right):</p>
                        <p class="text-gray-700">一個關鍵信號：信貸市場正在浮現裂痕！BDC（商業發展公司）指數跌破四月低點，私募股權和垃圾債券也開始走弱。這就是華爾街牛市與實體經濟熊市之間的「黏合劑」開始剝落的跡象。因此，戰術性做多美元和零息債券，是對沖「次級消費」風險蔓延的明智之舉。</p>
                    </div>
                    <div class="pulse-item">
                        <p class="font-bold">資金流的真相 (Tale of the Tape):</p>
                        <p class="text-gray-700">儘管金價一度衝擊4000美元失敗，市場上真正長期持有黃金的資金依然少得可憐（私人客戶資產僅0.5%，機構客戶僅2.3%）。這意味著什麼？黃金的漲勢，還遠未到終點。</p>
                    </div>
                </div>
             </section>

            <section class="mb-12">
                <h2 class="story-title">第一章：黃金的獨舞，一場反常的盛宴</h2>
                <p class="text-lg text-gray-700 leading-relaxed mb-6">
                    故事的開頭，聚光燈完全打在黃金身上。2025年，黃金以超過53%的驚人回報，傲視群雄，把比特幣、股票遠遠甩在身後。這不僅僅是數字上的勝利，更是一種市場邏輯的顛覆。歷史上，黃金和石油的價格走勢總像一對舞伴，同漲同跌。但在過去幾個月，這對舞伴徹底分道揚鑣。
                </p>
                <div class="chart-container h-96 mb-8"><canvas id="ytdReturnsChart" width="2206" height="768" style="display: block; box-sizing: border-box; height: 384px; width: 1103px;"></canvas></div>
                
                 <p class="text-lg text-gray-700 leading-relaxed mb-6">
                    BofA的數據呈現了一個驚人的畫面：在2022年6月，買一盎司黃金只需要15桶石油；而到了今天，卻需要驚人的61桶！黃金與石油的價格比達到了歷史性的高位。這種「金價大漲、油價大跌」的組合，在過去幾十年的歷史數據中，幾乎是從未發生過的異常現象。
                </p>
                <div class="chart-container h-80 mb-8"><canvas id="goldVsOilRatioChart" width="2206" height="640" style="display: block; box-sizing: border-box; height: 320px; width: 1103px;"></canvas></div>

                <div class="emphasis">
                    <p class="text-lg font-semibold">這場黃金的獨舞背後，是市場避險邏輯的重構。正如我們在10月10日美股暴跌中所看到的，當市場陷入恐慌時，資金本能地湧向黃金和美國公債。那天，黃金逆勢大漲超過2%，再次證明了它在亂世中的王者地位。市場不再相信傳統的經濟增長故事，轉而尋求最原始、最可靠的價值儲存。</p>
                </div>
                 <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div class="text-center p-4 bg-white rounded-lg card-shadow">
                        <h4 class="font-bold text-lg text-[#655A4E] mb-2">黃金 vs. 石油 (年度價格變化)</h4>
                        <div class="chart-container h-64"><canvas id="goldVsOilScatterChart" width="1007" height="512" style="display: block; box-sizing: border-box; height: 256px; width: 503px;"></canvas></div>
                         <p class="mt-2 text-sm text-gray-600">2025年的數據點（紅星）處於一個極不尋常的象限，歷史上極為罕見。</p>
                    </div>
                    <div class="text-center p-4 bg-white rounded-lg card-shadow">
                        <h4 class="font-bold text-lg text-[#655A4E] mb-2">牛熊指標</h4>
                        <div class="gauge-chart-container"><canvas id="gaugeBullBearChart" width="500" height="250" style="display: block; box-sizing: border-box; height: 125px; width: 250px;"></canvas></div>
                        <p class="mt-2 text-sm text-gray-600">狀態：<strong class="text-orange-500">貪婪</strong>。指標維持在6.5的高位，顯示市場情緒依然樂觀，但已接近賣出區域。</p>
                    </div>
                </div>
            </section>

            <section class="mb-12">
                <h2 class="story-title">第二章：被冷落的石油與信貸的裂縫</h2>
                <p class="text-lg text-gray-700 leading-relaxed mb-6">
                    如果黃金是舞台上的主角，那麼石油就是那個被遺忘在角落的配角。油價今年以來下跌超過12%，與黃金的風光無限形成鮮明對比。更有趣的是，BofA大膽預測，第四季度市場最大的驚喜，可能就是油價進一步跌至每桶50美元。這背後指向一個宏大的地緣政治敘事——<strong>和平的交易</strong>。
                </p>
                <p class="text-lg text-gray-700 leading-relaxed mb-6">
                    報告暗示，為了換取中東地區的和平穩定以及發展所需的資金（目前以色列和沙烏地阿拉伯的預算赤字都高達GDP的5%），OPEC可能會增加石油供應。一個更低的油價，對於亟需控制通膨的美國、歐洲和日本消費者來說，無疑是天大的好消息，同時也能滿足AI數據中心龐大的電力需求。這是一個用石油換取和平與發展的劇本。
                </p>
                 <div class="emphasis">
                    <p class="text-lg font-semibold">然而，油價的疲軟和實體經濟的降溫，正在另一個領域撕開裂口——信貸市場。BofA警告，那些投資於中小企業的BDC（商業發展公司）指數已經跌破了4月份的低點，這是一個非常危險的信號，通常預示著更廣泛的信貸緊縮即將到來。10月10日的市場暴跌，也正是由「政府永久性裁員」這個打擊實體經濟信心的消息所引爆。</p>
                </div>
                <div class="chart-container h-80 md:h-96 mb-8"><canvas id="bdcIndexChart" width="2206" height="768" style="display: block; box-sizing: border-box; height: 384px; width: 1103px;"></canvas></div>
            </section>

            <section class="mb-12">
                 <h2 class="story-title">第三章：資金在裂縫中尋找出路</h2>
                 <p class="text-lg text-gray-700 leading-relaxed mb-6">
                    面對黃金與石油的分化，以及信貸市場的警報，聰明的資金正在進行一場「靜悄悄的遷徙」。它們不是在逃離市場，而是在市場內部尋找新的結構性機會。本週的資金流向數據，清晰地揭示了這場大遷徙的路徑。
                </p>
                 <p class="text-lg text-gray-700 leading-relaxed mb-6">
                    本週，高達729億美元湧入現金，顯示市場的避險情緒濃厚。但同時，我們也看到了創紀錄的76億美元流入<strong>原物料</strong>板塊，醫療保健板塊也迎來了2023年4月以來最大的單週流入。這說明資金並非一味避險，而是在進行精準的「啞鈴式配置」：一頭是安全的現金，另一頭則是與實體經濟、通膨和地緣政治相關的「硬資產」。
                </p>
                 <div class="chart-container h-96 mb-8"><canvas id="weeklyFlowsChart" width="2206" height="768" style="display: block; box-sizing: border-box; height: 384px; width: 1103px;"></canvas></div>
                 
                 <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div class="text-center p-4 bg-white rounded-lg card-shadow">
                        <h4 class="font-bold text-lg text-[#655A4E] mb-2">原物料資金流</h4>
                        <div class="chart-container h-64"><canvas id="materialsFlowChart" width="1007" height="512" style="display: block; box-sizing: border-box; height: 256px; width: 503px;"></canvas></div>
                         <p class="mt-2 text-sm text-gray-600">今年至今流入原物料的資金，正朝著創紀錄的790億美元邁進。</p>
                    </div>
                    <div class="text-center p-4 bg-white rounded-lg card-shadow">
                        <h4 class="font-bold text-lg text-[#655A4E] mb-2">醫療保健資金流</h4>
                        <div class="chart-container h-64"><canvas id="healthcareFlowChart" width="1007" height="512" style="display: block; box-sizing: border-box; height: 256px; width: 503px;"></canvas></div>
                        <p class="mt-2 text-sm text-gray-600">迎來了近一年半以來的最大單週資金流入。</p>
                    </div>
                </div>
                
                 <div class="emphasis mt-8">
                    <p class="text-lg font-semibold">BofA私人客戶的行為也驗證了這一點。他們正在賣出成長股、公用事業和必需消費品ETF，轉而買入市政債、高收益債和投資級債券ETF。這是一場從「故事性」資產向「收益性」資產的轉移。當市場充斥不確定性時，穩定的現金流和收益變得比虛無縹緲的成長故事更具吸引力。</p>
                </div>
                <div class="chart-container h-96"><canvas id="privateClientFlowsChart" width="2206" height="768" style="display: block; box-sizing: border-box; height: 384px; width: 1103px;"></canvas></div>
            </section>

            <section class="mb-12">
                <h2 class="story-title">最終章：在分化的世界中，如何佈局？</h2>
                <p class="text-lg text-gray-700 leading-relaxed mb-6">
                    我們正處在一個極度分化的世界：黃金在狂歡，石油在哭泣；華爾街看似繁榮，但實體經濟的裂縫正在擴大。在這樣一個複雜的棋局中，我們該如何落子？
                </p>
                <h3>1. 持有核心避險資產（黃金 &amp; 美元）</h3>
                <p class="text-gray-700 mb-4">黃金的故事還遠未結束。無論是為了對沖地緣政治風險，還是防範「去美元化」的長期趨勢，黃金都是不可或缺的核心配置。同時，BofA也建議戰術性持有美元，因為一旦信貸危機爆發，美元將是最終的避風港。</p>

                <h3>2. 關注「硬資產」與「真需求」</h3>
                <p class="text-gray-700 mb-4">市場的資金正在告訴我們，故事講完了，接下來要看的是真實的需求和資產。創紀錄流入原物料的資金，以及YouTube分析師反覆強調的電力、核能、國防安全等板塊，都指向同一個方向：AI革命、製造業回流、地緣政治衝突，這些都需要實實在在的能源、金屬和基礎設施。這些領域的公司，擁有最穩固的現金流和最硬的邏輯支撐。</p>
                
                <h3>3. 為「利率觸頂」做好準備</h3>
                <p class="text-gray-700 mb-4">BofA私人客戶的數據顯示，他們流入中期國債（T-notes）的資金規模已經超過了短期國庫券（T-bills）。這是一個重要的信號，意味著市場上最聰明的一部分錢，已經開始佈局利率觸頂甚至下降的未來。配置零息債券或長天期國債，可能是在下一階段獲得超額回報的關鍵。</p>
                 <div class="chart-container h-80 md:h-96"><canvas id="treasuryInflowChart" width="2206" height="768" style="display: block; box-sizing: border-box; height: 384px; width: 1103px;"></canvas></div>
            </section>
            
            <section>
                <h2 class="story-title">結語</h2>
                <p class="text-lg text-gray-700 leading-relaxed mb-6">
                   本週的市場，完美演繹了一場關於「價值重估」的大戲。當投機的潮水退去，真正堅固的礁石才會浮現。黃金的閃耀，不是因為投機，而是因為它的稀缺與永恆；石油的黯淡，則可能預示著一個以和平換取發展的新時代的到來。在這場變局中，看清資金的流向，抓住真正的需求，遠比追逐短期的熱點更為重要。
                </p>
                
                <div class="mt-8 space-y-4">
                    <div class="pulse-item text-center">
                        <p class="text-lg font-semibold text-gray-800 italic">"The biggest risk of all is not taking one."</p>
                        <p class="text-sm text-gray-600 mt-2">- Peter Lynch (彼得·林區)</p>
                    </div>
                </div>
            </section>

        </main>

        <footer class="text-center mt-12 text-xs text-gray-500">
            <p>免責聲明：本儀表板內容僅為基於公開信息的市場分析，不構成任何投資建議。投資有風險，入市需謹慎。</p>
        </footer>
    </div>
    
    

<script>
document.addEventListener('DOMContentLoaded', function () {
    Chart.defaults.font.family = "'Noto Sans TC', sans-serif";
    Chart.defaults.color = '#655A4E';
    Chart.register(ChartDataLabels);

    const createGaugeChart = (ctx, value, max, color, unit = '') => {
        if (!ctx) return;
        new Chart(ctx, {
            type: 'doughnut',
            data: { datasets: [{ data: [value, max - value], backgroundColor: [color, '#EAEAEA'], borderWidth: 0, circumference: 180, rotation: 270 }] },
            options: {
                responsive: true, maintainAspectRatio: false,
                plugins: {
                    tooltip: { enabled: false },
                    title: { display: true, text: `${value}${unit}`, position: 'bottom', align: 'center', font: { size: 28, weight: 'bold' }, color: color, padding: { top: -45 } }
                },
                cutout: '70%',
            }
        });
    };
    
    createGaugeChart(document.getElementById('gaugeBullBearChart')?.getContext('2d'), 6.5, 10, '#F57C00');

    const ytdReturnsCtx = document.getElementById('ytdReturnsChart');
    if(ytdReturnsCtx) {
        const ytdData = { '黃金': 53.1, '比特幣': 31.1, '股票': 20.3, '投資級債': 9.6, '高收益債': 9.3, '政府公債': 6.4, '大宗商品': 5.7, '現金': 3.3, '美元': -8.8, '石油': -12.8 };
        new Chart(ytdReturnsCtx, {
            type: 'bar',
            data: {
                labels: Object.keys(ytdData),
                datasets: [{
                    label: '年度至今回報率 (%)',
                    data: Object.values(ytdData),
                    backgroundColor: Object.values(ytdData).map(v => v >= 0 ? 'rgba(102, 187, 106, 0.7)' : 'rgba(239, 83, 80, 0.7)'),
                    borderColor: Object.values(ytdData).map(v => v >= 0 ? '#4CAF50' : '#F44336'),
                    borderWidth: 1
                }]
            },
            options: {
                indexAxis: 'x', 
                responsive: true, 
                maintainAspectRatio: false,
                plugins: { 
                    legend: { display: false }, 
                    title: { display: true, text: '年度至今各大類資產回報排行', font: {size: 16}},
                    datalabels: {
                        anchor: 'end',
                        align: 'top',
                        formatter: (value) => value + '%',
                        font: {
                            weight: 'bold'
                        }
                    }
                },
                scales: { 
                    x: { ticks: { font: { size: 10 } } },
                    y: { ticks: { callback: (value) => value + '%' } }
                }
            }
        });
    }

    const goldVsOilRatioCtx = document.getElementById('goldVsOilRatioChart');
    if (goldVsOilRatioCtx) {
        new Chart(goldVsOilRatioCtx, {
            type: 'line',
            data: {
                labels: ['1988', '1994', '1998', '2009', '2016', '2020', '2022', '2025'],
                datasets: [{
                    label: '黃金/石油價格比',
                    data: [35, 30, 31, 25, 41, 87, 15, 61],
                    borderColor: '#FFC107',
                    backgroundColor: 'rgba(255, 193, 7, 0.2)',
                    fill: true,
                    tension: 0.1
                }]
            },
            options: {
                responsive: true, maintainAspectRatio: false,
                plugins: { title: { display: true, text: '買一盎司黃金需要多少桶石油', font: { size: 16 } }, legend: { display: false } },
                scales: { y: { beginAtZero: false, title: { display: true, text: '桶/盎司'}}}
            }
        });
    }

    const goldVsOilScatterCtx = document.getElementById('goldVsOilScatterChart');
    if (goldVsOilScatterCtx) {
        new Chart(goldVsOilScatterCtx, {
            type: 'scatter',
            data: {
                datasets: [
                    { label: '歷史數據', data: [ {x: 10, y: 20}, {x: -10, y: -20}, {x: 20, y: 40}, {x: 65, y: 105}, {x: 75, y: 125}, {x: 125, y: 90} ], backgroundColor: 'rgba(120, 120, 120, 0.5)' },
                    { label: '2025年', data: [{x: 80, y: -18}], backgroundColor: 'red', pointStyle: 'star', radius: 15, borderColor: 'red' }
                ]
            },
            options: {
                responsive: true, maintainAspectRatio: false,
                plugins: { 
                    legend: { 
                        position: 'bottom',
                        labels: {
                            usePointStyle: true,
                        }
                    } 
                },
                scales: {
                    x: { type: 'linear', position: 'bottom', title: { display: true, text: '黃金價格年變動 (%)' } },
                    y: { title: { display: true, text: '石油價格年變動 (%)' } }
                }
            }
        });
    }

    const bdcIndexCtx = document.getElementById('bdcIndexChart');
    if (bdcIndexCtx) {
        new Chart(bdcIndexCtx, {
            type: 'line',
            data: {
                labels: ['2020', '2021', '2022', '2023', '2024', '2025', '2026'],
                datasets: [{
                    label: 'MVIS美國商業發展公司指數',
                    data: [540, 550, 480, 520, 530, 440, 430],
                    borderColor: '#C62828',
                    fill: false,
                    tension: 0.1
                }]
            },
            options: {
                responsive: true, maintainAspectRatio: false,
                plugins: { title: { display: true, text: 'BDC指數已跌破前期低點', font: { size: 16 } }, legend: { display: false } },
                scales: { y: { beginAtZero: false }}
            }
        });
    }
    
    const weeklyFlowsCtx = document.getElementById('weeklyFlowsChart');
    if(weeklyFlowsCtx) {
        const weeklyFlowsData = { '現金': 72.9, '債券': 25.6, '股票': 20.0, '加密貨幣': 5.5, '黃金': 2.1 };
         new Chart(weeklyFlowsCtx, {
            type: 'bar',
            data: {
                labels: Object.keys(weeklyFlowsData),
                datasets: [{
                    label: '單週資金流 (十億美元)',
                    data: Object.values(weeklyFlowsData),
                    backgroundColor: 'rgba(66, 165, 245, 0.7)',
                    borderColor: '#1E88E5',
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true, maintainAspectRatio: false,
                plugins: { legend: { display: false }, title: { display: true, text: '本週主要資產資金流向', font: {size: 16}} },
                scales: { y: { ticks: { callback: (value) => '$' + value + 'bn' } } }
            }
        });
    }

    const materialsFlowCtx = document.getElementById('materialsFlowChart');
    if(materialsFlowCtx) {
        new Chart(materialsFlowCtx, {
            type: 'line',
            data: {
                labels: ['2024', '2025', '2026'],
                datasets: [{
                    label: '原物料基金累計流量',
                    data: [10, -5, 79],
                    borderColor: '#8D7B68', fill: true, tension: 0.3
                }]
            },
            options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } } }
        });
    }

    const healthcareFlowCtx = document.getElementById('healthcareFlowChart');
    if (healthcareFlowCtx) {
        new Chart(healthcareFlowCtx, {
            type: 'bar',
            data: {
                labels: ['W1', 'W2', 'W3', 'W4 (Oct\'25)'],
                datasets: [
                    { label: '週流量', data: [0.5, -0.8, 0.2, 1.5], backgroundColor: '#42A5F5' },
                    { type: 'line', label: '4週移動平均', data: [0.1, -0.1, -0.05, 0.35], borderColor: '#1E88E5', tension: 0.2 }
                ]
            },
            options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'bottom' } } }
        });
    }

    const privateClientFlowsCtx = document.getElementById('privateClientFlowsChart');
    if (privateClientFlowsCtx) {
        const flowData = {
            '市政債': 5.2, '高收益債': 4.5, '投資級債': 3.2, '貴金屬': 3.0, '新興市場債': 2.5, '不動產信託': 2.0, '價值股': 1.0, 
            '成長股': -2.8, '公用事業': -2.5, '必需消費品': -2.0, '醫療保健': -1.8, '日本股票': -1.5, '非必需消費品': -1.0, '美國股票': -0.5
        };
        new Chart(privateClientFlowsCtx, {
            type: 'bar',
            data: {
                labels: Object.keys(flowData),
                datasets: [{
                    data: Object.values(flowData),
                    backgroundColor: Object.values(flowData).map(v => v > 0 ? 'rgba(66, 165, 245, 0.7)' : 'rgba(239, 83, 80, 0.7)'),
                }]
            },
            options: {
                indexAxis: 'x', 
                responsive: true, 
                maintainAspectRatio: false,
                plugins: { 
                    legend: { display: false }, 
                    title: { display: true, text: 'BofA私人客戶近4週資金流向 (% AUM)', font: { size: 16 }},
                    datalabels: {
                        anchor: 'end',
                        align: 'top',
                        formatter: (value) => value.toFixed(1) + '%',
                        font: {
                            weight: 'bold'
                        },
                        rotation: -45,
                        color: function(context) {
                            return context.dataset.data[context.dataIndex] > 0 ? '#1E88E5' : '#E53935';
                        }
                    }
                },
                scales: { 
                    x: { ticks: { font: { size: 9 }}},
                    y: { ticks: { callback: (value) => value + '%' } } 
                }
            }
        });
    }
    
    const treasuryInflowCtx = document.getElementById('treasuryInflowChart');
    if (treasuryInflowCtx) {
        new Chart(treasuryInflowCtx, {
            type: 'line',
            data: {
                labels: ['2022', '2023', '2024', '2025', '2026'],
                datasets: [
                    { label: 'T-bills (短期)', data: [-5, 40, 70, 45, 39], borderColor: '#42A5F5' },
                    { label: 'T-notes (中期)', data: [0, 15, 30, 42, 45], borderColor: '#66BB6A' },
                    { label: 'T-bonds (長期)', data: [0, 1, 1.5, 2, 3], borderColor: '#FFA726' }
                ]
            },
            options: {
                responsive: true, maintainAspectRatio: false,
                plugins: { title: { display: true, text: '私人客戶國債累計流入 (十億美元)', font: { size: 16 } }, legend: { position: 'bottom' } },
                scales: { y: { title: { display: true, text: '金額 ($bn)' } } }
            }
        });
    }

    // Download button logic
    const downloadBtn = document.getElementById('downloadBtn');
    if (downloadBtn) {
        downloadBtn.addEventListener('click', function() {
            const reportDate = "20251012";
            const title = "和平的代價：黃金獨舞，石油為何被冷落？";
            const filename = `${reportDate}_BofA_The Flow_Show_${title}.html`;
            
            const clonedDoc = document.documentElement.cloneNode(true);
            const btnToRemove = clonedDoc.querySelector('#downloadBtn');
            if(btnToRemove){ btnToRemove.remove(); }

            const blob = new Blob([clonedDoc.outerHTML], { type: 'text/html;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        });
    }
});
</script>





</body></html>