<html lang="zh-Hant"><head><script>(function(firebaseConfig, initialAuthToken, appId) {
        window.__firebase_config = firebaseConfig;
        window.__initial_auth_token = initialAuthToken;
        window.__app_id = appId;
            })("\n{\n  \"apiKey\": \"AIzaSyCqyCcs2R2e7AegGjvFAwG98wlamtbHvZY\",\n  \"authDomain\": \"bard-frontend.firebaseapp.com\",\n  \"projectId\": \"bard-frontend\",\n  \"storageBucket\": \"bard-frontend.firebasestorage.app\",\n  \"messagingSenderId\": \"175205271074\",\n  \"appId\": \"1:175205271074:web:2b7bd4d34d33bf38e6ec7b\"\n}\n","eyJhbGciOiJSUzI1NiIsImtpZCI6IjIyMGExMzQ5NmMwYWQ5MjJkZmZkZGViMjk3MzJlZDQ4ZjFlY2Q0YTMiLCJ0eXAiOiJKV1QifQ.eyJzdWIiOiJmaXJlYmFzZS1hZG1pbnNkay1mYnN2Y0BiYXJkLWZyb250ZW5kLmlhbS5nc2VydmljZWFjY291bnQuY29tIiwiYXVkIjoiaHR0cHM6Ly9pZGVudGl0eXRvb2xraXQuZ29vZ2xlYXBpcy5jb20vZ29vZ2xlLmlkZW50aXR5LmlkZW50aXR5dG9vbGtpdC52MS5JZGVudGl0eVRvb2xraXQiLCJ1aWQiOiIwMTYyNzg3NDM4ODM1OTc2Mjk5OCIsImlzcyI6ImZpcmViYXNlLWFkbWluc2RrLWZic3ZjQGJhcmQtZnJvbnRlbmQuaWFtLmdzZXJ2aWNlYWNjb3VudC5jb20iLCJjbGFpbXMiOnsiYXBwSWQiOiJjX2YwZWQzMDdlYjZhMDA4MWRfMjAyNTEwMTJfQm9mQV9UaGUgRmxvd19TaG93X3YyLmh0bWwtNDQzIn0sImV4cCI6MTc2MDM1NzE0MywiaWF0IjoxNzYwMzUzNTQzLCJhbGciOiJSUzI1NiJ9.ZR9hDniS-yyJfneudmlisWhFWpRO3s5XaP5syEduylWQm6-azzoqY1jnb4hamVKu8mhk4IaEQygl9VSnU-HRsioaQunB1vTNC7duW2qN3x6wVDvnO7DNY6YeqLZzDnJs5QmUwjHvh_4HI2GnUGhVWpErhHJG5vdwGGXG7GvkpoQNrF2ijzHzahoFmCeQaEukAYKLGy4wRb6Kc1mxdJeRaQ1lNYWs0-hfA-SlWLLMSf2BC6WV1ouh1ubIoGgT5vQemBMZjC9Jle8s2rOplZjugNoM3CxrKJP_oKLvOBWh9kzZBPQsgK1wpeqCNiZMOqOXVEjt2W6hIto2Qg3C46-dbQ","c_f0ed307eb6a0081d_20251012_BofA_The Flow_Show_v2.html-443")</script><script>'use strict';var h=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,b,d){if(a==Array.prototype||a==Object.prototype)return a;a[b]=d.value;return a};function l(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var d=a[b];if(d&&d.Math==Math)return d}throw Error("Cannot find global object");}var n=l(this);
function p(a,b){if(b)a:{var d=n;a=a.split(".");for(var c=0;c<a.length-1;c++){var e=a[c];if(!(e in d))break a;d=d[e]}a=a[a.length-1];c=d[a];b=b(c);b!=c&&b!=null&&h(d,a,{configurable:!0,writable:!0,value:b})}}function r(a){function b(c){return a.next(c)}function d(c){return a.throw(c)}return new Promise(function(c,e){function f(g){g.done?c(g.value):Promise.resolve(g.value).then(b,d).then(f,e)}f(a.next())})}function t(a){return r(a())}
p("Object.values",function(a){return a?a:function(b){var d=[],c;for(c in b)Object.prototype.hasOwnProperty.call(b,c)&&d.push(b[c]);return d}});p("Array.prototype.includes",function(a){return a?a:function(b,d){var c=this;c instanceof String&&(c=String(c));var e=c.length;d=d||0;for(d<0&&(d=Math.max(d+e,0));d<e;d++){var f=c[d];if(f===b||Object.is(f,b))return!0}return!1}});/*

 MIT License

 Copyright (c) 2017-2023 W.Y.

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in
 all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 SOFTWARE.

*/
function u(a,b){const d=a.style;b.backgroundColor&&(d.backgroundColor=b.backgroundColor);b.width&&(d.width=`${b.width}px`);b.height&&(d.height=`${b.height}px`);const c=b.style;c!=null&&Object.keys(c).forEach(e=>{d[e]=c[e]})};var v=(()=>{let a=0;return()=>{a+=1;return`u${`0000${(Math.random()*1679616<<0).toString(36)}`.slice(-4)}${a}`}})();function w(a){const b=[];for(let d=0,c=a.length;d<c;d++)b.push(a[d]);return b}let x=null;function y(a={}){return x?x:a.l?x=a.l:x=w(window.getComputedStyle(document.documentElement))}function z(a,b){return(a=(a.ownerDocument.defaultView||window).getComputedStyle(a).getPropertyValue(b))?parseFloat(a.replace("px","")):0}
function A(a,b={}){var d;if(!(d=b.width)){d=z(a,"border-left-width");var c=z(a,"border-right-width");d=a.clientWidth+d+c}(b=b.height)||(b=z(a,"border-top-width"),c=z(a,"border-bottom-width"),b=a.clientHeight+b+c);return{width:d,height:b}}function B(a){return new Promise((b,d)=>{const c=new Image;c.onload=()=>{c.decode().then(()=>{requestAnimationFrame(()=>b(c))})};c.onerror=d;c.crossOrigin="anonymous";c.decoding="async";c.src=a})}
function C(a){return t(function*(){return Promise.resolve().then(()=>(new XMLSerializer).serializeToString(a)).then(encodeURIComponent).then(b=>`data:image/svg+xml;charset=utf-8,${b}`)})}
function D(a,b,d){return t(function*(){const c=document.createElementNS("http://www.w3.org/2000/svg","svg"),e=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");c.setAttribute("width",`${b}`);c.setAttribute("height",`${d}`);c.setAttribute("viewBox",`0 0 ${b} ${d}`);e.setAttribute("width","100%");e.setAttribute("height","100%");e.setAttribute("x","0");e.setAttribute("y","0");e.setAttribute("externalResourcesRequired","true");c.appendChild(e);e.appendChild(a);return C(c)})}
var E=(a,b)=>{if(a instanceof b)return!0;a=Object.getPrototypeOf(a);return a===null?!1:a.constructor.name===b.name||E(a,b)};function F(a,b){return y(b).map(d=>{const c=a.getPropertyValue(d),e=a.getPropertyPriority(d);return`${d}: ${c}${e?" !important":""};`}).join(" ")}
function G(a,b,d,c){a=window.getComputedStyle(a,d);var e=a.getPropertyValue("content");if(e!==""&&e!=="none"){var f=v();try{b.className=`${b.className} ${f}`}catch(k){return}e=document.createElement("style");var g=e.appendChild;d=`.${f}:${d}`;a.cssText?(c=a.getPropertyValue("content"),c=`${a.cssText} content: '${c.replace(/'|"/g,"")}';`):c=F(a,c);g.call(e,document.createTextNode(`${d}{${c}}`));b.appendChild(e)}};function H(a){return a.search(/^(data:)/)!==-1}function I(a,b,d){return t(function*(){const c=yield fetch(a,b);if(c.status===404)throw Error(`Resource "${c.url}" not found`);const e=yield c.blob();return new Promise((f,g)=>{const k=new FileReader;k.onerror=g;k.onloadend=()=>{try{f(d({o:c,result:k.result}))}catch(m){g(m)}};k.readAsDataURL(e)})})}const J={};function K(a,b,d){let c=a.replace(/\?.*/,"");d&&(c=a);/ttf|otf|eot|woff2?/i.test(c)&&(c=c.replace(/.*\//,""));return b?`[${b}]${c}`:c}
function L(a,b,d){return t(function*(){const c=K(a,b,d.C);if(J[c]!=null)return J[c];d.u&&(a+=(/\?/.test(a)?"&":"?")+(new Date).getTime());let e;try{const f=yield I(a,d.i,({o:g,result:k})=>{b||(b=g.headers.get("Content-Type")||"");return k.split(/,/)[1]});e=`data:${b};base64,${f}`}catch(f){e=d.B||""}return J[c]=e})};const M={P:"application/font-woff",R:"application/font-woff",N:"application/font-truetype",v:"application/vnd.ms-fontobject",H:"image/png",F:"image/jpeg",D:"image/jpeg",A:"image/gif",M:"image/tiff",L:"image/svg+xml",O:"image/webp"};function N(a){return(a=/\.([^./]*?)$/g.exec(a))?a[1]:""};function O(a){return t(function*(){const b=a.toDataURL();return b==="data:,"?a.cloneNode(!1):B(b)})}function aa(a,b){return t(function*(){if(a.currentSrc){var d=document.createElement("canvas");const c=d.getContext("2d");d.width=a.clientWidth;d.height=a.clientHeight;c==null||c.drawImage(a,0,0,d.width,d.height);d=d.toDataURL();return B(d)}d=a.poster;d=yield L(d,M[N(d).toLowerCase()]||"",b);return B(d)})}
function ba(a,b){return t(function*(){try{let d;if(a==null?0:(d=a.contentDocument)==null?0:d.body)return yield P(a.contentDocument.body,b,!0)}catch(d){}return a.cloneNode(!1)})}function ca(a,b){return t(function*(){return E(a,HTMLCanvasElement)?O(a):E(a,HTMLVideoElement)?aa(a,b):E(a,HTMLIFrameElement)?ba(a,b):a.cloneNode(a.tagName!=null&&a.tagName.toUpperCase()==="SVG")})}
function da(a,b,d){return t(function*(){if(b.tagName!=null&&b.tagName.toUpperCase()==="SVG")return b;let c=[];if(a.tagName!=null&&a.tagName.toUpperCase()==="SLOT"&&a.assignedNodes)c=w(a.assignedNodes());else{let e;if(E(a,HTMLIFrameElement)&&((e=a.contentDocument)==null?0:e.body))c=w(a.contentDocument.body.childNodes);else{let f;c=w(((f=a.shadowRoot)!=null?f:a).childNodes)}}if(c.length===0||E(a,HTMLVideoElement))return b;yield c.reduce((e,f)=>e.then(()=>P(f,d)).then(g=>{g&&b.appendChild(g)}),Promise.resolve());
return b})}function ea(a,b,d){const c=b.style;if(c){var e=window.getComputedStyle(a);e.cssText?(c.cssText=e.cssText,c.transformOrigin=e.transformOrigin):y(d).forEach(f=>{let g=e.getPropertyValue(f);f==="font-size"&&g.endsWith("px")&&(g=`${Math.floor(parseFloat(g.substring(0,g.length-2)))-.1}px`);E(a,HTMLIFrameElement)&&f==="display"&&g==="inline"&&(g="block");f==="d"&&b.getAttribute("d")&&(g=`path(${b.getAttribute("d")})`);c.setProperty(f,g,e.getPropertyPriority(f))})}}
function fa(a,b){E(a,HTMLSelectElement)&&(b=Array.from(b.children).find(d=>a.value===d.getAttribute("value")))&&b.setAttribute("selected","")}
function ha(a,b){return t(function*(){var d=a.querySelectorAll?a.querySelectorAll("use"):[];if(d.length===0)return a;var c={};for(var e=0;e<d.length;e++){var f=d[e].getAttribute("xlink:href");if(f){const g=document.querySelector(f);a.querySelector(f)||!g||c[f]||(c[f]=yield P(g,b,!0))}}d=Object.values(c);if(d.length){c=document.createElementNS("http://www.w3.org/1999/xhtml","svg");c.setAttribute("xmlns","http://www.w3.org/1999/xhtml");c.style.position="absolute";c.style.width="0";c.style.height="0";
c.style.overflow="hidden";c.style.display="none";e=document.createElementNS("http://www.w3.org/1999/xhtml","defs");c.appendChild(e);for(f=0;f<d.length;f++)e.appendChild(d[f]);a.appendChild(c)}return a})}
function P(a,b,d){return t(function*(){return d||!b.filter||b.filter(a)?Promise.resolve(a).then(c=>ca(c,b)).then(c=>da(a,c,b)).then(c=>{E(c,Element)&&(ea(a,c,b),G(a,c,":before",b),G(a,c,":after",b),E(a,HTMLTextAreaElement)&&(c.textContent=a.value),E(a,HTMLInputElement)&&c.setAttribute("value",a.value),fa(a,c));return c}).then(c=>ha(c,b)):null})};const Q=/url\((['"]?)([^'"]+?)\1\)/g,ia=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,ja=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function ka(a){const b=[];a.replace(Q,(d,c,e)=>{b.push(e);return d});return b.filter(d=>!H(d))}
function la(a,b,d,c){return t(function*(){try{const e=d?(new URL(b,d||void 0)).toString():b;let f;f=yield L(e,M[N(b).toLowerCase()]||"",c);return a.replace(new RegExp(`(url\\(['"]?)(${b.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")})(['"]?\\))`,"g"),`$1${f}$3`)}catch(e){}return a})}function ma(a,{I:b}){return b?a.replace(ja,d=>{for(;;){const [c,,e]=ia.exec(d)||[],f=c,g=e;if(!g)return"";if(g===b)return`src: ${f};`}}):a}
function R(a,b,d){return t(function*(){if(a.search(Q)===-1)return a;const c=ma(a,d);return ka(c).reduce((e,f)=>e.then(g=>la(g,f,b,d)),Promise.resolve(c))})};function S(a,b,d){return t(function*(){var c;const e=(c=b.style)==null?void 0:c.getPropertyValue(a);return e?(c=yield R(e,null,d),b.style.setProperty(a,c,b.style.getPropertyPriority(a)),!0):!1})}function na(a,b){return t(function*(){(yield S("background",a,b))||(yield S("background-image",a,b));(yield S("mask",a,b))||(yield S("-webkit-mask",a,b))||(yield S("mask-image",a,b))||(yield S("-webkit-mask-image",a,b))})}
function oa(a,b){return t(function*(){const d=E(a,HTMLImageElement);if(d&&!H(a.src)||E(a,SVGImageElement)&&!H(a.href.baseVal)){var c=d?a.src:a.href.baseVal,e=yield L(c,M[N(c).toLowerCase()]||"",b);yield new Promise((f,g)=>{a.onload=f;a.onerror=b.m?(...k)=>{try{f(b.m(...k))}catch(m){g(m)}}:g;a.decode&&(a.decode=f);a.loading==="lazy"&&(a.loading="eager");d?(a.srcset="",a.src=e):a.href.baseVal=e})}})}
function pa(a,b){return t(function*(){const d=w(a.childNodes).map(c=>T(c,b));yield Promise.all(d).then(()=>a)})}function T(a,b){return t(function*(){E(a,Element)&&(yield na(a,b),yield oa(a,b),yield pa(a,b))})};const U={};function V(a){return t(function*(){var b=U[a];if(b!=null)return b;b=yield(yield fetch(a)).text();b={url:a,cssText:b};return U[a]=b})}function W(a,b){return t(function*(){let d=a.cssText;const c=/url\(["']?([^"')]+)["']?\)/g,e=(d.match(/url\([^)]+\)/g)||[]).map(f=>t(function*(){let g=f.replace(c,"$1");g.startsWith("https://")||(g=(new URL(g,a.url)).href);return I(g,b.i,({result:k})=>{d=d.replace(f,`url(${k})`);return[f,k]})}));return Promise.all(e).then(()=>d)})}
function X(a){if(a==null)return[];const b=[];a=a.replace(/(\/\*[\s\S]*?\*\/)/gi,"");for(var d=RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");;){var c=d.exec(a);if(c===null)break;b.push(c[0])}a=a.replace(d,"");d=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi;for(c=RegExp("((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})","gi");;){let e=d.exec(a);if(e===null)if(e=c.exec(a),e===null)break;else d.lastIndex=c.lastIndex;else c.lastIndex=
d.lastIndex;b.push(e[0])}return b}
function qa(a,b){return t(function*(){const d=[],c=[];a.forEach(e=>{if("cssRules"in e)try{w(e.cssRules||[]).forEach((f,g)=>{if(f.type===CSSRule.IMPORT_RULE){let k=g+1;f=V(f.href).then(m=>W(m,b)).then(m=>X(m).forEach(q=>{try{e.insertRule(q,q.startsWith("@import")?k+=1:e.cssRules.length)}catch(Da){}})).catch(()=>{});c.push(f)}})}catch(f){const g=a.find(k=>k.href==null)||document.styleSheets[0];e.href!=null&&c.push(V(e.href).then(k=>W(k,b)).then(k=>X(k).forEach(m=>{g.insertRule(m,g.cssRules.length)})).catch(()=>
{}))}});return Promise.all(c).then(()=>{a.forEach(e=>{if("cssRules"in e)try{w(e.cssRules||[]).forEach(f=>{d.push(f)})}catch(f){}});return d})})}function ra(a){return a.filter(b=>b.type===CSSRule.FONT_FACE_RULE).filter(b=>b.style.getPropertyValue("src").search(Q)!==-1)}function sa(a,b){return t(function*(){if(a.ownerDocument==null)throw Error("Provided element is not within a Document");var d=w(a.ownerDocument.styleSheets);d=yield qa(d,b);return ra(d)})}
function ta(a){function b(c){(c.style.fontFamily||getComputedStyle(c).fontFamily).split(",").forEach(e=>{d.add(e.trim().replace(/["']/g,""))});Array.from(c.children).forEach(e=>{e instanceof HTMLElement&&b(e)})}const d=new Set;b(a);return d}function ua(a,b){return t(function*(){const d=yield sa(a,b),c=ta(a);return(yield Promise.all(d.filter(e=>c.has(e.style.fontFamily.trim().replace(/["']/g,""))).map(e=>R(e.cssText,e.parentStyleSheet?e.parentStyleSheet.href:null,b)))).join("\n")})}
function va(a,b){return t(function*(){const d=b.j!=null?b.j:b.K?null:yield ua(a,b);if(d){const c=document.createElement("style");c.appendChild(document.createTextNode(d));a.firstChild?a.insertBefore(c,a.firstChild):a.appendChild(c)}})};function wa(a,b={}){return t(function*(){const {width:d,height:c}=A(a,b),e=yield P(a,b,!0);yield va(e,b);yield T(e,b);u(e,b);return yield D(e,d,c)})}
function xa(a,b={}){return t(function*(){const {width:d,height:c}=A(a,b);var e=yield wa(a,b);e=yield B(e);const f=document.createElement("canvas"),g=f.getContext("2d"),k=b.G||window.devicePixelRatio||1,m=b.h||d,q=b.g||c;f.width=m*k;f.height=q*k;!b.J&&(f.width>16384||f.height>16384)&&(f.width>16384&&f.height>16384?f.width>f.height?(f.height*=16384/f.width,f.width=16384):(f.width*=16384/f.height,f.height=16384):f.width>16384?(f.height*=16384/f.width,f.width=16384):(f.width*=16384/f.height,f.height=
16384));f.style.width=`${m}`;f.style.height=`${q}`;b.backgroundColor&&(g.fillStyle=b.backgroundColor,g.fillRect(0,0,f.width,f.height));g.drawImage(e,0,0,f.width,f.height);return f})}function ya(a,b={}){return t(function*(){return(yield xa(a,b)).toDataURL()})};const za=["gemini.google.com","corp.google.com","proxy.googlers.com"];function Y(){return document.body.querySelectorAll('[class*="animate"]').length>0}function Z(a){return t(function*(){try{return yield ya(a,{h:a.offsetWidth,g:a.offsetHeight})}catch(d){var b=a.offsetHeight;const c=document.createElement("canvas");c.width=a.offsetWidth;c.height=b;return c.toDataURL("image/png")}})}
function Aa(){return t(function*(){const a=document.body.offsetWidth,b=document.body.offsetHeight,d=document.body.cloneNode(!0);d.querySelectorAll('[class*="animate"]').forEach(c=>{c.classList.remove(...Array.from(c.classList).filter(e=>e.startsWith("animate")))});d.style.width=`${a}px`;d.style.height=`${b}px`;return d})}
function Ba(a){return t(function*(){let b=document.body;if(Y()){var d=yield Aa();b=d;document.body.appendChild(d)}d=yield Z(b);Y()&&document.body.removeChild(b);window.parent.postMessage({type:"SEND_SCREENSHOT",image:d,topOffset:document.documentElement.scrollTop},a.origin)})}function Ca(a){return t(function*(){const b={type:"SEND_SCREENSHOT_FOR_DATA_VISUALIZATION",image:yield Z(document.body),topOffset:0};window.parent.postMessage(b,a.origin)})}
window.addEventListener("message",a=>t(function*(){if(za.some(d=>a.origin.includes(d))){var b=a.data;b&&(b.type==="MAKE_SCREENSHOT"&&(yield Ba(a)),b.type==="MAKE_SCREENSHOT_FOR_DATA_VISUALIZATION"&&(yield Ca(a)))}}));
</script><script>(function() {
  // Ensure this script is executed only once
  if (window.firebaseAuthBridgeScriptLoaded) {
    return;
  }
  window.firebaseAuthBridgeScriptLoaded = true;

  let nextTokenPromiseId = 0;

  // Stores { resolve, reject } for ongoing token requests
  const pendingTokenPromises = {};

  // Listen for messages from the Host Application
  window.addEventListener('message', function(event) {

    const messageData = event.data;

  if (messageData && messageData.type === 'RESOLVE_NEW_FIREBASE_TOKEN') {
      const { success, token, error, promiseId } = messageData ?? {};
      if (pendingTokenPromises[promiseId]) {
        if (success) {
          pendingTokenPromises[promiseId].resolve(token);
        } else {
          pendingTokenPromises[promiseId].reject(new Error(error || 'Token refresh failed from host.'));
        }
        delete pendingTokenPromises[promiseId];
      }
    }
  });

  // Expose a function for the Generated App to request a new Firebase token
  window.requestNewFirebaseToken = function() {
    const currentPromiseId = nextTokenPromiseId++;
    const promise = new Promise((resolve, reject) => {
      pendingTokenPromises[currentPromiseId] = { resolve, reject };
    });
    if (window.parent && window.parent !== window) {
      window.parent.postMessage({
        type: 'REQUEST_NEW_FIREBASE_TOKEN',
        promiseId: currentPromiseId
      }, '*');
    } else {
      pendingTokenPromises[currentPromiseId].reject(new Error('No parent window to request token from.'));
      delete pendingTokenPromises[currentPromiseId];
    }
    return promise;
  };
})();</script><script>
let realOriginalGetUserMedia = null;
if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
  realOriginalGetUserMedia = navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);
}

(function() {
  if (navigator.mediaDevices && navigator.mediaDevices.__proto__) {
    try {
      Object.defineProperty(navigator.mediaDevices.__proto__, 'getUserMedia', {
        get: function() {
          return undefined; // Or throw an error
        },
        configurable: false
      });
    } catch (error) {
      console.error("Error defining prototype getter:", error);
    }
  }
})();

(function() {
  const pendingMediaResolvers = {};
  let nextMediaPromiseId = 0;

  function requestMediaPermissions(constraints) {
    const mediaPromiseId = nextMediaPromiseId++;
    const promise = new Promise((resolve, reject) => {
      pendingMediaResolvers[mediaPromiseId] = (granted) => {
        delete pendingMediaResolvers[mediaPromiseId];
        resolve(granted);
      };
    });

    window.parent.postMessage({
      type: 'requestMediaPermission',
      constraints: constraints,
      promiseId: mediaPromiseId,
    }, '*');

    return promise;
  }

  let originalGetUserMedia = realOriginalGetUserMedia;

  function interceptGetUserMedia() {
    if (navigator.mediaDevices) {
      Object.defineProperty(navigator.mediaDevices, 'getUserMedia', {
        value: function(constraints) {
          return requestMediaPermissions(constraints).then((granted) => {
            if (granted) {
              if (originalGetUserMedia) {
                return originalGetUserMedia(constraints);
              } else {
                throw new Error("Original getUserMedia not available.");
              }
            } else {
              throw new DOMException('Permission denied', 'NotAllowedError');
            }
          });
        },
        writable: false,
        configurable: false
      });
    }
  }

  interceptGetUserMedia();

  const observer = new MutationObserver(function(mutationsList, observer) {
    for (const mutation of mutationsList) {
      if (mutation.type === 'reconfigured' && mutation.name === 'getUserMedia' && mutation.object === navigator.mediaDevices) {
        interceptGetUserMedia();
      } else if (mutation.type === 'attributes' && mutation.attributeName === 'getUserMedia' && mutation.target === navigator.mediaDevices) {
        interceptGetUserMedia();
      } else if (mutation.type === 'childList' && mutation.addedNodes) {
        mutation.addedNodes.forEach(node => {
          if (node === navigator.mediaDevices) {
            interceptGetUserMedia();
          }
        });
      }
    }
  });

  function interceptSpeechRecognition() {
    if (!window.SpeechRecognition && !window.webkitSpeechRecognition) {
      return;
    }

    const OriginalSpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;

    const SpeechRecognitionWrapper = function(...args) {
      const recognizer = new OriginalSpeechRecognition(...args);
      const originalStart = recognizer.start.bind(recognizer);

      recognizer.start = function() {
        requestMediaPermissions({ audio: true }).then(granted => {
          if (granted) {
            originalStart();
          } else {
            const errorEvent = new SpeechRecognitionErrorEvent('error');
            errorEvent.error = 'not-allowed'; // This is the standard error for permission denial.
            recognizer.dispatchEvent(errorEvent);
          }
        });
      };

      return recognizer;
    };

    SpeechRecognitionWrapper.prototype = OriginalSpeechRecognition.prototype;
    SpeechRecognitionWrapper.prototype.constructor = SpeechRecognitionWrapper;

    if (window.SpeechRecognition) {
      window.SpeechRecognition = SpeechRecognitionWrapper;
    }
    if (window.webkitSpeechRecognition) {
      window.webkitSpeechRecognition = SpeechRecognitionWrapper;
    }
  }

  interceptSpeechRecognition();

  window.addEventListener('message', function(event) {
    if (event.data) {
      if (event.data.type === 'resolveMediaPermission') {
        const { promiseId, granted } = event.data;
        if (pendingMediaResolvers[promiseId]) {
          pendingMediaResolvers[promiseId](granted);
        }
      }
    }
  });

})();</script><script>((function(modelInformation) {
  const originalFetch = window.fetch;
  // TODO: b/421908508 - Move these out of the script and match all generative AI model calls.
  let googleLlmBaseApiUrls = [
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.textModelName + ':streamGenerateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.textModelName + ':generateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageModelName + ':predict',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageModelName + ':predictLongRunning',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageEditModelName + ':generateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.videoModelName + ':predict',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.videoModelName + ':predictLongRunning',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.ttsModelName + ':generateContent',
  ];
  modelInformation.deprecatedTextModelNames.forEach((modelName) => {
    googleLlmBaseApiUrls.push(
      'https://generativelanguage.googleapis.com/v1beta/models/' + modelName + ':streamGenerateContent',
      'https://generativelanguage.googleapis.com/v1beta/models/' + modelName + ':generateContent',
    );
  });

  const pendingFetchResolvers = {};
  let nextPromiseId = 0;

  function handleStringInput(input, optionsArgument) {
    const actualUrl = input;
    const fetchCallArgs = [actualUrl, optionsArgument];
    const effectiveOptions = optionsArgument || {};
    const bodyForApiKeyCheck = effectiveOptions.body;
    const bodyForPostMessage = effectiveOptions.body;
    return { actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage };
  }

  function handleRequestInput(input, optionsArgument) {
    const actualUrl = input.url;
    const fetchCallArgs = [input, optionsArgument];
    const effectiveOptions = { method: input.method, headers: new Headers(input.headers) };
    let bodyForApiKeyCheck;
    let bodyForPostMessage;

    if (optionsArgument) {
      if (optionsArgument.method) effectiveOptions.method = optionsArgument.method;
      if (optionsArgument.headers) effectiveOptions.headers = new Headers(optionsArgument.headers);
      if ('body' in optionsArgument) {
        bodyForApiKeyCheck = optionsArgument.body;
        bodyForPostMessage = optionsArgument.body;
      } else {
        bodyForApiKeyCheck = undefined;
        bodyForPostMessage = input.body;
      }
    } else {
      bodyForApiKeyCheck = undefined;
      bodyForPostMessage = input.body;
    }
    return { actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage };
  }

  window.fetch = function(input, optionsArgument) {
    let actualUrl;
    let fetchCallArgs;
    let effectiveOptions = {};
    let bodyForApiKeyCheck;
    let bodyForPostMessage;

    if (typeof input === 'string') {
      ({actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage} = handleStringInput(input, optionsArgument));
    } else if (input instanceof Request) {
      ({actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage} = handleRequestInput(input, optionsArgument));
    } else {
      return originalFetch.apply(window, [input, optionsArgument]);
    }

    effectiveOptions.method = effectiveOptions.method || 'GET';
    if (!effectiveOptions.headers) {
      effectiveOptions.headers = new Headers();
    }


    if (typeof actualUrl === 'string' && googleLlmBaseApiUrls.some((url) => actualUrl.startsWith(url))) {
      let apiKeyIsNull = true;

      const regex = new RegExp("models/([^:]+)");
      const modelNameMatch = actualUrl.match(regex);
      const modelName = modelNameMatch ? modelNameMatch[1] : 'unspecified';


      try {
        const urlObject = new URL(actualUrl);  // Use URL object for robust parsing
        const apiKeyParam = urlObject.searchParams.get('key');
        if (apiKeyParam) {
          apiKeyIsNull = false;
        }
      } catch (e) {
        // Continue checks even if URL parsing fails
      }

      if (apiKeyIsNull && effectiveOptions.headers) {
        const h = new Headers(effectiveOptions.headers);
        const apiKeyHeaderValue = h.get('X-API-Key') || h.get('x-api-key');
        if (apiKeyHeaderValue) {
          apiKeyIsNull = false;
          return originalFetch.apply(window, fetchCallArgs);
        }
      }

      if (apiKeyIsNull && effectiveOptions.method && ['POST', 'PUT', 'PATCH'].includes(effectiveOptions.method.toUpperCase()) && typeof bodyForApiKeyCheck === 'string') {
        try {
          const bodyData = JSON.parse(bodyForApiKeyCheck);
          if (bodyData && bodyData.apiKey) {
            apiKeyIsNull = false;
            return originalFetch.apply(window, fetchCallArgs);
          }
        } catch (e) {
          // Ignore JSON parsing errors
        }
      }

      if(apiKeyIsNull) {
        const promiseId = nextPromiseId++;
        const promise = new Promise((resolve) => {
          pendingFetchResolvers[promiseId] = (resolvedResponse) => {
            delete pendingFetchResolvers[promiseId];
            resolve(resolvedResponse);
          };
        });

        let serializedBodyForPostMessage;
        if (typeof bodyForPostMessage === 'string' || bodyForPostMessage == null) {
            serializedBodyForPostMessage = bodyForPostMessage;
        } else if (bodyForPostMessage instanceof ReadableStream) {
            serializedBodyForPostMessage = null;
        } else {
            try {
                serializedBodyForPostMessage = JSON.stringify(bodyForPostMessage);
            } catch (e) {
                serializedBodyForPostMessage = null;
            }
        }

        const messageOptions = {
            method: effectiveOptions.method,
            headers: Object.fromEntries(new Headers(effectiveOptions.headers).entries()),
            body: serializedBodyForPostMessage
        };

        window.parent.postMessage({
          type: 'requestFetch',
          url: actualUrl,
          modelName: modelName,
          options: messageOptions,
          promiseId: promiseId,
        }, '*');

        return promise;
      }
      return originalFetch.apply(window, fetchCallArgs);
    }
    return originalFetch.apply(window, fetchCallArgs);
  };

  window.addEventListener('message', function(event) {
    if (event.data && event.data.type === 'resolveFetch') {
      const { promiseId, response } = event.data;
      if (pendingFetchResolvers[promiseId]) {
        try {
          const reconstructedResponse = new Response(response.body, {
            status: response.status,
            statusText: response.statusText,
            headers: new Headers(response.headers),
          });
          pendingFetchResolvers[promiseId](reconstructedResponse);
        } catch (error) {
          pendingFetchResolvers[promiseId](new Response(null, { status: 500, statusText: "Interceptor Response Reconstruction Error" }));
        }
      }
    }
  });

}))({"textModelName":"gemini-2.5-flash-preview-05-20","imageModelName":"imagen-3.0-generate-002","imageEditModelName":"gemini-2.5-flash-image-preview","videoModelName":"veo-2.0-generate-001","ttsModelName":"gemini-2.5-flash-preview-tts","deprecatedTextModelNames":["gemini-2.0-flash","gemini-2.5-flash-preview-04-17"]})</script><script>(function() {
  const originalConsoleLog = console.log;
  const originalConsoleError = console.error;

    /**
   * Normalizes an error event or a promise rejection reason into a structured error object.
   * @param {*} errorEventOrReason The error object or reason.
   * @return {object} Structured error data { message, name, stack }.
   */
  function getErrorObject(errorEventOrReason) {
    if (errorEventOrReason instanceof Error) {
      return {
        message: errorEventOrReason.message,
        name: errorEventOrReason.name,
        stack: errorEventOrReason.stack,
      };
    }
    // Fallback for non-Error objects.
    try {
      return {
        message: JSON.stringify(errorEventOrReason),
        name: 'UnknownErrorType',
        stack: null,
      };
    } catch (e) {
      return {
        message: String(errorEventOrReason),
        name: 'UnknownErrorTypeNonStringifiable',
        stack: null,
      };
    }
  }

  /**
   * Converts an array of arguments (from log/error) into a single string.
   * Handles Error objects specially to include their message and stack.
   * @param {Array<*>} args - Arguments passed to console methods.
   * @return {string} A string representation of the arguments.
   */
  function stringifyArgs(args) {
    return args
      .map((arg) => {
        if (arg instanceof Error) {
          const {message, stack} = arg;
          return `Error: ${message}${stack ? ('\nStack: ' + stack) : ''}`;
        }
        if (typeof arg === 'object' && arg !== null) {
          try {
            return JSON.stringify(arg);
          } catch (error) {
            return '[Circular Object]';
          }
        } else {
          return String(arg);
        }
      })
      .join(' ');
  }

  console.log = function(...args) {
    const logString = stringifyArgs(args);
    window.parent.postMessage({ type: 'log', message: logString }, '*');
    originalConsoleLog.apply(console, args);
  };

  console.error = function(...args) {
    let errorData;
    if (args.length > 0 && args[0] instanceof Error) {
      const err = args[0];
      // If the first arg is an Error, capture its details.
      errorData = {
        type: 'error',
        source: 'CONSOLE_ERROR',
        ...getErrorObject(err),
        rawArgsString: stringifyArgs(args.slice(1)),
        timestamp: new Date().toISOString(),
      };
    } else {
      // If not an Error object, treat all args as a general error message.
      errorData = {
        type: 'error',
        source: 'CONSOLE_ERROR',
        message: stringifyArgs(args),
        name: 'ConsoleLoggedError',
        stack: null,
        timestamp: new Date().toISOString(),
      };
    }
    window.parent.postMessage(errorData, '*');
    originalConsoleError.apply(console, args);
  };

  // Listen for global unhandled synchronous errors.
  window.addEventListener('error', function(event) {
    const errorDetails = event.error ? getErrorObject(event.error) : {
      message: event.message,
      name: 'GlobalError',
      stack: null,
      filename: event.filename,
      lineno: event.lineno,
      colno: event.colno,
    };

    window.parent.postMessage({
      type: 'error',
      source: 'global',
      ...errorDetails,
      message: errorDetails.message || event.message,
      timestamp: new Date().toISOString(),
    }, '*');
  });

  // Listen for unhandled promise rejections (asynchronous errors).
  window.addEventListener('unhandledrejection', function(event) {
    const errorDetails = getErrorObject(event.reason);

    window.parent.postMessage({
      type: 'error',
      source: 'unhandledrejection',
      ...errorDetails,
      message: errorDetails.message || 'Unhandled Promise Rejection',
      timestamp: new Date().toISOString(),
    }, '*');
  });

})();</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>和平的代價：黃金獨舞，石油為何被冷落？</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0" crossorigin="anonymous"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&amp;display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #FDFBF7;
            color: #3C3633;
        }
        .card-shadow {
             box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        }
        h2.story-title {
            text-align: center;
            font-size: 1.875rem;
            line-height: 2.25rem;
            font-weight: 700;
            color: #655A4E;
            margin-bottom: 1.5rem;
            border-bottom: 2px solid #C8B6A6;
            padding-bottom: 1rem;
        }
        h3 {
            border-bottom: 2px solid #EAE0D5;
            padding-bottom: 0.5rem;
            margin-top: 2rem;
            margin-bottom: 1rem;
            font-size: 1.25rem;
            font-weight: 700;
            color: #8D7B68;
        }
        .chart-container {
            position: relative;
            width: 100%;
            margin: 1.5rem auto;
        }
        .gauge-chart-container {
            position: relative;
            width: 100%;
            max-width: 300px; /* Increased size */
            margin: 0 auto;
            height: 150px; /* Increased size */
            margin-bottom: 1rem;
        }
        .pulse-item {
            background-color: #F9F6F2;
            padding: 1rem;
            border-radius: 0.5rem;
            border-left: 4px solid #C8B6A6;
        }
        .emphasis {
            background-color: #FFF8E1;
            padding: 1rem;
            border-left: 4px solid #FFC107;
            border-radius: 0.25rem;
            margin: 1.5rem 0;
        }
        .download-btn {
            position: fixed;
            bottom: 1.5rem;
            right: 1.5rem;
            z-index: 50;
        }
    </style>
<style>*, ::before, ::after{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }/* ! tailwindcss v3.4.17 | MIT License | https://tailwindcss.com */*,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}::after,::before{--tw-content:''}:host,html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}.container{width:100%}@media (min-width: 640px){.container{max-width:640px}}@media (min-width: 768px){.container{max-width:768px}}@media (min-width: 1024px){.container{max-width:1024px}}@media (min-width: 1280px){.container{max-width:1280px}}@media (min-width: 1536px){.container{max-width:1536px}}.mx-auto{margin-left:auto;margin-right:auto}.mb-10{margin-bottom:2.5rem}.mb-12{margin-bottom:3rem}.mb-4{margin-bottom:1rem}.mb-6{margin-bottom:1.5rem}.mb-8{margin-bottom:2rem}.mt-1{margin-top:0.25rem}.mt-12{margin-top:3rem}.mt-2{margin-top:0.5rem}.mt-8{margin-top:2rem}.grid{display:grid}.h-6{height:1.5rem}.h-80{height:20rem}.h-96{height:24rem}.w-6{width:1.5rem}.w-full{width:100%}.max-w-7xl{max-width:80rem}.grid-cols-1{grid-template-columns:repeat(1, minmax(0, 1fr))}.gap-8{gap:2rem}.space-y-4 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(1rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1rem * var(--tw-space-y-reverse))}.overflow-x-auto{overflow-x:auto}.rounded-full{border-radius:9999px}.rounded-lg{border-radius:0.5rem}.border-b{border-bottom-width:1px}.bg-\[\#655A4E\]{--tw-bg-opacity:1;background-color:rgb(101 90 78 / var(--tw-bg-opacity, 1))}.bg-gray-100{--tw-bg-opacity:1;background-color:rgb(243 244 246 / var(--tw-bg-opacity, 1))}.bg-gray-50{--tw-bg-opacity:1;background-color:rgb(249 250 251 / var(--tw-bg-opacity, 1))}.bg-white{--tw-bg-opacity:1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.p-3{padding:0.75rem}.p-4{padding:1rem}.px-6{padding-left:1.5rem;padding-right:1.5rem}.py-3{padding-top:0.75rem;padding-bottom:0.75rem}.py-4{padding-top:1rem;padding-bottom:1rem}.pl-10{padding-left:2.5rem}.text-left{text-align:left}.text-center{text-align:center}.text-3xl{font-size:1.875rem;line-height:2.25rem}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-sm{font-size:0.875rem;line-height:1.25rem}.text-xs{font-size:0.75rem;line-height:1rem}.font-bold{font-weight:700}.font-medium{font-weight:500}.font-semibold{font-weight:600}.uppercase{text-transform:uppercase}.italic{font-style:italic}.leading-relaxed{line-height:1.625}.text-\[\#655A4E\]{--tw-text-opacity:1;color:rgb(101 90 78 / var(--tw-text-opacity, 1))}.text-\[\#8D7B68\]{--tw-text-opacity:1;color:rgb(141 123 104 / var(--tw-text-opacity, 1))}.text-gray-500{--tw-text-opacity:1;color:rgb(107 114 128 / var(--tw-text-opacity, 1))}.text-gray-600{--tw-text-opacity:1;color:rgb(75 85 99 / var(--tw-text-opacity, 1))}.text-gray-700{--tw-text-opacity:1;color:rgb(55 65 81 / var(--tw-text-opacity, 1))}.text-gray-800{--tw-text-opacity:1;color:rgb(31 41 55 / var(--tw-text-opacity, 1))}.text-green-600{--tw-text-opacity:1;color:rgb(22 163 74 / var(--tw-text-opacity, 1))}.text-green-700{--tw-text-opacity:1;color:rgb(21 128 61 / var(--tw-text-opacity, 1))}.text-red-600{--tw-text-opacity:1;color:rgb(220 38 38 / var(--tw-text-opacity, 1))}.text-white{--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.shadow-lg{--tw-shadow:0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.transition-colors{transition-property:color, background-color, border-color, fill, stroke, -webkit-text-decoration-color;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, -webkit-text-decoration-color;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.hover\:bg-\[\#8D7B68\]:hover{--tw-bg-opacity:1;background-color:rgb(141 123 104 / var(--tw-bg-opacity, 1))}.focus\:outline-none:focus{outline:2px solid transparent;outline-offset:2px}.focus\:ring-2:focus{--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 #0000)}.focus\:ring-\[\#655A4E\]:focus{--tw-ring-opacity:1;--tw-ring-color:rgb(101 90 78 / var(--tw-ring-opacity, 1))}.focus\:ring-offset-2:focus{--tw-ring-offset-width:2px}@media (min-width: 768px){.md\:grid-cols-2{grid-template-columns:repeat(2, minmax(0, 1fr))}.md\:grid-cols-3{grid-template-columns:repeat(3, minmax(0, 1fr))}.md\:p-8{padding:2rem}.md\:text-4xl{font-size:2.25rem;line-height:2.5rem}}</style></head>
<body class="text-gray-800">

    <div class="container mx-auto p-4 md:p-8 max-w-7xl">
        <header class="text-center mb-10">
            <h1 class="text-3xl md:text-4xl font-bold text-[#655A4E]">和平的代價：黃金獨舞，石油為何被冷落？</h1>
            <p class="text-lg text-[#8D7B68]">一份融合BofA報告與市場智慧的深度解讀 (截至2025年10月12日)</p>
        </header>

        <main>
            <section class="mb-12">
                <h2 class="story-title">序章：市場的脈動，三分鐘速覽</h2>
                <p class="text-lg text-gray-700 leading-relaxed mb-6">
                    在我們深入探討這場黃金與石油的異常脫鉤之前，讓我們先聽聽市場的心跳。美國銀行最新的報告，用幾句簡潔而充滿畫面感的引言，為我們揭示了當下這個充滿矛盾與機遇的時刻。
                </p>
                <div class="space-y-4">
                    <div class="pulse-item">
                        <p class="font-bold">時代精神 (Zeitgeist):</p>
                        <p class="italic text-gray-700">「我姐夫在午餐時問我，他現在應該投資實體黃金或白銀嗎？還是已經太晚了？因為他的紅酒投資最近虧慘了。」</p>
                        <p class="text-gray-600 text-sm mt-1">解讀：這段對話生動地反映出，當傳統的另類投資（如紅酒）失效時，市場的避險情緒正集體湧向貴金屬，連圈外人都開始焦慮了。</p>
                    </div>
                    <div class="pulse-item">
                        <p class="font-bold">價格的玄機 (The Price is Right):</p>
                        <p class="text-gray-700">市場正在分裂。聯準會降息的預期，對那些需要燒錢但還沒盈利的科技股（如XBI, ARKK）是利多，但對利率敏感的週期性行業（如房地產 IYR, 建築 ITB）卻是利空。而將華爾街的多頭與實體經濟的空頭黏合在一起的「膠水」——信貸市場，已經出現了裂縫。這就是為什麼，在這個時間點，做多美元和零息債券，是對沖次級消費風暴蔓延風險的聰明玩法。</p>
                    </div>
                    <div class="pulse-item">
                        <p class="font-bold">資金流的真相 (Tale of the Tape):</p>
                        <p class="text-gray-700">黃金衝擊4000美元、白銀衝擊50美元的勢頭暫歇，因為短期實在「太熱了」。但從結構上看，真正長期持有黃金的資金依然非常稀少（私人客戶資產中僅0.5%）。在對新任聯準會主席的寬鬆預期、全球性的「繁榮/泡沫」政策（看看阿根廷的救市）以及資產重估（類似1934年和1973年）的背景下，長期來看，這是一場有利於「貨幣貶值交易」的牌局。</p>
                    </div>
                    <div class="pulse-item">
                        <p class="font-bold">宏觀大局 (The Biggest Picture):</p>
                        <p class="text-gray-700">2022年6月，15桶石油能買1盎司黃金；現在，需要61桶。黃金大漲而石油大跌，這在歷史上是極其罕見的異象。BofA大膽預測，第四季度市場最大的驚喜，可能就是油價跌至50美元/桶。這背後指向一個宏大的地緣政治交易：OPEC增加供應，以換取中東地区發展所需的資金（沙烏地和以色列的財政赤字都已高達GDP的5%）。這是一場用石油換和平的賭局。</p>
                    </div>
                </div>
            </section>

            <section class="mb-12">
                <h2 class="story-title">第一章：黃金的獨舞，避險情緒的真實溫度</h2>
                <p class="text-lg text-gray-700 leading-relaxed mb-6">
                    故事的主舞台，首先聚光燈打在黃金身上。今年以來，黃金以超過53%的驚人回報一騎絕塵，將其他所有資產遠遠甩在身後。這不是一次普通的上漲，而是一場盛大的獨舞。就在幾天前，市場還在上演全面狂歡的戲碼，但突如其來的地緣政治與政策風險，讓音樂戛然而止。10月10日，美股經歷了一場史詩級的暴跌，而黃金，則像定海神針一樣，逆勢上漲，再次證明了它無可替代的避險價值。
                </p>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
                    <div class="bg-white p-4 rounded-lg card-shadow">
                        <div class="chart-container h-96"><canvas id="ytdReturnsChart" height="768" style="display: block; box-sizing: border-box; height: 384px; width: 503px;" width="1007"></canvas></div>
                    </div>
                    <div class="bg-white p-4 rounded-lg card-shadow text-center">
                         <div class="gauge-chart-container"><canvas id="bullBearIndicator" height="300" style="display: block; box-sizing: border-box; height: 150px; width: 300px;" width="600"></canvas></div>
                         <p class="text-sm text-gray-600">本週指標維持在<strong>6.5</strong>，與上週持平，處於12個月高位。雖然尚未觸及8.0的「極度貪婪」賣出信號，但市場情緒顯然處於高位的貪婪區間，任何風吹草動都可能引發恐慌。</p>
                    </div>
                </div>

                <p class="text-lg text-gray-700 leading-relaxed mb-6">
                    資金的流動最能說明問題。本週，全球有高達729億美元的資金湧入現金（貨幣市場基金），尋求短期庇護。同時，我們也看到了創紀錄的76億美元流入<strong>原物料</strong>板塊，以及21億美元流入黃金。這背後的邏輯非常清晰：在不確定性面前，市場正在拋售風險資產，轉而擁抱最傳統的硬資產和現金。
                </p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div class="bg-white p-4 rounded-lg card-shadow">
                        <div class="chart-container h-80"><canvas id="weeklyFlowsChart" height="640" style="display: block; box-sizing: border-box; height: 320px; width: 503px;" width="1007"></canvas></div>
                    </div>
                    <div class="bg-white p-4 rounded-lg card-shadow">
                        <div class="chart-container h-80"><canvas id="materialsFlowChart" height="640" style="display: block; box-sizing: border-box; height: 320px; width: 503px;" width="1007"></canvas></div>
                    </div>
                </div>

                <h3>深入挖掘：錢到底流向了哪裡？</h3>
                <p class="text-gray-700 leading-relaxed mb-6">
                    更細節的數據揭示了一幅分裂的圖景：今年以來，全球股票市場雖然淨流入高達5200億美元，但這完全是由ETF的8950億美元巨額流入所支撐的，傳統的主動型共同基金（LO）則失血超過3760億美元。這說明市場的主導力量正在改變，被動投資的趨勢銳不可當。而在區域上，美股依然是全球的吸金核心，今年以來吸納了2380億美元；相比之下，日本股市則出現了104億美元的淨流出，顯示在全球避險情緒下，資金仍在向最穩定的美元資產集中。
                </p>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div class="overflow-x-auto bg-white rounded-lg card-shadow">
                        <table class="w-full text-sm text-left text-gray-500">
                            <caption class="p-4 text-lg font-semibold text-left text-gray-800 bg-gray-50">年度至今各資產類別資金流</caption>
                            <thead class="text-xs text-gray-700 uppercase bg-gray-100">
                                <tr><th class="px-6 py-3">資產類別</th><th class="px-6 py-3">今年至今 (億美元)</th><th class="px-6 py-3">佔AUM比例</th></tr>
                            </thead>
                            <tbody>
                                <tr class="border-b"><td class="px-6 py-4 font-medium">股票</td><td class="px-6 py-4">5,200</td><td class="px-6 py-4">2.2%</td></tr>
                                <tr class="bg-gray-50 border-b"><td class="px-6 py-4 pl-10">其中: ETF</td><td class="px-6 py-4 text-green-600">8,955</td><td class="px-6 py-4 text-green-600">7.2%</td></tr>
                                <tr class="bg-gray-50 border-b"><td class="px-6 py-4 pl-10">其中: 主動型基金</td><td class="px-6 py-4 text-red-600">-3,761</td><td class="px-6 py-4 text-red-600">-3.4%</td></tr>
                                <tr class="border-b"><td class="px-6 py-4 font-medium">債券</td><td class="px-6 py-4">5,922</td><td class="px-6 py-4">7.0%</td></tr>
                                <tr class="bg-gray-50 border-b"><td class="px-6 py-4 font-medium">大宗商品</td><td class="px-6 py-4">1,293</td><td class="px-6 py-4">19.3%</td></tr>
                                <tr class="border-b"><td class="px-6 py-4 font-medium">貨幣市場</td><td class="px-6 py-4">8,658</td><td class="px-6 py-4">8.8%</td></tr>
                            </tbody>
                        </table>
                    </div>
                     <div class="overflow-x-auto bg-white rounded-lg card-shadow">
                        <table class="w-full text-sm text-left text-gray-500">
                            <caption class="p-4 text-lg font-semibold text-left text-gray-800 bg-gray-50">年度至今各區域股票資金流</caption>
                            <thead class="text-xs text-gray-700 uppercase bg-gray-100">
                                <tr><th class="px-6 py-3">區域</th><th class="px-6 py-3">今年至今 (億美元)</th></tr>
                            </thead>
                            <tbody>
                                <tr class="border-b"><td class="px-6 py-4 font-medium">全球股票總計</td><td class="px-6 py-4">5,200</td></tr>
                                <tr class="bg-gray-50 border-b"><td class="px-6 py-4 font-medium text-green-600">美國</td><td class="px-6 py-4 text-green-600">2,383</td></tr>
                                <tr class="border-b"><td class="px-6 py-4 font-medium">歐洲</td><td class="px-6 py-4">503</td></tr>
                                <tr class="bg-gray-50 border-b"><td class="px-6 py-4 font-medium text-red-600">日本</td><td class="px-6 py-4 text-red-600">-104</td></tr>
                                <tr class="border-b"><td class="px-6 py-4 font-medium">新興市場</td><td class="px-6 py-4">393</td></tr>
                                <tr class="bg-gray-50"><td class="px-6 py-4 font-medium">國際 (非美)</td><td class="px-6 py-4">1,786</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                 <div class="emphasis mt-8">
                    <p class="text-lg font-semibold">然而，更有趣的現象是黃金與石油的極端分化。歷史告訴我們，這兩者通常同向而行，因為它們都反映了通膨預期和地緣政治風險。但今年，黃金價格年化上漲超過120%，而石油價格卻下跌了近20%。這種巨大的背離，在歷史上極為罕見，暗示著市場正在交易一個全新的劇本。
                    </p>
                </div>
                <div class="bg-white p-4 rounded-lg card-shadow">
                    <div class="chart-container h-96"><canvas id="goldVsOilScatterChart" height="768" style="display: block; box-sizing: border-box; height: 384px; width: 1071px;" width="2142"></canvas></div>
                    <p class="text-center text-sm text-gray-600 mt-2">歷史數據顯示，金價和油價的年度漲跌幅通常位於左下角（同跌）或右上角（同漲）。2025年的數據點（紅星）處於一個極不尋常的象限，歷史上極為罕見。</p>
                </div>
            </section>

            <section class="mb-12">
                <h2 class="story-title">第二章：信貸的裂縫，派對音樂下的雜音</h2>
                <p class="text-lg text-gray-700 leading-relaxed mb-6">
                    當黃金在舞台上獨舞時，派對的另一個角落，卻傳來了令人不安的碎裂聲。BofA在報告中明確指出，將華爾街牛市與實體經濟熊市黏合在一起的「膠水」——<strong>信貸市場</strong>——正在開裂。這些裂縫雖然還未引發系統性崩潰，但它們是風暴來臨前最可靠的預警信號。
                </p>
                <p class="text-lg text-gray-700 leading-relaxed mb-6">
                    首當其衝的是那些專門為中小企業提供貸款的「商業發展公司」（BDC）。它們的股價指數已經跌破了今年4月的低點，這是一個非常危險的信號，意味著實體經濟的融資渠道正在收緊，壞帳風險正在上升。這也解釋了為何在10月10日的暴跌中，市場反應如此劇烈——因為潛在的信貸風險早已讓市場神經緊繃。
                </p>
                <div class="bg-white p-4 rounded-lg card-shadow">
                    <div class="chart-container h-80"><canvas id="bdcIndexChart" height="640" style="display: block; box-sizing: border-box; height: 320px; width: 1071px;" width="2142"></canvas></div>
                </div>

                <div class="emphasis">
                    <p class="text-lg font-semibold">
                        BofA的私人客戶數據也印證了這種微妙的轉變。這些高淨值人群的股票配置比例雖然仍高達64.9%，但他們在過去一週創下了自今年2月以來最大的股票淨賣出。他們在賣什麼？成長股、公用事業、必需消費品。在買什麼？市政債、高收益債、投資級債券。這是一次典型的從「進攻」到「防守」的戰術轉移，他們正在悄悄降低風險，增加現金和優質債券的配置。
                    </p>
                </div>
                <div class="bg-white p-4 rounded-lg card-shadow">
                    <div class="chart-container" style="height: 400px;"><canvas id="privateClientFlowsChart" height="800" style="display: block; box-sizing: border-box; height: 400px; width: 1071px;" width="2142"></canvas></div>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mt-8">
                        <div><div class="chart-container" style="height: 200px;"><canvas id="privateClientEquityChart" height="400" style="display: block; box-sizing: border-box; height: 200px; width: 335px;" width="671"></canvas></div></div>
                        <div><div class="chart-container" style="height: 200px;"><canvas id="privateClientDebtChart" height="400" style="display: block; box-sizing: border-box; height: 200px; width: 335px;" width="671"></canvas></div></div>
                        <div><div class="chart-container" style="height: 200px;"><canvas id="privateClientCashChart" height="400" style="display: block; box-sizing: border-box; height: 200px; width: 335px;" width="671"></canvas></div></div>
                    </div>
                </div>
            </section>

            <section class="mb-12">
                 <h2 class="story-title">最終章：在分裂的世界中，如何佈局？</h2>
                 <p class="text-lg text-gray-700 leading-relaxed mb-6">
                    綜合所有圖表和數據，一幅清晰的市場畫卷展現在我們面前：一方面，地緣政治風險和潛在的信貸危機推升了避險情緒，資金湧入黃金和現金；另一方面，市場對聯準會的寬鬆預期又讓貪婪情緒維持在高位。這是一個極度分裂且不穩定的平衡。那麼，作為投資者，我們該如何應對？
                </p>
                <h3>1. 擁抱「貨幣貶值」交易的核心：黃金</h3>
                <p class="text-gray-700 mb-4">無論是為了對沖地緣政治風險，還是為了應對未來全球性的寬鬆政策，黃金都是不可或缺的核心配置。BofA的歷史數據顯示，在過去四次黃金牛市中，平均漲幅高達近300%。儘管短期內價格可能過熱，但從結構上看，長期配置黃金的資金依然很少，這意味著上漲的空間依然廣闊。</p>
                <div class="overflow-x-auto bg-white rounded-lg card-shadow mb-8">
                    <table class="w-full text-sm text-left text-gray-500">
                        <caption class="p-4 text-lg font-semibold text-left text-gray-800 bg-gray-50">歷史上的黃金牛市 (1970-2025)</caption>
                        <thead class="text-xs text-gray-700 uppercase bg-gray-100">
                            <tr>
                                <th scope="col" class="px-6 py-3">週期</th>
                                <th scope="col" class="px-6 py-3">持續時間(月)</th>
                                <th scope="col" class="px-6 py-3">黃金總回報</th>
                                <th scope="col" class="px-6 py-3">標普500年化回報</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="border-b"><td class="px-6 py-4 font-medium">Jul'70-Dec'74</td><td class="px-6 py-4">53</td><td class="px-6 py-4 text-green-600 font-bold">421%</td><td class="px-6 py-4 text-red-600">-3%</td></tr>
                            <tr class="bg-gray-50 border-b"><td class="px-6 py-4 font-medium">Aug'76-Sep'80</td><td class="px-6 py-4">49</td><td class="px-6 py-4 text-green-600 font-bold">541%</td><td class="px-6 py-4">5%</td></tr>
                            <tr class="border-b"><td class="px-6 py-4 font-medium">Oct'08-Sep'12</td><td class="px-6 py-4">47</td><td class="px-6 py-4 text-green-600 font-bold">145%</td><td class="px-6 py-4">11%</td></tr>
                            <tr class="bg-gray-50 border-b"><td class="px-6 py-4 font-medium">Oct'22-Oct'25</td><td class="px-6 py-4">36</td><td class="px-6 py-4 text-green-600 font-bold">147%</td><td class="px-6 py-4">20%</td></tr>
                            <tr class="bg-gray-100"><td class="px-6 py-4 font-bold">平均</td><td class="px-6 py-4 font-bold">43</td><td class="px-6 py-4 font-bold text-green-700">293%</td><td class="px-6 py-4 font-bold">5%</td></tr>
                        </tbody>
                    </table>
                </div>

                <h3>2. 為信貸風險購買保險：美元與零息債券</h3>
                <p class="text-gray-700 mb-4">信貸市場的裂縫是目前最大的灰犀牛。一旦風險蔓延，將引發去槓桿和流動性緊縮，屆時美元將成為最終的避風港。因此，BofA建議，持有美元多頭和長天期零息美國國債，是當下對沖這一尾部風險最有效的策略。</p>

                <h3>3. 逆向佈局：關注被冷落的資產</h3>
                <p class="text-gray-700 mb-4">當市場的目光都聚焦在黃金和科技股上時，聰明的投資者應該去尋找那些被冷落但基本面正在改善的角落。本週，資金流入**醫療保健**板塊的規模創下了自23年4月以來的新高，這可能是一個新的趨勢起點。此外，如果BofA關於「和平交易」的預測成真，油價下跌將極大利好美國、歐洲和日本的消費者，相關的消費股可能迎來重估機會。</p>
                 <div class="emphasis">
                    <p class="text-lg font-semibold">總結而言，當前的策略應該是「啞鈴型」的：一端是作為核心避險的黃金；另一端是作為對沖信貸風險的美元和長債；中間則可以小部分佈局基本面出現改善跡象、且估值合理的板塊，如醫療保健。</p>
                </div>
            </section>
            
            <section>
                <h2 class="story-title">結語</h2>
                <div class="mt-8 space-y-4">
                    <div class="pulse-item text-center">
                        <p class="text-lg font-semibold text-gray-800 italic">"The stock market is a device for transferring money from the impatient to the patient."</p>
                        <p class="text-sm text-gray-600 mt-2">「股市是一個將錢從沒有耐心的人轉移到有耐心的人手中的設備。」 - 華倫·巴菲特 (Warren Buffett)</p>
                    </div>
                </div>
            </section>

        </main>

        <footer class="text-center mt-12 text-xs text-gray-500">
            <p>免責聲明：本報告內容僅為基於公開信息的市場分析，不構成任何投資建議。投資有風險，入市需謹慎。</p>
        </footer>
    </div>
    
    

<script>
// Encapsulate all chart logic in a function to ensure it runs after DOM is loaded.
function renderCharts() {
    try {
        Chart.register(ChartDataLabels);
        Chart.defaults.font.family = "'Noto Sans TC', sans-serif";
        Chart.defaults.color = '#655A4E';

        // Helper function to safely create charts
        const createChart = (elementId, config) => {
            const ctx = document.getElementById(elementId);
            if (ctx) {
                // Destroy existing chart instance if it exists
                const existingChart = Chart.getChart(ctx);
                if (existingChart) {
                    existingChart.destroy();
                }
                new Chart(ctx, config);
            } else {
                console.warn(`Canvas element with id '${elementId}' not found.`);
            }
        };
        
        // Quadrant Labels Plugin
        const quadrantLabels = {
            id: 'quadrantLabels',
            afterDraw: (chart) => {
                const ctx = chart.ctx;
                const xAxis = chart.scales.x;
                const yAxis = chart.scales.y;
                ctx.save();
                ctx.font = 'bold 14px Noto Sans TC';
                ctx.fillStyle = '#C62828';
                
                // Top-right
                ctx.textAlign = 'right';
                ctx.fillText('Gold ↑, oil ↑', xAxis.right - 10, yAxis.top + 20);
                
                // Top-left
                ctx.textAlign = 'left';
                ctx.fillText('Gold ↓, oil ↑', xAxis.left + 10, yAxis.top + 20);

                // Bottom-left
                ctx.textAlign = 'left';
                ctx.fillText('Gold ↓, oil ↓', xAxis.left + 10, yAxis.bottom - 10);
                
                // Bottom-right
                ctx.textAlign = 'right';
                ctx.fillText('Gold ↑, oil ↓', xAxis.right - 10, yAxis.bottom - 10);
                
                ctx.restore();
            }
        };

        // Bull & Bear Indicator
        const gaugeNeedle = {
            id: 'gaugeNeedle',
            afterDraw(chart, args, options) {
                const { ctx, data, chartArea: { left, right, top, bottom, width, height} } = chart;
                ctx.save();
                
                const needleValue = 6.5; // The value the needle points to
                const dataTotal = data.datasets[0].data.reduce((a, b) => a + b, 0);
                const angle = Math.PI + (1 / dataTotal * needleValue * Math.PI);

                const cx = width / 2;
                const cy = height + top;

                // Needle
                ctx.translate(cx + left, cy);
                ctx.rotate(angle);
                ctx.beginPath();
                ctx.moveTo(0, -5);
                ctx.lineTo(height - 10, 0);
                ctx.lineTo(0, 5);
                ctx.fillStyle = '#655A4E';
                ctx.fill();
                ctx.rotate(-angle);
                
                // Needle dot
                ctx.beginPath();
                ctx.arc(0, 0, 8, 0, Math.PI * 2);
                ctx.fill();
                ctx.closePath();
                
                // Value text
                ctx.fillStyle = '#F57C00';
                ctx.font = 'bold 28px sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText(needleValue, 0, -height*0.35); // Adjust position to be above the dot

                ctx.restore();
            }
        };

        createChart('bullBearIndicator', {
            type: 'doughnut',
            data: {
                labels: ['Buy', 'Neutral', 'Sell'],
                datasets: [{
                    data: [2, 6, 2], // Corresponds to 0-2, 2-8, 8-10 ranges
                    backgroundColor: ['#4CAF50', '#FFC107', '#F44336'],
                    borderWidth: 0,
                }]
            },
            options: {
                circumference: 180,
                rotation: 270,
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    tooltip: { enabled: false },
                    title: {
                        display: true,
                        text: '牛熊指標',
                        position: 'top',
                        align: 'center',
                        font: { size: 16, weight: 'bold' },
                        color: '#655A4E'
                    },
                     datalabels: {
                        formatter: (value, context) => context.chart.data.labels[context.dataIndex],
                        color: (context) => (context.dataIndex === 1 ? '#655A4E' : '#fff'),
                        font: { weight: 'bold' }
                     }
                },
                cutout: '70%',
            },
            plugins: [gaugeNeedle]
        });

        // YTD Returns Chart
        const ytdData = { '黃金': 53.1, '比特幣': 31.1, '股票': 20.3, '投資級債': 9.6, '高收益債': 9.3, '政府公債': 6.4, '大宗商品': 5.7, '現金': 3.3, '美元': -8.8, '石油': -12.8 };
        createChart('ytdReturnsChart', {
            type: 'bar',
            data: {
                labels: Object.keys(ytdData),
                datasets: [{
                    label: '年度至今回報率 (%)',
                    data: Object.values(ytdData),
                    backgroundColor: Object.values(ytdData).map(v => v >= 0 ? 'rgba(102, 187, 106, 0.7)' : 'rgba(239, 83, 80, 0.7)'),
                    borderColor: Object.values(ytdData).map(v => v >= 0 ? '#4CAF50' : '#F44336'),
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true, maintainAspectRatio: false,
                plugins: { 
                    legend: { display: false }, 
                    title: { display: true, text: '年度至今各大類資產回報排行', font: {size: 16}},
                    datalabels: {
                        anchor: 'end',
                        align: 'end',
                        formatter: (value) => value + '%',
                        color: (context) => context.dataset.data[context.dataIndex] > 0 ? '#1B5E20' : '#B71C1C',
                        font: { weight: 'bold' }
                    }
                },
                scales: { 
                    x: { ticks: { display: true, maxRotation: 90, minRotation: 90 } },
                    y: { ticks: { callback: (value) => value + '%' } } 
                }
            }
        });
        
        // Weekly Flows Chart
        const weeklyFlowsData = { '現金': 72.9, '債券': 25.6, '股票': 20.0, '加密貨幣': 5.5, '黃金': 2.1 };
        createChart('weeklyFlowsChart', {
            type: 'bar',
            data: {
                labels: Object.keys(weeklyFlowsData),
                datasets: [{
                    label: '單週資金流 (十億美元)',
                    data: Object.values(weeklyFlowsData),
                    backgroundColor: 'rgba(66, 165, 245, 0.7)',
                    borderColor: '#1E88E5',
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true, maintainAspectRatio: false,
                plugins: { 
                    legend: { display: false }, 
                    title: { display: true, text: '本週主要資產資金流向 (十億美元)', font: { size: 16 } },
                    datalabels: {
                        anchor: 'end',
                        align: 'end',
                        formatter: (value) => '$' + value + 'bn',
                        font: { weight: 'bold' }
                    }
                },
                scales: { 
                    x: { grid: { display: false } },
                    y: { beginAtZero: true, ticks: { display: false } }
                }
            }
        });

        // Gold vs Oil Scatter Chart
        createChart('goldVsOilScatterChart', {
            type: 'scatter',
            plugins: [quadrantLabels],
            data: {
                datasets: [
                {
                    label: '歷史數據 (含年份)',
                    data: [
                        {x: 68, y: 105, year: '1973'}, 
                        {x: 75, y: 125, year: '1974'}, 
                        {x: 125, y: 90, year: '1979'},
                    ],
                    backgroundColor: 'rgba(100, 100, 100, 0.7)',
                    borderColor: 'rgba(50, 50, 50, 1)',
                    borderWidth: 1,
                    pointRadius: 8,
                },{
                    label: '歷史數據 (其他)',
                    data: [
                        {x: -18, y: 5}, {x: -15, y: -20}, {x: 18, y: 55},
                        {x: 38, y: 12}, {x: 22, y: -30}, {x: -10, y: 8}, 
                        {x: -5, y: -22}, {x: -2, y: 1}, {x: 0, y: -50}, 
                        {x: 1, y: 10}, {x: 2, y: 0}, {x: 4, y: -10}, {x: 5, y: 52},
                        {x: 6, y: -25}, {x: 8, y: 20}, {x: 10, y: -40}, {x: 12, y: 50}, 
                        {x: 15, y: 38}, {x: 17, y: 22}, {x: 20, y: 70}, {x: 21, y: -5},
                        {x: 24, y: -28}, {x: 25, y: 2}, {x: 28, y: 55}, {x: 32, y: 10}
                    ],
                    backgroundColor: 'rgba(180, 180, 180, 0.5)'
                }, {
                    label: '2025年',
                    data: [{x: 121, y: -18, year: '2025*'}],
                    backgroundColor: '#FF0000', 
                    borderColor: '#B71C1C',
                    borderWidth: 2,
                    pointStyle: 'star',
                    radius: 18,
                }]
            },
            options: {
                responsive: true, maintainAspectRatio: false,
                plugins: {
                    title: { 
                        display: true, 
                        text: ['黃金大漲與石油大跌的歷史異象', '布蘭特原油 vs 黃金 年度價格變化 (%)'],
                        font: { size: 16 }
                    },
                    legend: { position: 'bottom' },
                    datalabels: {
                        display: (context) => {
                            const dataPoint = context.dataset.data[context.dataIndex];
                            return dataPoint && dataPoint.hasOwnProperty('year');
                        },
                        formatter: (value) => value.year,
                        color: (context) => context.dataset.label === '2025年' ? '#FF0000' : '#333',
                        align: 'top',
                        font: {
                            weight: 'bold',
                            size: 14
                        }
                    }
                },
                scales: {
                    x: { title: { display: true, text: '黃金價格年變動 (%)' } },
                    y: { title: { display: true, text: '石油價格年變動 (%)' } }
                }
            }
        });
        
        // BDC Index Chart
        createChart('bdcIndexChart', {
            type: 'line',
            data: {
                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct'],
                datasets: [{
                    label: 'MVIS US BDC Index',
                    data: [520, 540, 510, 445, 480, 500, 530, 510, 480, 440],
                    borderColor: '#EF5350',
                    tension: 0.1,
                    fill: false
                }]
            },
            options: {
                responsive: true, maintainAspectRatio: false,
                plugins: {
                    legend: { display: false },
                    title: { 
                        display: true, 
                        text: '商業發展公司指數跌破4月低點',
                        font: { size: 16 }
                    },
                    datalabels: { display: false }
                },
                scales: {
                    y: { beginAtZero: false }
                }
            }
        });

        // Materials Flow Chart
        createChart('materialsFlowChart', {
            type: 'line',
            data: {
                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct'],
                datasets: [{
                    label: '原物料基金累計資金流 (十億美元)',
                    data: [-5, -2, 8, 15, 12, 25, 30, 45, 60, 79],
                    borderColor: '#4CAF50',
                    backgroundColor: 'rgba(76, 175, 80, 0.2)',
                    fill: true,
                    tension: 0.4
                }]
            },
            options: {
                responsive: true, maintainAspectRatio: false,
                plugins: {
                    legend: { display: false },
                    title: { 
                        display: true, 
                        text: '原物料基金年度資金流入創紀錄',
                        font: { size: 16 }
                    },
                    datalabels: { display: false }
                },
                scales: {
                    y: {
                        title: {
                            display: true,
                            text: '累計資金流 (十億美元)'
                        }
                    }
                }
            }
        });

        // Private Client Flows Chart
        createChart('privateClientFlowsChart', {
            type: 'bar',
            data: {
                labels: ['市政債', '高收益債', '投資級債', '貴金屬', '新興市場債', 'REITs', '價值股', '成長股', '公用事業', '必需消費品', '醫療保健', '日本股票', '非必需消費品', '美國股票'],
                datasets: [{
                    label: '四周累計資金流 (% AUM)',
                    data: [5.1, 4.2, 3.5, 3.1, 2.8, 2.5, 1.2, -0.2, -0.8, -1.1, -1.5, -1.8, -2.2, -2.5],
                    backgroundColor: (context) => context.raw >= 0 ? 'rgba(66, 165, 245, 0.7)' : 'rgba(239, 83, 80, 0.7)',
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false },
                    title: { 
                        display: true,
                        text: 'BofA 私人客戶近4週資金流向 (% AUM)',
                        font: { size: 16 }
                    },
                    datalabels: {
                        anchor: 'end',
                        align: 'top',
                        formatter: (value) => value.toFixed(1) + '%',
                        color: (context) => context.dataset.data[context.dataIndex] >=0 ? '#1E88E5' : '#D32F2F',
                    }
                },
                scales: {
                    x: {
                        ticks: {
                            display: true,
                            maxRotation: 90,
                            minRotation: 90
                        }
                    },
                    y: {
                        ticks: {
                            callback: (value) => value + '%'
                        }
                    }
                }
            }
        });

        // Private Client Allocation Charts
        const allocationLabels = ['05', '07', '09', '11', '13', '15', '17', '19', '21', '23', '25'];
        
        createChart('privateClientEquityChart', {
            type: 'line',
            data: {
                labels: allocationLabels,
                datasets: [{
                    label: '股票配置比例',
                    data: [54, 56, 39, 50, 56, 63, 60, 62, 66, 58, 65],
                    borderColor: '#3b82f6',
                    tension: 0.1,
                }]
            },
            options: {
                responsive: true, maintainAspectRatio: false,
                plugins: {
                    legend: { display: false },
                    title: { display: true, text: '股票配置比例 (% AUM)' }
                }
            }
        });

        createChart('privateClientDebtChart', {
            type: 'line',
            data: {
                labels: allocationLabels,
                datasets: [{
                    label: '債券配置比例',
                    data: [29, 26, 34, 32, 28, 25, 24, 23, 17, 22, 18],
                    borderColor: '#10b981',
                    tension: 0.1,
                }]
            },
            options: {
                responsive: true, maintainAspectRatio: false,
                plugins: {
                    legend: { display: false },
                    title: { display: true, text: '債券配置比例 (% AUM)' }
                }
            }
        });
        
        createChart('privateClientCashChart', {
            type: 'line',
            data: {
                labels: allocationLabels,
                datasets: [{
                    label: '現金配置比例',
                    data: [12, 11, 21, 15, 13, 12, 11, 14, 11, 12.5, 10],
                    borderColor: '#f97316',
                    tension: 0.1,
                }]
            },
            options: {
                responsive: true, maintainAspectRatio: false,
                plugins: {
                    legend: { display: false },
                    title: { display: true, text: '現金配置比例 (% AUM)' }
                }
            }
        });


        // Download button logic
        const downloadBtn = document.getElementById('downloadBtn');
        if (downloadBtn) {
            downloadBtn.addEventListener('click', function() {
                const reportDate = "20251009";
                const pdfTitle = "A Peace of the Pie";
                const filename = `${reportDate}_BofA_The Flow_Show_${pdfTitle}.html`;
                
                const clonedDoc = document.documentElement.cloneNode(true);
                const btnToRemove = clonedDoc.querySelector('#downloadBtn');
                if(btnToRemove) btnToRemove.remove();

                const blob = new Blob([clonedDoc.outerHTML], { type: 'text/html;charset=utf-8' });
                const url = URL.createObjectURL(blob);
                
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            });
        }
    } catch (e) {
        console.error("圖表渲染時發生錯誤:", e);
    }
}

// Ensure the DOM is fully loaded before trying to render charts
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', renderCharts);
} else {
    renderCharts();
}
</script>




</body></html>