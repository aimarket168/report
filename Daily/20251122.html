<html lang="zh-TW"><head><script>(function(firebaseConfig, initialAuthToken, appId) {
        window.__firebase_config = firebaseConfig;
        window.__initial_auth_token = initialAuthToken;
        window.__app_id = appId;
            })("\n{\n  \"apiKey\": \"AIzaSyCqyCcs2R2e7AegGjvFAwG98wlamtbHvZY\",\n  \"authDomain\": \"bard-frontend.firebaseapp.com\",\n  \"projectId\": \"bard-frontend\",\n  \"storageBucket\": \"bard-frontend.firebasestorage.app\",\n  \"messagingSenderId\": \"175205271074\",\n  \"appId\": \"1:175205271074:web:2b7bd4d34d33bf38e6ec7b\"\n}\n","eyJhbGciOiJSUzI1NiIsImtpZCI6IjA5ZmNiMTMxOGNkZGNmOWU4YjczZjZhMzM3ZTk2ZTIwNjJmMjEwZGIiLCJ0eXAiOiJKV1QifQ.eyJzdWIiOiJmaXJlYmFzZS1hZG1pbnNkay1mYnN2Y0BiYXJkLWZyb250ZW5kLmlhbS5nc2VydmljZWFjY291bnQuY29tIiwiYXVkIjoiaHR0cHM6Ly9pZGVudGl0eXRvb2xraXQuZ29vZ2xlYXBpcy5jb20vZ29vZ2xlLmlkZW50aXR5LmlkZW50aXR5dG9vbGtpdC52MS5JZGVudGl0eVRvb2xraXQiLCJ1aWQiOiIwMTYyNzg3NDM4ODM1OTc2Mjk5OCIsImlzcyI6ImZpcmViYXNlLWFkbWluc2RrLWZic3ZjQGJhcmQtZnJvbnRlbmQuaWFtLmdzZXJ2aWNlYWNjb3VudC5jb20iLCJjbGFpbXMiOnsiYXBwSWQiOiJjXzEyYTJiMjNlMzU3OGMyYTZfcmVwb3J0Lmh0bWwtNDAifSwiZXhwIjoxNzYzNzcwMzIyLCJpYXQiOjE3NjM3NjY3MjIsImFsZyI6IlJTMjU2In0.O2x7ZDjMb-sCr66lyDxrwhhfEYpSiRjU_gwMMiaiiHWpsXBFt7XrEtSSEWcGbQ-LYzzElyafP3seYz8Lbeu6bQIuJuQ2pN6U1p-wx4EObhjnUlHLTxQGRBEEAP5cz5dWkzxHCADEtDSJlaLgPN6t5IqMCQium3Pt5BFE3z2Nh-TBI0jD7105RMZtrpplH8mX6s-SWF4E7EpxM-KLXP-klCAt16FCmsqEKWISnrcfekEKkUYOWyn3NLyMyYvwPJQN8qfBiUJQNseaa_ToSQCtYKD3yzuvQSEcKQ5B-80qmOzuP1v1ur9HfHOO7PkgGmhaBdMwkKhheBgN9laRkDZKDQ","c_12a2b23e3578c2a6_report.html-40")</script><script>'use strict';var h=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,b,d){if(a==Array.prototype||a==Object.prototype)return a;a[b]=d.value;return a};function l(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var d=a[b];if(d&&d.Math==Math)return d}throw Error("Cannot find global object");}var n=l(this);
function p(a,b){if(b)a:{var d=n;a=a.split(".");for(var c=0;c<a.length-1;c++){var e=a[c];if(!(e in d))break a;d=d[e]}a=a[a.length-1];c=d[a];b=b(c);b!=c&&b!=null&&h(d,a,{configurable:!0,writable:!0,value:b})}}function r(a){function b(c){return a.next(c)}function d(c){return a.throw(c)}return new Promise(function(c,e){function f(g){g.done?c(g.value):Promise.resolve(g.value).then(b,d).then(f,e)}f(a.next())})}function t(a){return r(a())}
p("Object.values",function(a){return a?a:function(b){var d=[],c;for(c in b)Object.prototype.hasOwnProperty.call(b,c)&&d.push(b[c]);return d}});p("Array.prototype.includes",function(a){return a?a:function(b,d){var c=this;c instanceof String&&(c=String(c));var e=c.length;d=d||0;for(d<0&&(d=Math.max(d+e,0));d<e;d++){var f=c[d];if(f===b||Object.is(f,b))return!0}return!1}});/*

 MIT License

 Copyright (c) 2017-2023 W.Y.

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in
 all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 SOFTWARE.

*/
function u(a,b){const d=a.style;b.backgroundColor&&(d.backgroundColor=b.backgroundColor);b.width&&(d.width=`${b.width}px`);b.height&&(d.height=`${b.height}px`);const c=b.style;c!=null&&Object.keys(c).forEach(e=>{d[e]=c[e]})};var v=(()=>{let a=0;return()=>{a+=1;return`u${`0000${(Math.random()*1679616<<0).toString(36)}`.slice(-4)}${a}`}})();function w(a){const b=[];for(let d=0,c=a.length;d<c;d++)b.push(a[d]);return b}let x=null;function y(a={}){return x?x:a.l?x=a.l:x=w(window.getComputedStyle(document.documentElement))}function z(a,b){return(a=(a.ownerDocument.defaultView||window).getComputedStyle(a).getPropertyValue(b))?parseFloat(a.replace("px","")):0}
function A(a,b={}){var d;if(!(d=b.width)){d=z(a,"border-left-width");var c=z(a,"border-right-width");d=a.clientWidth+d+c}(b=b.height)||(b=z(a,"border-top-width"),c=z(a,"border-bottom-width"),b=a.clientHeight+b+c);return{width:d,height:b}}function B(a){return new Promise((b,d)=>{const c=new Image;c.onload=()=>{c.decode().then(()=>{requestAnimationFrame(()=>b(c))})};c.onerror=d;c.crossOrigin="anonymous";c.decoding="async";c.src=a})}
function C(a){return t(function*(){return Promise.resolve().then(()=>(new XMLSerializer).serializeToString(a)).then(encodeURIComponent).then(b=>`data:image/svg+xml;charset=utf-8,${b}`)})}
function D(a,b,d){return t(function*(){const c=document.createElementNS("http://www.w3.org/2000/svg","svg"),e=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");c.setAttribute("width",`${b}`);c.setAttribute("height",`${d}`);c.setAttribute("viewBox",`0 0 ${b} ${d}`);e.setAttribute("width","100%");e.setAttribute("height","100%");e.setAttribute("x","0");e.setAttribute("y","0");e.setAttribute("externalResourcesRequired","true");c.appendChild(e);e.appendChild(a);return C(c)})}
var E=(a,b)=>{if(a instanceof b)return!0;a=Object.getPrototypeOf(a);return a===null?!1:a.constructor.name===b.name||E(a,b)};function F(a,b){return y(b).map(d=>{const c=a.getPropertyValue(d),e=a.getPropertyPriority(d);return`${d}: ${c}${e?" !important":""};`}).join(" ")}
function G(a,b,d,c){a=window.getComputedStyle(a,d);var e=a.getPropertyValue("content");if(e!==""&&e!=="none"){var f=v();try{b.className=`${b.className} ${f}`}catch(k){return}e=document.createElement("style");var g=e.appendChild;d=`.${f}:${d}`;a.cssText?(c=a.getPropertyValue("content"),c=`${a.cssText} content: '${c.replace(/'|"/g,"")}';`):c=F(a,c);g.call(e,document.createTextNode(`${d}{${c}}`));b.appendChild(e)}};function H(a){return a.search(/^(data:)/)!==-1}function I(a,b,d){return t(function*(){const c=yield fetch(a,b);if(c.status===404)throw Error(`Resource "${c.url}" not found`);const e=yield c.blob();return new Promise((f,g)=>{const k=new FileReader;k.onerror=g;k.onloadend=()=>{try{f(d({o:c,result:k.result}))}catch(m){g(m)}};k.readAsDataURL(e)})})}const J={};function K(a,b,d){let c=a.replace(/\?.*/,"");d&&(c=a);/ttf|otf|eot|woff2?/i.test(c)&&(c=c.replace(/.*\//,""));return b?`[${b}]${c}`:c}
function L(a,b,d){return t(function*(){const c=K(a,b,d.C);if(J[c]!=null)return J[c];d.u&&(a+=(/\?/.test(a)?"&":"?")+(new Date).getTime());let e;try{const f=yield I(a,d.i,({o:g,result:k})=>{b||(b=g.headers.get("Content-Type")||"");return k.split(/,/)[1]});e=`data:${b};base64,${f}`}catch(f){e=d.B||""}return J[c]=e})};const M={P:"application/font-woff",R:"application/font-woff",N:"application/font-truetype",v:"application/vnd.ms-fontobject",H:"image/png",F:"image/jpeg",D:"image/jpeg",A:"image/gif",M:"image/tiff",L:"image/svg+xml",O:"image/webp"};function N(a){return(a=/\.([^./]*?)$/g.exec(a))?a[1]:""};function O(a){return t(function*(){const b=a.toDataURL();return b==="data:,"?a.cloneNode(!1):B(b)})}function aa(a,b){return t(function*(){if(a.currentSrc){var d=document.createElement("canvas");const c=d.getContext("2d");d.width=a.clientWidth;d.height=a.clientHeight;c==null||c.drawImage(a,0,0,d.width,d.height);d=d.toDataURL();return B(d)}d=a.poster;d=yield L(d,M[N(d).toLowerCase()]||"",b);return B(d)})}
function ba(a,b){return t(function*(){try{let d;if(a==null?0:(d=a.contentDocument)==null?0:d.body)return yield P(a.contentDocument.body,b,!0)}catch(d){}return a.cloneNode(!1)})}function ca(a,b){return t(function*(){return E(a,HTMLCanvasElement)?O(a):E(a,HTMLVideoElement)?aa(a,b):E(a,HTMLIFrameElement)?ba(a,b):a.cloneNode(a.tagName!=null&&a.tagName.toUpperCase()==="SVG")})}
function da(a,b,d){return t(function*(){if(b.tagName!=null&&b.tagName.toUpperCase()==="SVG")return b;let c=[];if(a.tagName!=null&&a.tagName.toUpperCase()==="SLOT"&&a.assignedNodes)c=w(a.assignedNodes());else{let e;if(E(a,HTMLIFrameElement)&&((e=a.contentDocument)==null?0:e.body))c=w(a.contentDocument.body.childNodes);else{let f;c=w(((f=a.shadowRoot)!=null?f:a).childNodes)}}if(c.length===0||E(a,HTMLVideoElement))return b;yield c.reduce((e,f)=>e.then(()=>P(f,d)).then(g=>{g&&b.appendChild(g)}),Promise.resolve());
return b})}function ea(a,b,d){const c=b.style;if(c){var e=window.getComputedStyle(a);e.cssText?(c.cssText=e.cssText,c.transformOrigin=e.transformOrigin):y(d).forEach(f=>{let g=e.getPropertyValue(f);f==="font-size"&&g.endsWith("px")&&(g=`${Math.floor(parseFloat(g.substring(0,g.length-2)))-.1}px`);E(a,HTMLIFrameElement)&&f==="display"&&g==="inline"&&(g="block");f==="d"&&b.getAttribute("d")&&(g=`path(${b.getAttribute("d")})`);c.setProperty(f,g,e.getPropertyPriority(f))})}}
function fa(a,b){E(a,HTMLSelectElement)&&(b=Array.from(b.children).find(d=>a.value===d.getAttribute("value")))&&b.setAttribute("selected","")}
function ha(a,b){return t(function*(){var d=a.querySelectorAll?a.querySelectorAll("use"):[];if(d.length===0)return a;var c={};for(var e=0;e<d.length;e++){var f=d[e].getAttribute("xlink:href");if(f){const g=document.querySelector(f);a.querySelector(f)||!g||c[f]||(c[f]=yield P(g,b,!0))}}d=Object.values(c);if(d.length){c=document.createElementNS("http://www.w3.org/1999/xhtml","svg");c.setAttribute("xmlns","http://www.w3.org/1999/xhtml");c.style.position="absolute";c.style.width="0";c.style.height="0";
c.style.overflow="hidden";c.style.display="none";e=document.createElementNS("http://www.w3.org/1999/xhtml","defs");c.appendChild(e);for(f=0;f<d.length;f++)e.appendChild(d[f]);a.appendChild(c)}return a})}
function P(a,b,d){return t(function*(){return d||!b.filter||b.filter(a)?Promise.resolve(a).then(c=>ca(c,b)).then(c=>da(a,c,b)).then(c=>{E(c,Element)&&(ea(a,c,b),G(a,c,":before",b),G(a,c,":after",b),E(a,HTMLTextAreaElement)&&(c.textContent=a.value),E(a,HTMLInputElement)&&c.setAttribute("value",a.value),fa(a,c));return c}).then(c=>ha(c,b)):null})};const Q=/url\((['"]?)([^'"]+?)\1\)/g,ia=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,ja=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function ka(a){const b=[];a.replace(Q,(d,c,e)=>{b.push(e);return d});return b.filter(d=>!H(d))}
function la(a,b,d,c){return t(function*(){try{const e=d?(new URL(b,d||void 0)).toString():b;let f;f=yield L(e,M[N(b).toLowerCase()]||"",c);return a.replace(new RegExp(`(url\\(['"]?)(${b.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")})(['"]?\\))`,"g"),`$1${f}$3`)}catch(e){}return a})}function ma(a,{I:b}){return b?a.replace(ja,d=>{for(;;){const [c,,e]=ia.exec(d)||[],f=c,g=e;if(!g)return"";if(g===b)return`src: ${f};`}}):a}
function R(a,b,d){return t(function*(){if(a.search(Q)===-1)return a;const c=ma(a,d);return ka(c).reduce((e,f)=>e.then(g=>la(g,f,b,d)),Promise.resolve(c))})};function S(a,b,d){return t(function*(){var c;const e=(c=b.style)==null?void 0:c.getPropertyValue(a);return e?(c=yield R(e,null,d),b.style.setProperty(a,c,b.style.getPropertyPriority(a)),!0):!1})}function na(a,b){return t(function*(){(yield S("background",a,b))||(yield S("background-image",a,b));(yield S("mask",a,b))||(yield S("-webkit-mask",a,b))||(yield S("mask-image",a,b))||(yield S("-webkit-mask-image",a,b))})}
function oa(a,b){return t(function*(){const d=E(a,HTMLImageElement);if(d&&!H(a.src)||E(a,SVGImageElement)&&!H(a.href.baseVal)){var c=d?a.src:a.href.baseVal,e=yield L(c,M[N(c).toLowerCase()]||"",b);yield new Promise((f,g)=>{a.onload=f;a.onerror=b.m?(...k)=>{try{f(b.m(...k))}catch(m){g(m)}}:g;a.decode&&(a.decode=f);a.loading==="lazy"&&(a.loading="eager");d?(a.srcset="",a.src=e):a.href.baseVal=e})}})}
function pa(a,b){return t(function*(){const d=w(a.childNodes).map(c=>T(c,b));yield Promise.all(d).then(()=>a)})}function T(a,b){return t(function*(){E(a,Element)&&(yield na(a,b),yield oa(a,b),yield pa(a,b))})};const U={};function V(a){return t(function*(){var b=U[a];if(b!=null)return b;b=yield(yield fetch(a)).text();b={url:a,cssText:b};return U[a]=b})}function W(a,b){return t(function*(){let d=a.cssText;const c=/url\(["']?([^"')]+)["']?\)/g,e=(d.match(/url\([^)]+\)/g)||[]).map(f=>t(function*(){let g=f.replace(c,"$1");g.startsWith("https://")||(g=(new URL(g,a.url)).href);return I(g,b.i,({result:k})=>{d=d.replace(f,`url(${k})`);return[f,k]})}));return Promise.all(e).then(()=>d)})}
function X(a){if(a==null)return[];const b=[];a=a.replace(/(\/\*[\s\S]*?\*\/)/gi,"");for(var d=RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");;){var c=d.exec(a);if(c===null)break;b.push(c[0])}a=a.replace(d,"");d=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi;for(c=RegExp("((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})","gi");;){let e=d.exec(a);if(e===null)if(e=c.exec(a),e===null)break;else d.lastIndex=c.lastIndex;else c.lastIndex=
d.lastIndex;b.push(e[0])}return b}
function qa(a,b){return t(function*(){const d=[],c=[];a.forEach(e=>{if("cssRules"in e)try{w(e.cssRules||[]).forEach((f,g)=>{if(f.type===CSSRule.IMPORT_RULE){let k=g+1;f=V(f.href).then(m=>W(m,b)).then(m=>X(m).forEach(q=>{try{e.insertRule(q,q.startsWith("@import")?k+=1:e.cssRules.length)}catch(Da){}})).catch(()=>{});c.push(f)}})}catch(f){const g=a.find(k=>k.href==null)||document.styleSheets[0];e.href!=null&&c.push(V(e.href).then(k=>W(k,b)).then(k=>X(k).forEach(m=>{g.insertRule(m,g.cssRules.length)})).catch(()=>
{}))}});return Promise.all(c).then(()=>{a.forEach(e=>{if("cssRules"in e)try{w(e.cssRules||[]).forEach(f=>{d.push(f)})}catch(f){}});return d})})}function ra(a){return a.filter(b=>b.type===CSSRule.FONT_FACE_RULE).filter(b=>b.style.getPropertyValue("src").search(Q)!==-1)}function sa(a,b){return t(function*(){if(a.ownerDocument==null)throw Error("Provided element is not within a Document");var d=w(a.ownerDocument.styleSheets);d=yield qa(d,b);return ra(d)})}
function ta(a){function b(c){(c.style.fontFamily||getComputedStyle(c).fontFamily).split(",").forEach(e=>{d.add(e.trim().replace(/["']/g,""))});Array.from(c.children).forEach(e=>{e instanceof HTMLElement&&b(e)})}const d=new Set;b(a);return d}function ua(a,b){return t(function*(){const d=yield sa(a,b),c=ta(a);return(yield Promise.all(d.filter(e=>c.has(e.style.fontFamily.trim().replace(/["']/g,""))).map(e=>R(e.cssText,e.parentStyleSheet?e.parentStyleSheet.href:null,b)))).join("\n")})}
function va(a,b){return t(function*(){const d=b.j!=null?b.j:b.K?null:yield ua(a,b);if(d){const c=document.createElement("style");c.appendChild(document.createTextNode(d));a.firstChild?a.insertBefore(c,a.firstChild):a.appendChild(c)}})};function wa(a,b={}){return t(function*(){const {width:d,height:c}=A(a,b),e=yield P(a,b,!0);yield va(e,b);yield T(e,b);u(e,b);return yield D(e,d,c)})}
function xa(a,b={}){return t(function*(){const {width:d,height:c}=A(a,b);var e=yield wa(a,b);e=yield B(e);const f=document.createElement("canvas"),g=f.getContext("2d"),k=b.G||window.devicePixelRatio||1,m=b.h||d,q=b.g||c;f.width=m*k;f.height=q*k;!b.J&&(f.width>16384||f.height>16384)&&(f.width>16384&&f.height>16384?f.width>f.height?(f.height*=16384/f.width,f.width=16384):(f.width*=16384/f.height,f.height=16384):f.width>16384?(f.height*=16384/f.width,f.width=16384):(f.width*=16384/f.height,f.height=
16384));f.style.width=`${m}`;f.style.height=`${q}`;b.backgroundColor&&(g.fillStyle=b.backgroundColor,g.fillRect(0,0,f.width,f.height));g.drawImage(e,0,0,f.width,f.height);return f})}function ya(a,b={}){return t(function*(){return(yield xa(a,b)).toDataURL()})};const za=["gemini.google.com","corp.google.com","proxy.googlers.com"];function Y(){return document.body.querySelectorAll('[class*="animate"]').length>0}function Z(a){return t(function*(){try{return yield ya(a,{h:a.offsetWidth,g:a.offsetHeight})}catch(d){var b=a.offsetHeight;const c=document.createElement("canvas");c.width=a.offsetWidth;c.height=b;return c.toDataURL("image/png")}})}
function Aa(){return t(function*(){const a=document.body.offsetWidth,b=document.body.offsetHeight,d=document.body.cloneNode(!0);d.querySelectorAll('[class*="animate"]').forEach(c=>{c.classList.remove(...Array.from(c.classList).filter(e=>e.startsWith("animate")))});d.style.width=`${a}px`;d.style.height=`${b}px`;return d})}
function Ba(a){return t(function*(){let b=document.body;if(Y()){var d=yield Aa();b=d;document.body.appendChild(d)}d=yield Z(b);Y()&&document.body.removeChild(b);window.parent.postMessage({type:"SEND_SCREENSHOT",image:d,topOffset:document.documentElement.scrollTop},a.origin)})}function Ca(a){return t(function*(){const b={type:"SEND_SCREENSHOT_FOR_DATA_VISUALIZATION",image:yield Z(document.body),topOffset:0};window.parent.postMessage(b,a.origin)})}
window.addEventListener("message",a=>t(function*(){if(za.some(d=>a.origin.includes(d))){var b=a.data;b&&(b.type==="MAKE_SCREENSHOT"&&(yield Ba(a)),b.type==="MAKE_SCREENSHOT_FOR_DATA_VISUALIZATION"&&(yield Ca(a)))}}));
</script><script>(function() {
  // Ensure this script is executed only once
  if (window.firebaseAuthBridgeScriptLoaded) {
    return;
  }
  window.firebaseAuthBridgeScriptLoaded = true;

  let nextTokenPromiseId = 0;

  // Stores { resolve, reject } for ongoing token requests
  const pendingTokenPromises = {};

  // Listen for messages from the Host Application
  window.addEventListener('message', function(event) {

    const messageData = event.data;

  if (messageData && messageData.type === 'RESOLVE_NEW_FIREBASE_TOKEN') {
      const { success, token, error, promiseId } = messageData ?? {};
      if (pendingTokenPromises[promiseId]) {
        if (success) {
          pendingTokenPromises[promiseId].resolve(token);
        } else {
          pendingTokenPromises[promiseId].reject(new Error(error || 'Token refresh failed from host.'));
        }
        delete pendingTokenPromises[promiseId];
      }
    }
  });

  // Expose a function for the Generated App to request a new Firebase token
  window.requestNewFirebaseToken = function() {
    const currentPromiseId = nextTokenPromiseId++;
    const promise = new Promise((resolve, reject) => {
      pendingTokenPromises[currentPromiseId] = { resolve, reject };
    });
    if (window.parent && window.parent !== window) {
      window.parent.postMessage({
        type: 'REQUEST_NEW_FIREBASE_TOKEN',
        promiseId: currentPromiseId
      }, '*');
    } else {
      pendingTokenPromises[currentPromiseId].reject(new Error('No parent window to request token from.'));
      delete pendingTokenPromises[currentPromiseId];
    }
    return promise;
  };
})();</script><script>
let realOriginalGetUserMedia = null;
if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
  realOriginalGetUserMedia = navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);
}

(function() {
  if (navigator.mediaDevices && navigator.mediaDevices.__proto__) {
    try {
      Object.defineProperty(navigator.mediaDevices.__proto__, 'getUserMedia', {
        get: function() {
          return undefined; // Or throw an error
        },
        configurable: false
      });
    } catch (error) {
      console.error("Error defining prototype getter:", error);
    }
  }
})();

(function() {
  const pendingMediaResolvers = {};
  let nextMediaPromiseId = 0;

  function requestMediaPermissions(constraints) {
    const mediaPromiseId = nextMediaPromiseId++;
    const promise = new Promise((resolve, reject) => {
      pendingMediaResolvers[mediaPromiseId] = (granted) => {
        delete pendingMediaResolvers[mediaPromiseId];
        resolve(granted);
      };
    });

    window.parent.postMessage({
      type: 'requestMediaPermission',
      constraints: constraints,
      promiseId: mediaPromiseId,
    }, '*');

    return promise;
  }

  let originalGetUserMedia = realOriginalGetUserMedia;

  function interceptGetUserMedia() {
    if (navigator.mediaDevices) {
      Object.defineProperty(navigator.mediaDevices, 'getUserMedia', {
        value: function(constraints) {
          return requestMediaPermissions(constraints).then((granted) => {
            if (granted) {
              if (originalGetUserMedia) {
                return originalGetUserMedia(constraints);
              } else {
                throw new Error("Original getUserMedia not available.");
              }
            } else {
              throw new DOMException('Permission denied', 'NotAllowedError');
            }
          });
        },
        writable: false,
        configurable: false
      });
    }
  }

  interceptGetUserMedia();

  const observer = new MutationObserver(function(mutationsList, observer) {
    for (const mutation of mutationsList) {
      if (mutation.type === 'reconfigured' && mutation.name === 'getUserMedia' && mutation.object === navigator.mediaDevices) {
        interceptGetUserMedia();
      } else if (mutation.type === 'attributes' && mutation.attributeName === 'getUserMedia' && mutation.target === navigator.mediaDevices) {
        interceptGetUserMedia();
      } else if (mutation.type === 'childList' && mutation.addedNodes) {
        mutation.addedNodes.forEach(node => {
          if (node === navigator.mediaDevices) {
            interceptGetUserMedia();
          }
        });
      }
    }
  });

  function interceptSpeechRecognition() {
    if (!window.SpeechRecognition && !window.webkitSpeechRecognition) {
      return;
    }

    const OriginalSpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;

    const SpeechRecognitionWrapper = function(...args) {
      const recognizer = new OriginalSpeechRecognition(...args);
      const originalStart = recognizer.start.bind(recognizer);

      recognizer.start = function() {
        requestMediaPermissions({ audio: true }).then(granted => {
          if (granted) {
            originalStart();
          } else {
            const errorEvent = new SpeechRecognitionErrorEvent('error');
            errorEvent.error = 'not-allowed'; // This is the standard error for permission denial.
            recognizer.dispatchEvent(errorEvent);
          }
        });
      };

      return recognizer;
    };

    SpeechRecognitionWrapper.prototype = OriginalSpeechRecognition.prototype;
    SpeechRecognitionWrapper.prototype.constructor = SpeechRecognitionWrapper;

    if (window.SpeechRecognition) {
      window.SpeechRecognition = SpeechRecognitionWrapper;
    }
    if (window.webkitSpeechRecognition) {
      window.webkitSpeechRecognition = SpeechRecognitionWrapper;
    }
  }

  interceptSpeechRecognition();

  window.addEventListener('message', function(event) {
    if (event.data) {
      if (event.data.type === 'resolveMediaPermission') {
        const { promiseId, granted } = event.data;
        if (pendingMediaResolvers[promiseId]) {
          pendingMediaResolvers[promiseId](granted);
        }
      }
    }
  });

})();</script><script>((function(modelInformation) {
  const originalFetch = window.fetch;
  // TODO: b/421908508 - Move these out of the script and match all generative AI model calls.
  let googleLlmBaseApiUrls = [
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.textModelName + ':streamGenerateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.textModelName + ':generateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageModelName + ':predict',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageModelName + ':predictLongRunning',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageEditModelName + ':generateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageTransformModelName + ':generateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.videoModelName + ':predict',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.videoModelName + ':predictLongRunning',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.ttsModelName + ':generateContent',
  ];
  modelInformation.deprecatedTextModelNames.forEach((modelName) => {
    googleLlmBaseApiUrls.push(
      'https://generativelanguage.googleapis.com/v1beta/models/' + modelName + ':streamGenerateContent',
      'https://generativelanguage.googleapis.com/v1beta/models/' + modelName + ':generateContent',
    );
  });
  modelInformation.deprecatedImageModelNames.forEach((modelName) => {
    googleLlmBaseApiUrls.push(
      'https://generativelanguage.googleapis.com/v1beta/models/' + modelName + ':predict',
      'https://generativelanguage.googleapis.com/v1beta/models/' + modelName + ':predictLongRunning',
    );
  });

  const pendingFetchResolvers = {};
  let nextPromiseId = 0;

  function handleStringInput(input, optionsArgument) {
    const actualUrl = input;
    const fetchCallArgs = [actualUrl, optionsArgument];
    const effectiveOptions = optionsArgument || {};
    const bodyForApiKeyCheck = effectiveOptions.body;
    const bodyForPostMessage = effectiveOptions.body;
    return { actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage };
  }

  function handleRequestInput(input, optionsArgument) {
    const actualUrl = input.url;
    const fetchCallArgs = [input, optionsArgument];
    const effectiveOptions = { method: input.method, headers: new Headers(input.headers) };
    let bodyForApiKeyCheck;
    let bodyForPostMessage;

    if (optionsArgument) {
      if (optionsArgument.method) effectiveOptions.method = optionsArgument.method;
      if (optionsArgument.headers) effectiveOptions.headers = new Headers(optionsArgument.headers);
      if ('body' in optionsArgument) {
        bodyForApiKeyCheck = optionsArgument.body;
        bodyForPostMessage = optionsArgument.body;
      } else {
        bodyForApiKeyCheck = undefined;
        bodyForPostMessage = input.body;
      }
    } else {
      bodyForApiKeyCheck = undefined;
      bodyForPostMessage = input.body;
    }
    return { actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage };
  }

  window.fetch = function(input, optionsArgument) {
    let actualUrl;
    let fetchCallArgs;
    let effectiveOptions = {};
    let bodyForApiKeyCheck;
    let bodyForPostMessage;

    if (typeof input === 'string') {
      ({actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage} = handleStringInput(input, optionsArgument));
    } else if (input instanceof Request) {
      ({actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage} = handleRequestInput(input, optionsArgument));
    } else {
      return originalFetch.apply(window, [input, optionsArgument]);
    }

    effectiveOptions.method = effectiveOptions.method || 'GET';
    if (!effectiveOptions.headers) {
      effectiveOptions.headers = new Headers();
    }


    if (typeof actualUrl === 'string' && googleLlmBaseApiUrls.some((url) => actualUrl.startsWith(url))) {
      let apiKeyIsNull = true;

      const regex = new RegExp("models/([^:]+)");
      const modelNameMatch = actualUrl.match(regex);
      const modelName = modelNameMatch ? modelNameMatch[1] : 'unspecified';


      try {
        const urlObject = new URL(actualUrl);  // Use URL object for robust parsing
        const apiKeyParam = urlObject.searchParams.get('key');
        if (apiKeyParam) {
          apiKeyIsNull = false;
        }
      } catch (e) {
        // Continue checks even if URL parsing fails
      }

      if (apiKeyIsNull && effectiveOptions.headers) {
        const h = new Headers(effectiveOptions.headers);
        const apiKeyHeaderValue = h.get('X-API-Key') || h.get('x-api-key');
        if (apiKeyHeaderValue) {
          apiKeyIsNull = false;
          return originalFetch.apply(window, fetchCallArgs);
        }
      }

      if (apiKeyIsNull && effectiveOptions.method && ['POST', 'PUT', 'PATCH'].includes(effectiveOptions.method.toUpperCase()) && typeof bodyForApiKeyCheck === 'string') {
        try {
          const bodyData = JSON.parse(bodyForApiKeyCheck);
          if (bodyData && bodyData.apiKey) {
            apiKeyIsNull = false;
            return originalFetch.apply(window, fetchCallArgs);
          }
        } catch (e) {
          // Ignore JSON parsing errors
        }
      }

      if(apiKeyIsNull) {
        const promiseId = nextPromiseId++;
        const promise = new Promise((resolve) => {
          pendingFetchResolvers[promiseId] = (resolvedResponse) => {
            delete pendingFetchResolvers[promiseId];
            resolve(resolvedResponse);
          };
        });

        let serializedBodyForPostMessage;
        if (typeof bodyForPostMessage === 'string' || bodyForPostMessage == null) {
            serializedBodyForPostMessage = bodyForPostMessage;
        } else if (bodyForPostMessage instanceof ReadableStream) {
            serializedBodyForPostMessage = null;
        } else {
            try {
                serializedBodyForPostMessage = JSON.stringify(bodyForPostMessage);
            } catch (e) {
                serializedBodyForPostMessage = null;
            }
        }

        const messageOptions = {
            method: effectiveOptions.method,
            headers: Object.fromEntries(new Headers(effectiveOptions.headers).entries()),
            body: serializedBodyForPostMessage
        };

        window.parent.postMessage({
          type: 'requestFetch',
          url: actualUrl,
          modelName: modelName,
          options: messageOptions,
          promiseId: promiseId,
        }, '*');

        return promise;
      }
      return originalFetch.apply(window, fetchCallArgs);
    }
    return originalFetch.apply(window, fetchCallArgs);
  };

  window.addEventListener('message', function(event) {
    if (event.data && event.data.type === 'resolveFetch') {
      const { promiseId, response } = event.data;
      if (pendingFetchResolvers[promiseId]) {
        try {
          const reconstructedResponse = new Response(response.body, {
            status: response.status,
            statusText: response.statusText,
            headers: new Headers(response.headers),
          });
          pendingFetchResolvers[promiseId](reconstructedResponse);
        } catch (error) {
          pendingFetchResolvers[promiseId](new Response(null, { status: 500, statusText: "Interceptor Response Reconstruction Error" }));
        }
      }
    }
  });

}))({"textModelName":"gemini-2.5-flash-preview-09-2025","imageModelName":"imagen-4.0-generate-001","imageEditModelName":"gemini-2.5-flash-image-preview","imageTransformModelName":"gemini-2.5-flash-image-preview","videoModelName":"veo-2.0-generate-001","ttsModelName":"gemini-2.5-flash-preview-tts","deprecatedTextModelNames":["gemini-2.0-flash","gemini-2.5-flash-preview-04-17","gemini-2.5-flash-preview-05-20"],"deprecatedImageModelNames":["imagen-3.0-generate-001","imagen-3.0-generate-002"]})</script><script>(function() {
  const originalConsoleLog = console.log;
  const originalConsoleError = console.error;

    /**
   * Normalizes an error event or a promise rejection reason into a structured error object.
   * @param {*} errorEventOrReason The error object or reason.
   * @return {object} Structured error data { message, name, stack }.
   */
  function getErrorObject(errorEventOrReason) {
    if (errorEventOrReason instanceof Error) {
      return {
        message: errorEventOrReason.message,
        name: errorEventOrReason.name,
        stack: errorEventOrReason.stack,
      };
    }
    // Fallback for non-Error objects.
    try {
      return {
        message: JSON.stringify(errorEventOrReason),
        name: 'UnknownErrorType',
        stack: null,
      };
    } catch (e) {
      return {
        message: String(errorEventOrReason),
        name: 'UnknownErrorTypeNonStringifiable',
        stack: null,
      };
    }
  }

  /**
   * Converts an array of arguments (from log/error) into a single string.
   * Handles Error objects specially to include their message and stack.
   * @param {Array<*>} args - Arguments passed to console methods.
   * @return {string} A string representation of the arguments.
   */
  function stringifyArgs(args) {
    return args
      .map((arg) => {
        if (arg instanceof Error) {
          const {message, stack} = arg;
          return `Error: ${message}${stack ? ('\nStack: ' + stack) : ''}`;
        }
        if (typeof arg === 'object' && arg !== null) {
          try {
            return JSON.stringify(arg);
          } catch (error) {
            return '[Circular Object]';
          }
        } else {
          return String(arg);
        }
      })
      .join(' ');
  }

  console.log = function(...args) {
    const logString = stringifyArgs(args);
    window.parent.postMessage({ type: 'log', message: logString }, '*');
    originalConsoleLog.apply(console, args);
  };

  console.error = function(...args) {
    let errorData;
    if (args.length > 0 && args[0] instanceof Error) {
      const err = args[0];
      // If the first arg is an Error, capture its details.
      errorData = {
        type: 'error',
        source: 'CONSOLE_ERROR',
        ...getErrorObject(err),
        rawArgsString: stringifyArgs(args.slice(1)),
        timestamp: new Date().toISOString(),
      };
    } else {
      // If not an Error object, treat all args as a general error message.
      errorData = {
        type: 'error',
        source: 'CONSOLE_ERROR',
        message: stringifyArgs(args),
        name: 'ConsoleLoggedError',
        stack: null,
        timestamp: new Date().toISOString(),
      };
    }
    window.parent.postMessage(errorData, '*');
    originalConsoleError.apply(console, args);
  };

  // Listen for global unhandled synchronous errors.
  window.addEventListener('error', function(event) {
    const errorDetails = event.error ? getErrorObject(event.error) : {
      message: event.message,
      name: 'GlobalError',
      stack: null,
      filename: event.filename,
      lineno: event.lineno,
      colno: event.colno,
    };

    window.parent.postMessage({
      type: 'error',
      source: 'global',
      ...errorDetails,
      message: errorDetails.message || event.message,
      timestamp: new Date().toISOString(),
    }, '*');
  });

  // Listen for unhandled promise rejections (asynchronous errors).
  window.addEventListener('unhandledrejection', function(event) {
    const errorDetails = getErrorObject(event.reason);

    window.parent.postMessage({
      type: 'error',
      source: 'unhandledrejection',
      ...errorDetails,
      message: errorDetails.message || 'Unhandled Promise Rejection',
      timestamp: new Date().toISOString(),
    }, '*');
  });

})();</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2025年11月22日 金融市場日報|洞察•解構•透視全球資產</title>
    <meta name="description" content="2025年11月22日 金融市場日報|洞察•解構•透視全球資產">

    <style>
        /* 系統字體堆疊 */
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Noto Sans TC", Roboto, "Helvetica Neue", Arial, sans-serif;
            background: #f8fafc;
            line-height: 1.6;
            color: #1e293b;
            margin: 0;
            padding: 0;
        }

        /* 標題階層 */
        .main-title {
            font-size: 2.5rem;
            font-weight: 700;
            color: #1e293b;
            text-align: center;
            margin-bottom: 0.5rem;
            background: linear-gradient(to right, #4f46e5, #ec4899);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .sub-title {
            font-size: 3.125rem;
            font-weight: 600;
            color: #2563eb;
            text-align: center;
            margin-top: 0.5rem;
            display: block;
            margin-left: auto;
            margin-right: auto;
        }

        @media (max-width: 768px) {
            .main-title { font-size: 1.5rem; }
            .sub-title { font-size: 1.875rem; }
        }

        /* 章節與容器 */
        section { scroll-margin-top: 120px; }
        h2 {
            font-size: 1.5rem;
            font-weight: 700;
            margin: 0.5rem 0 1.5rem 0;
            display: flex;
            align-items: center;
        }
        h3.table-title {
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: 1rem;
            text-align: left;
            color: #374151;
        }

        .container {
            max-width: 80rem;
            margin: 0 auto;
            padding: 1rem;
        }
        @media (min-width: 768px) {
            .container { padding: 2rem; }
        }

        /* 表格樣式 */
        .table-styled {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            margin: 1rem 0;
        }
        .table-styled caption {
            padding: 1rem;
            font-weight: 600;
            text-align: left;
            background: #f8fafc;
            border-bottom: 1px solid #e2e8f0;
            caption-side: top;
        }
        .table-styled thead th {
            background: #f1f5f9;
            padding: 0.75rem;
            font-weight: 600;
            color: #374151;
            border-bottom: 2px solid #e5e7eb;
            position: sticky;
            top: 0;
            text-align: center;
        }
        .table-styled thead th:first-child {
            text-align: left;
        }
        .table-styled tbody td {
            padding: 0.75rem;
            border-bottom: 1px solid #f1f5f9;
            font-weight: 400;
            text-align: center;
        }
        .table-styled tbody td:first-child {
            text-align: left;
            font-weight: 500;
        }
        .table-styled tbody td strong {
             font-weight: normal !important;
        }
         .table-styled tbody tr.summary-row td {
            font-weight: 600 !important;
            border-top: 2px solid #e5e7eb;
         }


        /* 漲跌顏色 */
        .text-up { color: #dc2626; font-weight: 600; }
        .text-down { color: #059669; font-weight: 600; }
        .text-flat { color: #6b7280; font-weight: 500; }

        /* 熱度條 */
        .heat-container {
            margin: 1rem 0;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        .heat-item {
            display: flex;
            align-items: center;
            background: #f1f5f9;
            border-radius: 8px;
            overflow: hidden;
            position: relative;
            height: 2.5rem;
        }
        .heat-bar {
            display: flex;
            align-items: center;
            justify-content: flex-start;
            padding: 0.5rem 1rem;
            font-weight: 700;
            font-size: 1rem;
            color: white;
            height: 100%;
            border-radius: 8px 0 0 8px;
            transition: all 0.3s ease;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .heat-bar-1 { background: #dc2626; width: 100%; border-radius: 8px; }
        .heat-bar-2 { background: #dc2626; width: 92%; }
        .heat-bar-3 { background: #ea580c; width: 84%; }
        .heat-bar-4 { background: #ea580c; width: 76%; }
        .heat-bar-5 { background: #d97706; width: 68%; }
        .heat-bar-6 { background: #d97706; width: 60%; }
        .heat-bar-7 { background: #eab308; width: 52%; color: #1f2937; }
        .heat-bar-8 { background: #eab308; width: 44%; color: #1f2937; }
        .heat-bar-9 { background: #84cc16; width: 36%; color: #1f2937; }
        .heat-bar-10 { background: #84cc16; width: 28%; color: #1f2937; }

        /* 卡片 */
        .section-card {
            background: white;
            border-radius: 16px;
            padding: 2rem;
            margin: 2rem 0;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            border-left: 4px solid transparent;
            transition: all 0.3s ease;
        }
        .section-card:first-child { margin-top: 0.5rem; }
        .section-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
            border-left-color: #4f46e5;
        }

        /* 導覽列 */
        .nav-sticky {
            position: sticky;
            top: 0;
            z-index: 50;
            background: rgba(255, 255, 255, 0.95);
            border-bottom: 1px solid #e2e8f0;
            padding: 1rem;
            backdrop-filter: blur(8px);
        }
        .nav-content {
            max-width: 80rem;
            margin: 0 auto;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow-x: auto;
            scroll-behavior: smooth;
            scrollbar-width: none;
        }
        .nav-content::-webkit-scrollbar { display: none; }
        .nav-links-group {
            display: flex;
            gap: 1rem;
            font-size: 0.875rem;
            white-space: nowrap;
            align-items: center;
            min-width: fit-content;
        }
        .nav-links-group a {
            padding: 0.5rem 1rem;
            border-radius: 8px;
            text-decoration: none;
            background: #dc2626;
            color: white;
            font-weight: 700;
            transition: all 0.2s ease;
            white-space: nowrap;
            flex-shrink: 0;
        }
        .nav-links-group a:hover {
            background: #b91c1c;
            transform: translateY(-1px);
        }
        .nav-links-group .download-btn {
            background: #059669;
            color: white;
            border: none;
            border-radius: 8px;
            padding: 0.5rem 1rem;
            font-size: 0.875rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            white-space: nowrap;
            flex-shrink: 0;
        }
        .nav-links-group .download-btn:hover {
            background: #047857;
            transform: translateY(-1px);
        }

        /* 時間軸標籤 */
        .timeline-tag {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-right: 0.75rem;
            vertical-align: top;
        }
        .timeline-tag-taiwan { background: #f1f5f9; color: #1e293b; }
        .timeline-tag-us { background: #f1f5f9; color: #dc2626; }
        .timeline-container p {
            margin: 0;
            padding: 0.125rem 0;
            line-height: 1.4;
        }

        /* 深度分析格式 */
        .analysis-block {
            background: #fffbeb;
            border-left: 4px solid #f59e0b;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 8px;
        }
        .analysis-block h4 {
            font-weight: 600;
            color: #92400e;
            margin-bottom: 1rem;
            font-size: 1.125rem;
        }
        .structured-analysis p {
            line-height: 1.75;
            margin-bottom: 1rem;
        }
        .structured-analysis p:last-child {
            margin-bottom: 0;
        }
        .structured-analysis strong {
             display: inline;
             margin-right: 0.5em;
             color: #92400e;
             font-size: 1rem;
             font-weight: 700;
        }
         .structured-analysis br {
            display: none;
         }

        /* 市場數據卡片 */
        .market-overview-custom { margin: 1.5rem 0; }
        .market-overview-row-1 {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }
        .grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }
        .grid-cols-1 { grid-template-columns: repeat(1, minmax(0, 1fr)); }
        @media (min-width: 1024px) {
          .lg\:grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }
        }

        .market-overview-row-2 {
            display: grid;
            grid-template-columns: 1fr 3fr;
            gap: 1.5rem;
        }
        .market-card-new {
            background: white;
            border-radius: 12px;
            padding: 1.25rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            transition: all 0.2s ease;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            min-height: 120px;
        }
        .market-card-new:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }
        .market-card-new.us-stock { border-left: 4px solid #dc2626; }
        .market-card-new.tw-stock { border-left: 4px solid #059669; }
        .market-card-new.bond { border-left: 4px solid #2563eb; }
        .market-card-new.commodity { border-left: 4px solid #f59e0b; }
        .market-card-new.fx { border-left: 4px solid #0891b2; }
        .market-card-title-new {
            font-size: 0.875rem;
            font-weight: 600;
            color: #6b7280;
            margin-bottom: 0.5rem;
        }
        .market-card-value-new {
            font-size: 1.125rem;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 0.5rem;
        }
         .market-card-value-new strong { font-weight: 700 !important; }
        .market-card-change-new {
            font-size: 0.75rem;
            font-weight: 500;
            margin-top: auto;
        }
         .market-card-change-new strong { font-weight: bold !important; }

        /* Analysis Table */
        .analysis-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            margin: 1rem 0;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            border-spacing: 0;
            table-layout: fixed;
        }
        .analysis-table th:first-child, .analysis-table td:first-child {
            width: 30%;
            padding-left: 0.75rem;
            vertical-align: top;
        }
        .analysis-table th:last-child, .analysis-table td:last-child {
            width: 70%;
            padding-right: 0.75rem;
            vertical-align: top;
        }
        .analysis-table td {
            padding-top: 0.75rem;
            padding-bottom: 0.75rem;
            border-bottom: 1px solid #f1f5f9;
            word-wrap: break-word;
            text-align: left;
            font-weight: 400 !important;
        }
        .analysis-table th {
            background: #f8fafc;
            padding-top: 0.75rem;
            padding-bottom: 0.75rem;
            font-weight: 600;
            text-align: left;
            color: #374151;
        }
        .analysis-table td strong { font-weight: normal !important; }
        .analysis-table .font-semibold { font-weight: 600 !important; }

        /* 個股推薦卡片 */
        .stock-recommendation {
            background: white;
            border-radius: 12px;
            padding: 2rem;
            margin: 2rem 0;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        .stock-recommendation.bullish { border-left: 4px solid #059669; }
        .stock-recommendation.bearish { border-left: 4px solid #dc2626; }
        .recommendation-title {
            font-size: 1.125rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
        }
        .recommendation-title.bullish { color: #059669; }
        .recommendation-title.bearish { color: #dc2626; }

        /* Link Buttons */
        .link-button-container {
             display: flex;
             flex-direction: column;
             gap: 0.5rem;
             width: 100%;
             align-items: flex-start;
        }
        .link-button {
            display: block;
            padding: 0.6rem 0.8rem;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.2s ease;
            text-align: center;
            width: 95%;
            max-width: 150px;
            margin: 0;
            font-size: 0.875rem;
            box-sizing: border-box;
        }
        .link-button.fundamental { background: #2563eb; color: white; }
        .link-button.fundamental:hover { background: #1d4ed8; }
        .link-button.technical { background: #374151; color: white; }
        .link-button.technical:hover { background: #111827; }
        .link-button-subtitle {
            display: block;
            font-size: 0.75rem;
            font-weight: 400;
            opacity: 0.9;
            margin-top: 0.25rem;
        }

        /* 回頂按鈕 */
        .back-to-top {
            position: fixed;
            left: 1.5rem;
            bottom: 1.5rem;
            background: #4f46e5;
            color: white;
            border: none;
            border-radius: 50%;
            width: 48px;
            height: 48px;
            font-size: 1.125rem;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 40;
            transition: all 0.2s ease;
        }
        .back-to-top:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
        }

        /* 進度條 */
        .progress-bar {
            height: 3px;
            background: #4f46e5;
            position: fixed;
            top: 0;
            left: 0;
            z-index: 100;
            transition: width 0.3s ease;
        }

        /* 網格佈局 (通用) */
        .grid { display: grid; }
        .gap-8 { gap: 2rem; }

        /* TL;DR區塊 */
        .tldr-block {
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1.5rem;
        }
        .tldr-block ul {
            list-style: none;
            padding: 0;
            margin: 0;
            font-size: 1rem;
        }
        .tldr-block li {
            margin: 0.75rem 0;
            padding-left: 1rem;
            position: relative;
        }
        .tldr-block li::before {
            content: "•";
            position: absolute;
            left: 0;
            font-weight: 700;
        }
         .tldr-block li strong {
            font-weight: 700 !important;
         }

        /* 響應式 */
        @media (max-width: 1024px) {
            .market-overview-row-1 { grid-template-columns: repeat(2, 1fr); }
        }
        @media (max-width: 768px) {
            .grid-cols-2, .lg\:grid-cols-2 { grid-template-columns: 1fr; }
            .market-overview-row-1,
            .market-overview-row-2 { grid-template-columns: 1fr; }
            .back-to-top { left: 1rem; bottom: 5rem; }
            .analysis-table th:first-child, .analysis-table td:first-child {
                width: 40%;
            }
            .analysis-table th:last-child, .analysis-table td:last-child {
                width: 60%;
            }

            .nav-content {
                justify-content: flex-start;
                padding-left: 0.5rem;
                padding-right: 0.5rem;
            }
            .nav-links-group { gap: 0.75rem; }
        }

        /* 工具類 */
        .text-center { text-align: center; }
        .text-right { text-align: right; }
        .font-semibold { font-weight: 600; }
        .text-xs { font-size: 0.75rem; }
        .mt-4 { margin-top: 1rem; }
        .overflow-x-auto { overflow-x: auto; }

        @media print {
            .nav-sticky, .back-to-top, .download-btn, .progress-bar { display: none; }
        }
    </style>
</head>
<body>

<!-- 進度條 -->
<div class="progress-bar" id="progressBar" style="width: 0%; opacity: 0; transition: opacity 0.5s ease-out; display: none;"></div>

<!-- 導覽工具列 -->
<div class="nav-sticky">
    <div class="nav-content">
        <div class="nav-links-group">
            <a href="#sec-1">市場總覽</a>
            <a href="#sec-2">歐美股市</a>
            <a href="#sec-3">債券市場</a>
            <a href="#sec-4">大宗商品</a>
            <a href="#sec-5">台股解析</a>
            <a href="#sec-6">匯率市場</a>
            <a href="#sec-7">產業展望</a>
            <button class="download-btn" id="smartDownloadBtn">🔥 下載日報</button>
        </div>
    </div>
</div>

<div class="container">

    <!-- 標題 -->
    <header style="text-align: center; margin: 0;">
        <h1 class="main-title" style="margin: 0; margin-bottom: 0.125rem;">2025年11月22日 金融市場日報</h1>
        <p class="sub-title" style="margin: 0;">費半反彈引領科技股回神,台股重挫外資賣超九百億</p>
    </header>

    <!-- 第1章:市場總覽與重點 -->
    <section id="sec-1" class="section-card">
        <h2 style="color: #015fb4;"><span style="margin-right: 0.75rem;">📋</span>第1章｜市場總覽與重點</h2>

        <div class="tldr-block" style="background: #f0f9ff;">
            <h3 class="table-title">市場三大要點</h3>
            <ul>
                <li style="color: #015fb4;"><strong>Fed降息預期：</strong>官員釋出鴿派訊號，12月降息機率上升，提振美股表現。</li>
                <li style="color: #015fb4;"><strong>台股資金外流：</strong>外資單日賣超逾九百億元，權值股遭提款，指數大跌。</li>
                <li style="color: #015fb4;"><strong>加密貨幣修正：</strong>比特幣跌破八萬美元，市場風險偏好降溫，資金轉向避險。</li>
            </ul>
        </div>

        <div class="market-overview-custom">
            <h3 class="table-title">市場核心數據速覽</h3>
            <div class="market-overview-row-1">
                <div class="market-card-new us-stock">
                    <div class="market-card-title-new">美股市場</div>
                    <div class="market-card-value-new">標普500 <strong>6,602.99</strong></div>
                    <div class="market-card-change-new text-up">▲ <strong>+0.98%</strong> • 降息預期重燃，指數收紅。</div>
                </div>
                <div class="market-card-new tw-stock">
                    <div class="market-card-title-new">台股市場</div>
                    <div class="market-card-value-new">加權 <strong>26,434.94</strong></div>
                    <div class="market-card-change-new text-down">▼ <strong>-3.61%</strong> • 外資大賣915億，指數大跌。</div>
                </div>
                <div class="market-card-new bond">
                    <div class="market-card-title-new">債券市場</div>
                    <div class="market-card-value-new">10年期殖利率 <strong>4.06%</strong></div>
                    <div class="market-card-change-new text-down">▼ <strong>-4.3 bps</strong> • 官員談話偏鴿，殖利率回落。</div>
                </div>
                <div class="market-card-new commodity">
                    <div class="market-card-title-new">大宗商品</div>
                    <div class="market-card-value-new">黃金期貨 <strong>4,062.80</strong></div>
                    <div class="market-card-change-new text-up">▲ <strong>+0.16%</strong> • 避險需求支撐，布蘭特 -2.92%。</div>
                </div>
            </div>
            <div class="market-overview-row-2">
                <div class="market-card-new fx">
                    <div class="market-card-title-new">匯率市場</div>
                    <div class="market-card-value-new">美元指數 <strong>100.20</strong></div>
                    <div class="market-card-change-new text-up">▲ <strong>+0.04%</strong> • 數據錯綜複雜，美元高檔震盪。</div>
                </div>
                <div></div>
            </div>
        </div>

         <!-- --- v3.1.3 修正: 並排斷點改為 lg --- -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <div>
                <h3 class="table-title">Top 10 市場熱點事件榜</h3>
                <div class="heat-container">
                    <div class="heat-item"><div class="heat-bar heat-bar-1">Fed官員放鴿</div></div>
                    <div class="heat-item"><div class="heat-bar heat-bar-2">台股大跌失守</div></div>
                    <div class="heat-item"><div class="heat-bar heat-bar-3">外資賣超九百億</div></div>
                    <div class="heat-item"><div class="heat-bar heat-bar-4">比特幣跌破八萬</div></div>
                    <div class="heat-item"><div class="heat-bar heat-bar-5">俄烏和平協議</div></div>
                    <div class="heat-item"><div class="heat-bar heat-bar-6">油價跌至低點</div></div>
                    <div class="heat-item"><div class="heat-bar heat-bar-7">輝達股價翻紅</div></div>
                    <div class="heat-item"><div class="heat-bar heat-bar-8">谷歌AI算力</div></div>
                    <div class="heat-item"><div class="heat-bar heat-bar-9">亞馬遜大裁員</div></div>
                    <div class="heat-item"><div class="heat-bar heat-bar-10">日圓反彈升值</div></div>
                </div>
                <p class="text-xs" style="color: #64748b; margin-top: 0.5rem;">*熱度基於過去24小時新聞與社群討論量標準化</p>
            </div>
            <div>
                <h3 class="table-title">市場關鍵時間軸</h3>
                <div class="structured-analysis space-y-4 timeline-container">
                    <p><span class="timeline-tag timeline-tag-taiwan">台股盤前</span> 08:45 日股開盤受美股科技股回檔影響呈現大跌,半導體族群賣壓湧現,顯著拖累整體亞股早盤投資氣氛。</p>
                    <p><span class="timeline-tag timeline-tag-taiwan">台股盤中</span> 台股盤中權值股全線走弱,台積電遭外資大舉調節,加權指數跌幅擴大。</p>
                    <p><span class="timeline-tag timeline-tag-taiwan">台股盤中</span> 傳出中國加強對日本實施反制措施,地緣政治風險升溫,亞幣普遍承壓走貶。</p>
                    <p><span class="timeline-tag timeline-tag-taiwan">台股盤後</span> 14:30 台股收盤大跌九百九十一點,外資單日賣超九百一十五億元,創下今年以來單日最大賣超金額紀錄。</p>
                    <p><span class="timeline-tag timeline-tag-taiwan">台股盤後</span> 16:00 央行關注匯市波動,台幣兌美元貶破三十一點四關卡,創近期收盤新低價位。</p>
                    <p><span class="timeline-tag timeline-tag-us">美股盤前</span> 20:30 美國上週初領失業金人數降至二十一點三萬人,數據低於市場預期,顯示勞動力市場仍具備強勁韌性。</p>
                    <p><span class="timeline-tag timeline-tag-us">美股盤中</span> 聯準會官員柯林斯表示利率暫時適宜,若就業明顯轉弱需降息,市場解讀偏向鴿派。</p>
                    <p><span class="timeline-tag timeline-tag-us">美股盤中</span> 比特幣盤中出現劇烈波動,價格一度跌破八萬美元關卡,加密貨幣市場賣壓湧現。</p>
                    <p><span class="timeline-tag timeline-tag-us">美股盤中</span> 媒體報導美國政府積極推動俄烏和平協議,市場預期地緣政治緊張局勢有望緩解,拖累國際油價走跌。</p>
                    <p><span class="timeline-tag timeline-tag-us">美股盤後</span> 05:00 美股收盤道瓊上漲逾四百點,市場預期十二月降息機率升溫,科技股尾盤回神。</p>
                </div>
            </div>
        </div>
    </section>

    <!-- 第2章:歐美股市 -->
    <section id="sec-2" class="section-card">
        <h2 style="color: #dc2626;"><span style="margin-right: 0.75rem;">📈</span>第2章｜歐美股市</h2>

        <div class="tldr-block" style="background: #fef2f2;">
            <ul>
                <li style="color: #dc2626;"><strong>降息預期重燃：</strong>Fed官員柯林斯等暗示12月降息可能性增加，市場情緒轉趨樂觀，道瓊指數上漲1.08%，終止連日跌勢。</li>
                <li style="color: #dc2626;"><strong>科技股波動加劇：</strong>輝達財報後多空交戰，股價先跌後漲，但費半指數仍上漲0.86%，市場對AI泡沫的擔憂與期待並存。</li>
                <li style="color: #dc2626;"><strong>加密貨幣修正：</strong>比特幣跌破八萬美元關卡，單日大跌10%，風險偏好降溫，部分資金可能回流至傳統防禦性資產。</li>
            </ul>
        </div>

        <h3 class="table-title">歐美主要股市行情</h3>
        <div class="overflow-x-auto">
            <table class="table-styled">
                <caption>歐美主要股市指數漲跌概覽</caption>
                <thead>
                    <tr>
                        <th>指標名稱</th>
                        <th>最新收盤價</th>
                        <th>日漲跌</th>
                        <th>五日漲跌</th>
                        <th>月漲跌</th>
                        <th>季漲跌</th>
                        <th>年初至今</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>道瓊工業指數</td>
                        <td><strong>46,245.41</strong></td>
                        <td class="text-up"><strong>+1.08%</strong></td>
                        <td class="text-up"><strong>-2.55%</strong></td>
                        <td class="text-up"><strong>-0.99%</strong></td>
                        <td class="text-down"><strong>+2.91%</strong></td>
                        <td class="text-down"><strong>+8.70%</strong></td>
                    </tr>
                    <tr>
                        <td>標普500</td>
                        <td><strong>6,602.99</strong></td>
                        <td class="text-up"><strong>+0.98%</strong></td>
                        <td class="text-up"><strong>-2.00%</strong></td>
                        <td class="text-up"><strong>-1.96%</strong></td>
                        <td class="text-down"><strong>+3.24%</strong></td>
                        <td class="text-down"><strong>+12.26%</strong></td>
                    </tr>
                    <tr>
                        <td>那斯達克</td>
                        <td><strong>22,273.08</strong></td>
                        <td class="text-up"><strong>+0.88%</strong></td>
                        <td class="text-up"><strong>-2.61%</strong></td>
                        <td class="text-up"><strong>-3.12%</strong></td>
                        <td class="text-down"><strong>+5.20%</strong></td>
                        <td class="text-down"><strong>+15.34%</strong></td>
                    </tr>
                    <tr>
                        <td>費城半導體指數</td>
                        <td><strong>6,406.43</strong></td>
                        <td class="text-up"><strong>+0.86%</strong></td>
                        <td class="text-up"><strong>-6.05%</strong></td>
                        <td class="text-up"><strong>-6.95%</strong></td>
                        <td class="text-down"><strong>+13.77%</strong></td>
                        <td class="text-down"><strong>+28.65%</strong></td>
                    </tr>
                    <tr>
                        <td>羅素2000</td>
                        <td><strong>2,369.59</strong></td>
                        <td class="text-down"><strong>+2.80%</strong></td>
                        <td class="text-up"><strong>-0.56%</strong></td>
                        <td class="text-up"><strong>-5.21%</strong></td>
                        <td class="text-down"><strong>+4.42%</strong></td>
                        <td class="text-down"><strong>+6.25%</strong></td>
                    </tr>
                    <tr>
                        <td>道瓊歐洲50</td>
                        <td><strong>5,515.09</strong></td>
                        <td class="text-up"><strong>-0.98%</strong></td>
                        <td class="text-up"><strong>-3.96%</strong></td>
                        <td class="text-up"><strong>-2.92%</strong></td>
                        <td class="text-down"><strong>+0.78%</strong></td>
                        <td class="text-down"><strong>+13.26%</strong></td>
                    </tr>
                </tbody>
            </table>
        </div>
        <p class="text-xs text-right" style="color: #64748b; margin-top: 0.5rem;">資料來源: Yahoo Finance</p>

        <!-- --- v3.1.9 替換: 深度分析區塊使用 v2.8 格式 --- -->
        <div class="analysis-block">
            <h4>深度分析:</h4>
            <div class="structured-analysis">
                 <p><strong>Fed鴿派訊號提振信心，美股終止跌勢反彈</strong><br>聯準會官員的鴿派言論成為市場反彈的關鍵催化劑。柯林斯等人暗示若就業市場疲軟將支持降息，加上初領失業金人數顯示勞動力市場雖有韌性但非過熱，市場對12月降息的預期升溫。道瓊指數上漲<strong>1.08%</strong>，標普500上漲<strong>0.98%</strong>，顯示資金在經歷連續修正後，開始回流至估值修正後的優質資產，風險偏好獲得修復。</p>
                 <p><strong>加密貨幣風險釋放，關注輝達後市效應</strong><br>當前最大風險在於加密貨幣市場的劇烈修正。比特幣重挫逾10%跌破八萬美元，顯示投機資金正在撤退，需觀察是否引發流動性風險擴散。關鍵訊號在於VIX指數是否顯著回落，以及10年期美債殖利率能否維持在<strong>4.1%</strong>以下。深層解讀顯示，市場正處於風格轉換期，從純粹的題材炒作轉向關注基本面獲利能力，輝達股價的後續表現將是AI族群能否重啟漲勢的關鍵指標。</p>
            </div>
        </div>
    </section>

    <!-- 第3章:債券市場 -->
    <section id="sec-3" class="section-card">
        <h2 style="color: #2563eb;"><span style="margin-right: 0.75rem;">🏛️</span>第3章｜債券市場</h2>

        <div class="tldr-block" style="background: #eff6ff;">
            <ul>
                <li style="color: #2563eb;"><strong>就業數據拉鋸：</strong>初領失業金人數低於預期，顯示就業市場強勁，限制了殖利率的下行空間，但Fed官員鴿派言論提供支撐。</li>
                <li style="color: #2563eb;"><strong>避險買盤進駐：</strong>股市波動與地緣政治風險促使資金流入債市避險，推動10年期公債殖利率下跌4.3 bps至4.06%。</li>
                <li style="color: #2563eb;"><strong>信用利差穩定：</strong>高收益債ETF(HYG)上漲0.34%，顯示在公債殖利率回落下，市場對企業信用的信心依然穩固。</li>
            </ul>
        </div>

        <h3 class="table-title">主要債券與殖利率行情</h3>
        <div class="overflow-x-auto">
            <table class="table-styled">
                <caption>主要債券與殖利率變動概覽</caption>
                <thead>
                    <tr>
                        <th>指標名稱</th>
                        <th>最新殖利率/價格</th>
                        <th>日變動</th>
                        <th>五日變動</th>
                        <th>月變動</th>
                        <th>季變動</th>
                        <th>年初至今變動</th>
                    </tr>
                </thead>
                <!-- --- v3.1.2 修正: 補齊表格行佔位符 --- -->
                <tbody>
                    <tr>
                        <td>美國3月期殖利率</td>
                        <td><strong>3.74%</strong></td>
                        <td class="text-down"><strong>-3.5 bps</strong></td>
                        <td class="text-down"><strong>-5.3 bps</strong></td>
                        <td class="text-down"><strong>-5.8 bps</strong></td>
                        <td class="text-down"><strong>-37.5 bps</strong></td>
                        <td class="text-down"><strong>-46.8 bps</strong></td>
                    </tr>
                    <tr>
                        <td>美國5年期殖利率</td>
                        <td><strong>3.62%</strong></td>
                        <td class="text-down"><strong>-5.5 bps</strong></td>
                        <td class="text-down"><strong>-8.5 bps</strong></td>
                        <td class="text-up"><strong>+4.0 bps</strong></td>
                        <td class="text-down"><strong>-19.2 bps</strong></td>
                        <td class="text-down"><strong>-76.2 bps</strong></td>
                    </tr>
                    <tr>
                        <td>美國10年期殖利率</td>
                        <td><strong>4.06%</strong></td>
                        <td class="text-down"><strong>-4.3 bps</strong></td>
                        <td class="text-down"><strong>-4.9 bps</strong></td>
                        <td class="text-up"><strong>+7.7 bps</strong></td>
                        <td class="text-down"><strong>-23.3 bps</strong></td>
                        <td class="text-down"><strong>-51.0 bps</strong></td>
                    </tr>
                    <tr>
                        <td>美國30年期殖利率</td>
                        <td><strong>4.72%</strong></td>
                        <td class="text-down"><strong>-1.7 bps</strong></td>
                        <td class="text-up"><strong>+1.3 bps</strong></td>
                        <td class="text-up"><strong>+13.9 bps</strong></td>
                        <td class="text-down"><strong>-18.9 bps</strong></td>
                        <td class="text-down"><strong>-7.1 bps</strong></td>
                    </tr>
                    <tr>
                        <td>高收益債券ETF(HYG)</td>
                        <td><strong>80.37</strong></td>
                        <td class="text-up"><strong>+0.34%</strong></td>
                        <td class="text-up"><strong>+0.21%</strong></td>
                        <td class="text-down"><strong>-0.63%</strong></td>
                        <td class="text-up"><strong>+0.02%</strong></td>
                        <td class="text-down"><strong>+2.19%</strong></td>
                    </tr>
                    <tr>
                        <td>新興市場美元債ETF(EMB)</td>
                        <td><strong>96.15</strong></td>
                        <td class="text-up"><strong>+0.27%</strong></td>
                        <td class="text-up"><strong>+0.12%</strong></td>
                        <td class="text-down"><strong>-0.01%</strong></td>
                        <td class="text-down"><strong>+2.47%</strong></td>
                        <td class="text-down"><strong>+7.99%</strong></td>
                    </tr>
                </tbody>
            </table>
        </div>
        <p class="text-xs text-right" style="color: #64748b; margin-top: 0.5rem;">資料來源: Yahoo Finance</p>

        <!-- --- v3.1.9 替換: 深度分析區塊使用 v2.8 格式 --- -->
        <div class="analysis-block">
            <h4>深度分析:</h4>
            <div class="structured-analysis">
                <p><strong>數據與官員言論拉鋸，殖利率曲線小幅下移</strong><br>美債市場受到強勁的初領失業金數據與聯準會官員鴿派言論的雙重影響。10年期公債殖利率下跌<strong>4.3 bps</strong>至<strong>4.06%</strong>，主要反映市場對未來經濟放緩可能促使降息的預期。雖然短期數據顯示經濟韌性，但長期通膨預期受控，使得長債殖利率回落，殖利率曲線倒掛程度略有改善，顯示市場對經濟軟著陸仍抱持希望。</p>
                <p><strong>風險情緒改善提振信用債，資金流向收益型資產</strong><br>隨著美股反彈及殖利率回落，高收益債ETF(HYG)上漲<strong>0.34%</strong>，顯示投資人對信用風險的擔憂減輕。深層解讀指出，在市場預期利率見頂的背景下，鎖定高收益率成為資金的主要策略。信用利差維持穩定，並未隨股市波動而大幅擴大，顯示企業基本面仍具支撐，債市環境相對健康。</p>
            </div>
        </div>
    </section>

    <!-- 第4章:大宗商品 -->
    <section id="sec-4" class="section-card">
        <h2 style="color: #cc4e01;"><span style="margin-right: 0.75rem;">🔥</span>第4章｜大宗商品</h2>

        <div class="tldr-block" style="background: #fffbeb;">
            <ul>
                <li style="color: #cc4e01;"><strong>和平協議降溫：</strong>媒體報導美國積極推動俄烏和平協議，地緣政治風險溢價消退，導致布蘭特原油大跌2.92%，回落至61美元附近。</li>
                <li style="color: #cc4e01;"><strong>金價避險支撐：</strong>儘管美元指數維持高檔，但市場對經濟不確定性的擔憂仍存，支撐黃金期貨上漲0.16%，維持在4062美元。</li>
                <li style="color: #cc4e01;"><strong>需求前景疲軟：</strong>中國經濟數據未見顯著起色，加上歐美製造業放緩，壓抑基本金屬與能源需求展望，WTI原油下跌0.29%。</li>
            </ul>
        </div>

        <h3 class="table-title">能源與商品市場行情</h3>
        <div class="overflow-x-auto">
            <table class="table-styled">
                <caption>能源與商品市場價格變動概覽</caption>
                <thead>
                    <tr>
                        <th>指標名稱</th>
                        <th>最新價格</th>
                        <th>日漲跌</th>
                        <th>五日漲跌</th>
                        <th>月漲跌</th>
                        <th>季漲跌</th>
                        <th>年初至今</th>
                    </tr>
                </thead>
                 <!-- --- v3.1.2 修正: 補齊表格行佔位符 --- -->
                <tbody>
                    <tr>
                        <td>WTI原油</td>
                        <td><strong>59.27</strong></td>
                        <td class="text-up"><strong>-0.29%</strong></td>
                        <td class="text-down"><strong>+1.33%</strong></td>
                        <td class="text-down"><strong>+3.01%</strong></td>
                        <td class="text-up"><strong>-4.94%</strong></td>
                        <td class="text-up"><strong>-17.36%</strong></td>
                    </tr>
                    <tr>
                        <td>布蘭特原油</td>
                        <td><strong>61.53</strong></td>
                        <td class="text-up"><strong>-2.92%</strong></td>
                        <td class="text-up"><strong>-2.35%</strong></td>
                        <td class="text-down"><strong>+0.85%</strong></td>
                        <td class="text-up"><strong>-7.94%</strong></td>
                        <td class="text-up"><strong>-17.56%</strong></td>
                    </tr>
                    <tr>
                        <td>黃金期貨</td>
                        <td><strong>4,062.80</strong></td>
                        <td class="text-down"><strong>+0.16%</strong></td>
                        <td class="text-up"><strong>-2.96%</strong></td>
                        <td class="text-up"><strong>-6.31%</strong></td>
                        <td class="text-down"><strong>+21.52%</strong></td>
                        <td class="text-down"><strong>+54.53%</strong></td>
                    </tr>
                    <tr>
                        <td>基礎金屬ETF (DBB)</td>
                        <td><strong>21.31</strong></td>
                        <td class="text-down"><strong>+0.38%</strong></td>
                        <td class="text-up"><strong>-1.57%</strong></td>
                        <td class="text-down"><strong>+0.95%</strong></td>
                        <td class="text-down"><strong>+9.62%</strong></td>
                        <td class="text-down"><strong>+13.05%</strong></td>
                    </tr>
                </tbody>
            </table>
        </div>
        <p class="text-xs text-right" style="color: #64748b; margin-top: 0.5rem;">資料來源: Yahoo Finance</p>

        <!-- --- v3.1.9 替換: 深度分析區塊使用 v2.8 格式 --- -->
        <div class="analysis-block">
            <h4>深度分析:</h4>
            <div class="structured-analysis">
                <p><strong>地緣政治溢價消退，油價面臨需求基本面考驗</strong><br>受俄烏和平協議推進的消息影響，市場對供應中斷的恐慌情緒大幅降溫。布蘭特原油大跌<strong>2.92%</strong>，WTI原油亦走弱。這顯示能源市場焦點迅速回歸供需基本面。由於全球主要經濟體增長放緩，特別是中國需求疲軟，油價上檔壓力沈重。庫存數據將是短期觀察重點，若需求未見改善，油價恐持續探底。</p>
                <p><strong>美元高檔與避險需求拉鋸，金價呈現區間整理</strong><br>黃金期貨上漲<strong>0.16%</strong>至<strong>4,062美元</strong>，顯示在美元指數維持100以上的高檔下，金價仍展現韌性，布蘭特 -2.92%。避險買盤與各國央行購金需求提供了下檔支撐，但高利率環境限制了上漲空間。深層解讀指出，金價目前處於多空平衡狀態，需等待更明確的降息訊號或地緣政治新變數，方能突破目前的區間整理格局。</p>
            </div>
        </div>
    </section>

    <!-- 第5章:台股解析 -->
    <section id="sec-5" class="section-card">
        <h2 style="color: #059669;"><span style="margin-right: 0.75rem;">🗻</span>第5章｜台股解析</h2>

        <div class="tldr-block" style="background: #f0fdf4;">
            <ul>
                <li style="color: #059669;"><strong>外資歷史級賣壓：</strong>外資單日瘋狂賣超915億元，創下歷史級賣超紀錄，權值股成為提款機，加權指數大跌3.61%。</li>
                <li style="color: #059669;"><strong>台積電領跌：</strong>受到地緣政治與外資調節影響，台積電股價重挫，拖累電子指數表現，市場信心潰散。</li>
                <li style="color: #059669;"><strong>技術面破壞：</strong>指數長黑摜破多道均線支撐，回測季線，短線技術面轉弱，需留意融資多殺多風險。</li>
            </ul>
        </div>

        <div class="overflow-x-auto">
            <table class="table-styled">
                <caption>亞洲主要股市指數漲跌概覽</caption>
                <thead>
                    <tr>
                        <th>指標名稱</th>
                        <th>最新收盤價</th>
                        <th>日漲跌</th>
                        <th>五日漲跌</th>
                        <th>月漲跌</th>
                        <th>季漲跌</th>
                        <th>年初至今</th>
                    </tr>
                </thead>
                 <!-- --- v3.1.2 修正: 補齊表格行佔位符 --- -->
                <tbody>
                    <tr>
                        <td>台灣加權指數</td>
                        <td><strong>26,434.94</strong></td>
                        <td class="text-up"><strong>-3.61%</strong></td>
                        <td class="text-up"><strong>-5.26%</strong></td>
                        <td class="text-up"><strong>-4.53%</strong></td>
                        <td class="text-down"><strong>+11.89%</strong></td>
                        <td class="text-down"><strong>+14.76%</strong></td>
                    </tr>
                    <tr>
                        <td>日經225</td>
                        <td><strong>48,625.88</strong></td>
                        <td class="text-up"><strong>-2.40%</strong></td>
                        <td class="text-up"><strong>-5.18%</strong></td>
                        <td class="text-up"><strong>-1.14%</strong></td>
                        <td class="text-down"><strong>+13.38%</strong></td>
                        <td class="text-down"><strong>+21.89%</strong></td>
                    </tr>
                    <tr>
                        <td>香港恆生指數</td>
                        <td><strong>25,220.02</strong></td>
                        <td class="text-up"><strong>-2.38%</strong></td>
                        <td class="text-up"><strong>-6.84%</strong></td>
                        <td class="text-up"><strong>-2.47%</strong></td>
                        <td class="text-down"><strong>+0.21%</strong></td>
                        <td class="text-down"><strong>+25.72%</strong></td>
                    </tr>
                    <tr>
                        <td>韓國KOSPI</td>
                        <td><strong>3,853.26</strong></td>
                        <td class="text-up"><strong>-3.79%</strong></td>
                        <td class="text-up"><strong>-7.61%</strong></td>
                        <td class="text-down"><strong>+1.01%</strong></td>
                        <td class="text-down"><strong>+23.10%</strong></td>
                        <td class="text-down"><strong>+60.59%</strong></td>
                    </tr>
                    <tr>
                        <td>印度SENSEX</td>
                        <td><strong>85,231.92</strong></td>
                        <td class="text-up"><strong>-0.47%</strong></td>
                        <td class="text-down"><strong>+0.89%</strong></td>
                        <td class="text-down"><strong>+1.03%</strong></td>
                        <td class="text-down"><strong>+4.12%</strong></td>
                        <td class="text-down"><strong>+9.08%</strong></td>
                    </tr>
                </tbody>
            </table>
        </div>
        <p class="text-xs text-right" style="color: #64748b; margin-top: 0.5rem;">資料來源: Yahoo Finance</p>

        <h3 class="table-title" style="margin-top: 2rem;">台股三大法人買賣超 (2025年11月21日)</h3>
        <div class="overflow-x-auto">
            <table class="table-styled">
                <caption>台股三大法人買賣超統計</caption>
                <thead>
                    <tr>
                        <th>法人別</th>
                        <th>當日淨額(億)</th>
                        <th>5日累計(億)</th>
                        <th>20日累計(億)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>外資</td>
                        <td class="text-up"><strong>-915.36</strong></td>
                        <td class="text-up"><strong>-1453.21</strong></td>
                        <td class="text-up"><strong>-3716.49</strong></td>
                    </tr>
                    <tr>
                        <td>投信</td>
                        <td class="text-up"><strong>-12.63</strong></td>
                        <td class="text-up"><strong>-111.07</strong></td>
                        <td class="text-up"><strong>-277.15</strong></td>
                    </tr>
                    <tr>
                        <td>自營商</td>
                        <td class="text-up"><strong>-152.74</strong></td>
                        <td class="text-up"><strong>-516.56</strong></td>
                        <td class="text-up"><strong>-450.76</strong></td>
                    </tr>
                    <tr class="summary-row">
                        <td>總計</td>
                        <td class="text-up"><strong>-1080.73</strong></td>
                        <td class="text-up"><strong>-2080.84</strong></td>
                        <td class="text-up"><strong>-4444.40</strong></td>
                    </tr>
                </tbody>
            </table>
        </div>
        <p class="text-xs text-right" style="color: #64748b; margin-top: 0.5rem;">資料來源: 交易所資料整理</p>

        <!-- --- v3.1.9 替換: 深度分析區塊使用 v2.8 格式 --- -->
        <div class="analysis-block">
            <h4>深度分析:</h4>
            <div class="structured-analysis">
                <p><strong>外資恐慌性拋售，台股面臨流動性衝擊</strong><br>外資單日賣超<strong>915.36億元</strong>，創下歷史級別的賣超紀錄，顯示資金正恐慌性撤離台股。這波賣壓主要集中在台積電等流動性佳的權值股，導致加權指數重挫<strong>3.61%</strong>。傳導機制為美股科技股修正疊加地緣政治風險，觸發了外資的程式化停損賣壓。內資雖有部分護盤，但難敵外資海嘯般的提款，市場信心遭受重創。</p>
                <p><strong>籌碼面嚴重潰散，技術面需時間修復</strong><br>指數一舉摜破多道均線，技術指標全面轉空。當前最大風險在於外資連續賣超是否會引發融資斷頭的連鎖反應。關鍵訊號在於台幣匯率是否能止穩，以及外資期貨空單是否回補。深層解讀顯示，這不僅是單日的修正，而是資金對台股估值與風險溢價的重新定價，短線建議保守看待，靜待籌碼沉澱。</p>
            </div>
        </div>
    </section>

    <!-- 第6章:匯率市場 -->
    <section id="sec-6" class="section-card">
        <h2 style="color: #0891b2;"><span style="margin-right: 0.75rem;">💱</span>第6章｜匯率市場</h2>

        <div class="tldr-block" style="background: #ecfeff;">
            <ul>
                <li style="color: #0891b2;"><strong>美元高檔震盪：</strong>經濟數據好壞參半，美元指數微升0.04%至100.20，市場在等待更明確的政策指引。</li>
                <li style="color: #0891b2;"><strong>台幣貶值壓力：</strong>受外資大舉匯出影響，台幣兌美元貶值0.50%，收在31.338，股匯雙殺格局加重貶值壓力。</li>
                <li style="color: #0891b2;"><strong>日圓逆勢升值：</strong>避險需求與日本央行政策預期支撐，日圓兌美元升值0.39%，表現相對強勢。</li>
            </ul>
        </div>

        <h3 class="table-title">主要貨幣兌美元匯率</h3>
        <div class="overflow-x-auto">
            <table class="table-styled">
                <caption>主要貨幣兌美元匯率變動概覽</caption>
                <thead>
                    <tr>
                        <th>指標名稱</th>
                        <th>最新匯率</th>
                        <th>日漲跌</th>
                        <th>五日漲跌</th>
                        <th>月漲跌</th>
                        <th>季漲跌</th>
                        <th>年初至今</th>
                    </tr>
                </thead>
                 <!-- --- v3.1.2 修正: 補齊表格行佔位符 --- -->
                <tbody>
                    <tr>
                        <td>美元指數</td>
                        <td><strong>100.20</strong></td>
                        <td class="text-down"><strong>+0.04%</strong></td>
                        <td class="text-down"><strong>+1.02%</strong></td>
                        <td class="text-down"><strong>+1.63%</strong></td>
                        <td class="text-down"><strong>+2.01%</strong></td>
                        <td class="text-up"><strong>-7.64%</strong></td>
                    </tr>
                    <tr>
                        <td>美元兌台幣</td>
                        <td><strong>31.3380</strong></td>
                        <td class="text-down"><strong>+0.50%</strong></td>
                        <td class="text-down"><strong>+0.88%</strong></td>
                        <td class="text-down"><strong>+2.34%</strong></td>
                        <td class="text-down"><strong>+4.09%</strong></td>
                        <td class="text-up"><strong>-4.34%</strong></td>
                    </tr>
                    <tr>
                        <td>歐元兌美元</td>
                        <td><strong>1.1519</strong></td>
                        <td class="text-up"><strong>-0.18%</strong></td>
                        <td class="text-up"><strong>-0.63%</strong></td>
                        <td class="text-up"><strong>-1.18%</strong></td>
                        <td class="text-up"><strong>-1.06%</strong></td>
                        <td class="text-down"><strong>+10.70%</strong></td>
                    </tr>
                    <tr>
                        <td>美元兌日圓</td>
                        <td><strong>156.3780</strong></td>
                        <td class="text-up"><strong>-0.39%</strong></td>
                        <td class="text-down"><strong>+1.08%</strong></td>
                        <td class="text-down"><strong>+3.63%</strong></td>
                        <td class="text-down"><strong>+5.85%</strong></td>
                        <td class="text-up"><strong>-0.39%</strong></td>
                    </tr>
                </tbody>
            </table>
        </div>
        <p class="text-xs text-right" style="color: #64748b; margin-top: 0.5rem;">資料來源: Yahoo Finance</p>

        <!-- --- v3.1.9 替換: 深度分析區塊使用 v2.8 格式 --- -->
        <div class="analysis-block">
            <h4>深度分析:</h4>
            <div class="structured-analysis">
                <p><strong>經濟數據分歧，美元指數高檔橫盤整理</strong><br>美元指數微升<strong>0.04%</strong>收在<strong>100.20</strong>，主要受好壞參半的經濟數據影響。初領失業金人數優於預期支撐美元，但官員鴿派言論限制了漲幅。市場在等待更明確的通膨與就業數據來確認聯準會的政策路徑。歐元兌美元下跌<strong>0.18%</strong>，反映歐洲經濟疲軟仍拖累歐元表現。</p>
                <p><strong>外資匯出衝擊，台幣面臨貶值壓力</strong><br>台幣兌美元貶值<strong>0.50%</strong>至<strong>31.338</strong>，主要反映台股外資鉅額賣超後的實質匯出需求。在美元維持高檔與台股重挫的雙重打擊下，台幣成為外資提款的對象。深層解讀顯示，若外資持續賣超台股，台幣短期恐難有像樣反彈，需密切關注央行是否進場調節以穩定匯市。</p>
            </div>
        </div>
    </section>

    <!-- --- v3.1.9 替換: 整個第7章區塊使用 v2.8 格式 --- -->
    <!-- --- v3.1.10 修正: 將 [買進] 改為 [看多], [賣出] 改為 [看空], class buy -> bullish, sell -> bearish --- -->
    <section id="sec-7" class="section-card">
        <h2 style="color: #7c3aed;">
            <span style="margin-right: 0.75rem;">🏭</span>第7章｜產業多空展望
        </h2>

        <!-- TL;DR -->
        <div class="tldr-block" style="background: #faf5ff;">
            <ul>
                <li style="color: #7c3aed;"><strong>[看多]</strong> AI軟體服務 (GOOGL.US): 谷歌推出新AI功能"Nano Banana Pro"，市場反應正面，股價表現強勢。</li>
                <li style="color: #7c3aed;"><strong>[看多]</strong> 醫藥生技 (LLY.US): 禮來市值突破1兆美元，減重藥需求強勁，獲利展望樂觀。</li>
                <li style="color: #7c3aed;"><strong>[看空]</strong> 加密貨幣 (COIN.US): 比特幣重挫，交易量恐萎縮，交易所營收面臨壓力。</li>
                <li style="color: #7c3aed;"><strong>[看空]</strong> 能源產業 (CVX.US): 油價下跌影響能源公司獲利預期，股價隨油價走弱。</li>
            </ul>
        </div>

        <!-- 看多推薦第一檔 -->
        <div class="stock-recommendation bullish">
            <h3 class="recommendation-title bullish">[看多]:AI軟體服務 (以Alphabet (GOOGL.US)為例)</h3>

            <div class="overflow-x-auto">
                <table class="analysis-table">
                    <thead>
                        <tr>
                            <th>分析維度</th>
                            <th>觀點與數據</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="font-semibold text-slate-600">新產品發布</td>
                            <td>谷歌推出視覺領域AGI模型"Nano Banana Pro"，展示強大的AI技術實力。</td>
                        </tr>
                        <tr>
                            <td class="font-semibold text-slate-600">算力需求</td>
                            <td>AI基建負責人示警算力需倍數成長，顯示公司在AI領域的投入與決心。</td>
                        </tr>
                        <tr>
                            <td class="font-semibold text-slate-600">股價表現</td>
                            <td>在科技股普遍回檔之際，谷歌股價表現相對抗跌，顯示市場對其AI前景的信心。</td>
                        </tr>
                        <tr>
                            <td class="font-semibold text-slate-600">
                                <div class="link-button-container">
                                    <a href="https://tw.tradingview.com/symbols/NASDAQ-GOOGL/financials-overview/" target="_blank" class="link-button fundamental">
                                        基本面
                                        <span class="link-button-subtitle">按此看財務數據</span>
                                    </a>
                                    <a href="https://tw.tradingview.com/symbols/NASDAQ-GOOGL/technicals/" target="_blank" class="link-button technical">
                                        技術面
                                        <span class="link-button-subtitle">按此看技術圖表</span>
                                    </a>
                                </div>
                            </td>
                            <td>
                                Alphabet (GOOGL.US) 近期在AI領域動作頻頻，新產品的發布有助於鞏固其在搜尋與雲端業務的競爭優勢。儘管面臨反壟斷等監管壓力，但其強大的現金流與技術護城河，使其成為AI軟體服務領域的首選標的。<br><br>
                                股價維持多頭排列，回檔量縮，下方支撐強勁。
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <p class="text-xs text-right" style="color: #64748b; margin-top: 0.5rem;">資料來源: TradingView</p>

            <div class="analysis-block">
                <h4>深度分析:</h4>
                <div class="structured-analysis">
                    <p><strong>AI新模型助攻，Alphabet重拾成長動能</strong><br>Alphabet (GOOGL.US) 透過發布Nano Banana Pro，再次證明其在AI領域的領先地位。隨著AI應用逐漸落地，谷歌在軟體服務端的變現能力將成為市場關注焦點。在硬體股估值偏高之際，資金有轉向軟體服務股的跡象，Alphabet具備估值修復與成長潛力。</p>
                </div>
            </div>
        </div>

        <!-- 看多推薦第二檔 -->
        <div class="stock-recommendation bullish">
            <h3 class="recommendation-title bullish">[看多]:醫藥生技 (以Eli Lilly (LLY.US)為例)</h3>

            <div class="overflow-x-auto">
                <table class="analysis-table">
                    <thead>
                        <tr>
                            <th>分析維度</th>
                            <th>觀點與數據</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="font-semibold text-slate-600">市值里程碑</td>
                            <td>禮來市值一度衝上1兆美元，成為首家達成此成就的藥廠，顯示市場熱度。</td>
                        </tr>
                        <tr>
                            <td class="font-semibold text-slate-600">產品需求</td>
                            <td>減重藥Zepbound需求強勁，供不應求，為公司帶來巨大的營收成長動能。</td>
                        </tr>
                        <tr>
                            <td class="font-semibold text-slate-600">防禦屬性</td>
                            <td>在市場波動加劇時，醫藥股具備防禦屬性，且擁有高成長產品線。</td>
                        </tr>
                         <tr>
                            <td class="font-semibold text-slate-600">
                                <div class="link-button-container">
                                    <a href="https://tw.tradingview.com/symbols/NYSE-LLY/financials-overview/" target="_blank" class="link-button fundamental">
                                        基本面
                                        <span class="link-button-subtitle">按此看財務數據</span>
                                    </a>
                                    <a href="https://tw.tradingview.com/symbols/NYSE-LLY/technicals/" target="_blank" class="link-button technical">
                                        技術面
                                        <span class="link-button-subtitle">按此看技術圖表</span>
                                    </a>
                                </div>
                            </td>
                            <td>
                                禮來(LLY.US)憑藉在減重藥領域的領導地位，獲利能力大幅提升。市值突破兆元顯示市場對其未來成長的高度預期。在總體經濟不確定性下，剛性需求的醫藥股成為資金避風港，且禮來兼具成長性。<br><br>
                                股價創高後維持高檔震盪，均線向上發散，多頭趨勢明確。
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <p class="text-xs text-right" style="color: #64748b; margin-top: 0.5rem;">資料來源: TradingView</p>

            <div class="analysis-block">
                <h4>深度分析:</h4>
                <div class="structured-analysis">
                    <p><strong>減重藥需求井噴，禮來穩坐醫藥市值王寶座</strong><br>Eli Lilly (LLY.US) 的減重藥產品線是其股價上漲的核心驅動力。隨著全球肥胖問題日益嚴重，減重藥市場規模龐大且持續擴張。禮來的產品在療效與市占率上具備優勢，且產能擴充順利，未來營收與獲利有望持續創高，長線看好。</p>
                </div>
            </div>
        </div>

        <!-- 看空推薦第一檔 -->
        <div class="stock-recommendation bearish">
            <h3 class="recommendation-title bearish">[看空]:加密貨幣 (以Coinbase (COIN.US)為例)</h3>

            <div class="overflow-x-auto">
                <table class="analysis-table">
                    <thead>
                        <tr>
                            <th>分析維度</th>
                            <th>觀點與數據</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="font-semibold text-slate-600">幣價重挫</td>
                            <td>比特幣價格跌破8萬美元，單日跌幅達10%，市場信心受挫。</td>
                        </tr>
                        <tr>
                            <td class="font-semibold text-slate-600">交易量萎縮</td>
                            <td>幣價下跌通常伴隨交易熱度下降，直接衝擊Coinbase的交易手續費收入。</td>
                        </tr>
                        <tr>
                            <td class="font-semibold text-slate-600">監管風險</td>
                            <td>加密貨幣市場仍面臨監管不確定性，尤其在價格大幅波動時，監管關注度可能提高。</td>
                        </tr>
                         <tr>
                            <td class="font-semibold text-slate-600">
                                <div class="link-button-container">
                                    <a href="https://tw.tradingview.com/symbols/NASDAQ-COIN/financials-overview/" target="_blank" class="link-button fundamental">
                                        基本面
                                        <span class="link-button-subtitle">按此看財務數據</span>
                                    </a>
                                    <a href="https://tw.tradingview.com/symbols/NASDAQ-COIN/technicals/" target="_blank" class="link-button technical">
                                        技術面
                                        <span class="link-button-subtitle">按此看技術圖表</span>
                                    </a>
                                </div>
                            </td>
                            <td>
                                Coinbase(COIN.US)作為加密貨幣交易所，其股價與比特幣走勢高度連動。比特幣的大幅修正預示著幣圈寒冬可能來臨，交易量下滑將直接侵蝕公司獲利。在風險偏好降溫的環境下，高估值的加密貨幣概念股面臨修正壓力。<br><br>
                                股價隨幣價重挫，跌破重要支撐，技術指標轉弱，建議保守看待。
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <p class="text-xs text-right" style="color: #64748b; margin-top: 0.5rem;">資料來源: TradingView</p>

            <div class="analysis-block">
                 <h4>深度分析:</h4>
                <div class="structured-analysis">
                    <p><strong>比特幣崩跌衝擊信心，Coinbase營運面臨逆風</strong><br>Coinbase (COIN.US) 的營運表現與加密貨幣市場景氣息息相關。比特幣跌破關鍵價位，顯示投機資金正在撤離，市場進入調整期。交易量的萎縮將導致Coinbase營收下滑，且高利率環境下，無息資產吸引力降低，進一步壓抑幣價與相關個股表現。</p>
                </div>
            </div>
        </div>

        <!-- 看空推薦第二檔 -->
        <div class="stock-recommendation bearish">
            <h3 class="recommendation-title bearish">[看空]:能源產業 (以Chevron (CVX.US)為例)</h3>

            <div class="overflow-x-auto">
                <table class="analysis-table">
                    <thead>
                        <tr>
                            <th>分析維度</th>
                            <th>觀點與數據</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="font-semibold text-slate-600">油價下跌</td>
                            <td>受地緣政治緩和與需求疲軟影響，WTI與布蘭特原油價格同步走跌。</td>
                        </tr>
                        <tr>
                            <td class="font-semibold text-slate-600">獲利壓縮</td>
                            <td>油價下跌直接壓縮能源公司的上游開採利潤，影響每股盈餘(EPS)表現。</td>
                        </tr>
                        <tr>
                            <td class="font-semibold text-slate-600">需求疑慮</td>
                            <td>全球經濟成長放緩，特別是中國需求未見起色，長期壓抑油價表現。</td>
                        </tr>
                         <tr>
                            <td class="font-semibold text-slate-600">
                                <div class="link-button-container">
                                    <a href="https://tw.tradingview.com/symbols/NYSE-CVX/financials-overview/" target="_blank" class="link-button fundamental">
                                        基本面
                                        <span class="link-button-subtitle">按此看財務數據</span>
                                    </a>
                                    <a href="https://tw.tradingview.com/symbols/NYSE-CVX/technicals/" target="_blank" class="link-button technical">
                                        技術面
                                        <span class="link-button-subtitle">按此看技術圖表</span>
                                    </a>
                                </div>
                            </td>
                            <td>
                                Chevron(CVX.US)作為綜合能源大廠，其股價表現與油價高度相關。隨著和平協議推進與需求疲軟，油價下行壓力增大，不利於能源股表現。雖然公司擁有穩健的資產負債表與股息，但在油價低迷時期，資本利得空間有限。<br><br>
                                股價受油價拖累走弱，均線下彎，技術面呈現弱勢整理格局。
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <p class="text-xs text-right" style="color: #64748b; margin-top: 0.5rem;">資料來源: TradingView</p>

            <div class="analysis-block">
                <h4>深度分析:</h4>
                <div class="structured-analysis">
                    <p><strong>油價基本面疲軟，能源股獲利展望蒙塵</strong><br>Chevron (CVX.US) 面臨油價下跌帶來的獲利修正壓力。地緣政治風險溢價消退，加上全球經濟放緩導致需求不振，油市供過於求的擔憂升溫。在油價缺乏上漲動能的情況下，能源板塊的吸引力下降，資金可能流出轉向其他具成長性的板塊。</p>
                </div>
            </div>
        </div>
    </section>


    <!-- 頁尾 -->
    <footer class="text-center" style="margin-top: 3rem; padding-top: 2rem; border-top: 1px solid #e2e8f0;">
        <p class="text-xs" style="color: #64748b;">© 2025 金融市場研究團隊 — 洞察•解構•透視全球資產</p>
        <p class="text-xs" style="color: #64748b; margin-top: 0.5rem;">本報告僅為資訊分享,不構成任何投資建議,投資人應秉持獨立判斷,審慎評估並自負投資風險。</p>
    </footer>

</div>

<!-- 回頂按鈕 -->
<button class="back-to-top" onclick="window.scrollTo({top: 0, behavior: 'smooth'})" title="回到頂部" style="display: none;">↑</button>

<script>
// 進度條功能
function updateProgressBar() {
    const winScroll = document.body.scrollTop || document.documentElement.scrollTop;
    const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
    const scrolled = (winScroll / height) * 100;
    const progressBar = document.getElementById("progressBar");
    if (progressBar) {
        progressBar.style.width = scrolled + "%";
        progressBar.style.opacity = scrolled > 0 ? "1" : "0";
    }
}
window.onscroll = function() { updateProgressBar(); };


// --- 穩健性: 確保 DOM 載入後才綁定事件 ---
window.addEventListener('load', function() {

    // 智能下載功能
    const smartDownloadBtn = document.getElementById('smartDownloadBtn');
    if (smartDownloadBtn) {
        smartDownloadBtn.addEventListener('click', function() {
            const element = document.createElement('a');
            const dateStr = '20251122';
            const filename = dateStr + '.html';

            // Temporarily hide elements that shouldn't be in the downloaded file
            const progressBar = document.getElementById('progressBar');
            const backToTopButton = document.querySelector('.back-to-top');
            const originalProgressBarStyle = progressBar ? progressBar.style.display : '';
            const originalBackToTopStyle = backToTopButton ? backToTopButton.style.display : '';

            if (progressBar) progressBar.style.display = 'none';
            if (backToTopButton) backToTopButton.style.display = 'none';

            // Get the HTML content AFTER hiding elements
            const content = document.documentElement.outerHTML;

            // Restore elements
            if (progressBar) progressBar.style.display = originalProgressBarStyle;
            if (backToTopButton) backToTopButton.style.display = originalBackToTopStyle;


            const file = new Blob([content], {type: 'text/html;charset=utf-8'});
            element.href = URL.createObjectURL(file);
            element.download = filename;
            document.body.appendChild(element);
            element.click();
            document.body.removeChild(element);
            URL.revokeObjectURL(element.href);
        });
    }

    // 平滑滾動導航
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute('href'));
            if (target) {
                const offset = 120;
                const bodyRect = document.body.getBoundingClientRect().top;
                const elementRect = target.getBoundingClientRect().top;
                const elementPosition = elementRect - bodyRect;
                const offsetPosition = elementPosition - offset;
                window.scrollTo({ top: offsetPosition, behavior: 'smooth' });
            }
        });
    });

    // 載入完成後隱藏進度條 (fade out effect)
    const progressBar = document.getElementById("progressBar");
     if (progressBar) {
        progressBar.style.transition = 'opacity 0.5s ease-out';
        setTimeout(function() {
            progressBar.style.opacity = "0";
        }, 500);
     }
});
</script>


</body></html>