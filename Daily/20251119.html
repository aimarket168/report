<html lang="zh-TW"><head><script>(function(firebaseConfig, initialAuthToken, appId) {
        window.__firebase_config = firebaseConfig;
        window.__initial_auth_token = initialAuthToken;
        window.__app_id = appId;
            })("\n{\n  \"apiKey\": \"AIzaSyCqyCcs2R2e7AegGjvFAwG98wlamtbHvZY\",\n  \"authDomain\": \"bard-frontend.firebaseapp.com\",\n  \"projectId\": \"bard-frontend\",\n  \"storageBucket\": \"bard-frontend.firebasestorage.app\",\n  \"messagingSenderId\": \"175205271074\",\n  \"appId\": \"1:175205271074:web:2b7bd4d34d33bf38e6ec7b\"\n}\n","eyJhbGciOiJSUzI1NiIsImtpZCI6IjA5ZmNiMTMxOGNkZGNmOWU4YjczZjZhMzM3ZTk2ZTIwNjJmMjEwZGIiLCJ0eXAiOiJKV1QifQ.eyJzdWIiOiJmaXJlYmFzZS1hZG1pbnNkay1mYnN2Y0BiYXJkLWZyb250ZW5kLmlhbS5nc2VydmljZWFjY291bnQuY29tIiwiYXVkIjoiaHR0cHM6Ly9pZGVudGl0eXRvb2xraXQuZ29vZ2xlYXBpcy5jb20vZ29vZ2xlLmlkZW50aXR5LmlkZW50aXR5dG9vbGtpdC52MS5JZGVudGl0eVRvb2xraXQiLCJ1aWQiOiIwMTYyNzg3NDM4ODM1OTc2Mjk5OCIsImlzcyI6ImZpcmViYXNlLWFkbWluc2RrLWZic3ZjQGJhcmQtZnJvbnRlbmQuaWFtLmdzZXJ2aWNlYWNjb3VudC5jb20iLCJjbGFpbXMiOnsiYXBwSWQiOiJjXzQzZmQwYzMwODI1MzYyNmJfMjAyNTExMTkuaHRtbC0zNzYifSwiZXhwIjoxNzYzNTA5MDM4LCJpYXQiOjE3NjM1MDU0MzgsImFsZyI6IlJTMjU2In0.Fiy5TaU2oF4Im6qlp8B3KUc_sK671PbrGlY43DDxUNKAcThlvoGGUhkVSwu6Cym9lwaTxm_mkhZDlTR8ovSsMZcA8cMLId5LzY1yBws2nDTtpmlGWzNwLJQq2Uww66WdkH3sZi2UnqRVs9ZIeHLtV6TEDf98VDM96SkyZQ4pZxRSt5IwQ0SShBPWFdzYcarMhFtXjsaxhSUypikatq9xckWokRjyf5-5PFNIwAGTfCTgrh2fd7_JkaGS_CqWeDp2OVonJ0FuTy4T3WScwX2D1yVuxjEhXecu4lUefywp6x-nqSyzXLkcu3WjcJTvWGVExZuG7LfpZ0bJlUKl12mPTw","c_43fd0c308253626b_20251119.html-376")</script><script>'use strict';var h=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,b,d){if(a==Array.prototype||a==Object.prototype)return a;a[b]=d.value;return a};function l(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var d=a[b];if(d&&d.Math==Math)return d}throw Error("Cannot find global object");}var n=l(this);
function p(a,b){if(b)a:{var d=n;a=a.split(".");for(var c=0;c<a.length-1;c++){var e=a[c];if(!(e in d))break a;d=d[e]}a=a[a.length-1];c=d[a];b=b(c);b!=c&&b!=null&&h(d,a,{configurable:!0,writable:!0,value:b})}}function r(a){function b(c){return a.next(c)}function d(c){return a.throw(c)}return new Promise(function(c,e){function f(g){g.done?c(g.value):Promise.resolve(g.value).then(b,d).then(f,e)}f(a.next())})}function t(a){return r(a())}
p("Object.values",function(a){return a?a:function(b){var d=[],c;for(c in b)Object.prototype.hasOwnProperty.call(b,c)&&d.push(b[c]);return d}});p("Array.prototype.includes",function(a){return a?a:function(b,d){var c=this;c instanceof String&&(c=String(c));var e=c.length;d=d||0;for(d<0&&(d=Math.max(d+e,0));d<e;d++){var f=c[d];if(f===b||Object.is(f,b))return!0}return!1}});/*

 MIT License

 Copyright (c) 2017-2023 W.Y.

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in
 all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 SOFTWARE.

*/
function u(a,b){const d=a.style;b.backgroundColor&&(d.backgroundColor=b.backgroundColor);b.width&&(d.width=`${b.width}px`);b.height&&(d.height=`${b.height}px`);const c=b.style;c!=null&&Object.keys(c).forEach(e=>{d[e]=c[e]})};var v=(()=>{let a=0;return()=>{a+=1;return`u${`0000${(Math.random()*1679616<<0).toString(36)}`.slice(-4)}${a}`}})();function w(a){const b=[];for(let d=0,c=a.length;d<c;d++)b.push(a[d]);return b}let x=null;function y(a={}){return x?x:a.l?x=a.l:x=w(window.getComputedStyle(document.documentElement))}function z(a,b){return(a=(a.ownerDocument.defaultView||window).getComputedStyle(a).getPropertyValue(b))?parseFloat(a.replace("px","")):0}
function A(a,b={}){var d;if(!(d=b.width)){d=z(a,"border-left-width");var c=z(a,"border-right-width");d=a.clientWidth+d+c}(b=b.height)||(b=z(a,"border-top-width"),c=z(a,"border-bottom-width"),b=a.clientHeight+b+c);return{width:d,height:b}}function B(a){return new Promise((b,d)=>{const c=new Image;c.onload=()=>{c.decode().then(()=>{requestAnimationFrame(()=>b(c))})};c.onerror=d;c.crossOrigin="anonymous";c.decoding="async";c.src=a})}
function C(a){return t(function*(){return Promise.resolve().then(()=>(new XMLSerializer).serializeToString(a)).then(encodeURIComponent).then(b=>`data:image/svg+xml;charset=utf-8,${b}`)})}
function D(a,b,d){return t(function*(){const c=document.createElementNS("http://www.w3.org/2000/svg","svg"),e=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");c.setAttribute("width",`${b}`);c.setAttribute("height",`${d}`);c.setAttribute("viewBox",`0 0 ${b} ${d}`);e.setAttribute("width","100%");e.setAttribute("height","100%");e.setAttribute("x","0");e.setAttribute("y","0");e.setAttribute("externalResourcesRequired","true");c.appendChild(e);e.appendChild(a);return C(c)})}
var E=(a,b)=>{if(a instanceof b)return!0;a=Object.getPrototypeOf(a);return a===null?!1:a.constructor.name===b.name||E(a,b)};function F(a,b){return y(b).map(d=>{const c=a.getPropertyValue(d),e=a.getPropertyPriority(d);return`${d}: ${c}${e?" !important":""};`}).join(" ")}
function G(a,b,d,c){a=window.getComputedStyle(a,d);var e=a.getPropertyValue("content");if(e!==""&&e!=="none"){var f=v();try{b.className=`${b.className} ${f}`}catch(k){return}e=document.createElement("style");var g=e.appendChild;d=`.${f}:${d}`;a.cssText?(c=a.getPropertyValue("content"),c=`${a.cssText} content: '${c.replace(/'|"/g,"")}';`):c=F(a,c);g.call(e,document.createTextNode(`${d}{${c}}`));b.appendChild(e)}};function H(a){return a.search(/^(data:)/)!==-1}function I(a,b,d){return t(function*(){const c=yield fetch(a,b);if(c.status===404)throw Error(`Resource "${c.url}" not found`);const e=yield c.blob();return new Promise((f,g)=>{const k=new FileReader;k.onerror=g;k.onloadend=()=>{try{f(d({o:c,result:k.result}))}catch(m){g(m)}};k.readAsDataURL(e)})})}const J={};function K(a,b,d){let c=a.replace(/\?.*/,"");d&&(c=a);/ttf|otf|eot|woff2?/i.test(c)&&(c=c.replace(/.*\//,""));return b?`[${b}]${c}`:c}
function L(a,b,d){return t(function*(){const c=K(a,b,d.C);if(J[c]!=null)return J[c];d.u&&(a+=(/\?/.test(a)?"&":"?")+(new Date).getTime());let e;try{const f=yield I(a,d.i,({o:g,result:k})=>{b||(b=g.headers.get("Content-Type")||"");return k.split(/,/)[1]});e=`data:${b};base64,${f}`}catch(f){e=d.B||""}return J[c]=e})};const M={P:"application/font-woff",R:"application/font-woff",N:"application/font-truetype",v:"application/vnd.ms-fontobject",H:"image/png",F:"image/jpeg",D:"image/jpeg",A:"image/gif",M:"image/tiff",L:"image/svg+xml",O:"image/webp"};function N(a){return(a=/\.([^./]*?)$/g.exec(a))?a[1]:""};function O(a){return t(function*(){const b=a.toDataURL();return b==="data:,"?a.cloneNode(!1):B(b)})}function aa(a,b){return t(function*(){if(a.currentSrc){var d=document.createElement("canvas");const c=d.getContext("2d");d.width=a.clientWidth;d.height=a.clientHeight;c==null||c.drawImage(a,0,0,d.width,d.height);d=d.toDataURL();return B(d)}d=a.poster;d=yield L(d,M[N(d).toLowerCase()]||"",b);return B(d)})}
function ba(a,b){return t(function*(){try{let d;if(a==null?0:(d=a.contentDocument)==null?0:d.body)return yield P(a.contentDocument.body,b,!0)}catch(d){}return a.cloneNode(!1)})}function ca(a,b){return t(function*(){return E(a,HTMLCanvasElement)?O(a):E(a,HTMLVideoElement)?aa(a,b):E(a,HTMLIFrameElement)?ba(a,b):a.cloneNode(a.tagName!=null&&a.tagName.toUpperCase()==="SVG")})}
function da(a,b,d){return t(function*(){if(b.tagName!=null&&b.tagName.toUpperCase()==="SVG")return b;let c=[];if(a.tagName!=null&&a.tagName.toUpperCase()==="SLOT"&&a.assignedNodes)c=w(a.assignedNodes());else{let e;if(E(a,HTMLIFrameElement)&&((e=a.contentDocument)==null?0:e.body))c=w(a.contentDocument.body.childNodes);else{let f;c=w(((f=a.shadowRoot)!=null?f:a).childNodes)}}if(c.length===0||E(a,HTMLVideoElement))return b;yield c.reduce((e,f)=>e.then(()=>P(f,d)).then(g=>{g&&b.appendChild(g)}),Promise.resolve());
return b})}function ea(a,b,d){const c=b.style;if(c){var e=window.getComputedStyle(a);e.cssText?(c.cssText=e.cssText,c.transformOrigin=e.transformOrigin):y(d).forEach(f=>{let g=e.getPropertyValue(f);f==="font-size"&&g.endsWith("px")&&(g=`${Math.floor(parseFloat(g.substring(0,g.length-2)))-.1}px`);E(a,HTMLIFrameElement)&&f==="display"&&g==="inline"&&(g="block");f==="d"&&b.getAttribute("d")&&(g=`path(${b.getAttribute("d")})`);c.setProperty(f,g,e.getPropertyPriority(f))})}}
function fa(a,b){E(a,HTMLSelectElement)&&(b=Array.from(b.children).find(d=>a.value===d.getAttribute("value")))&&b.setAttribute("selected","")}
function ha(a,b){return t(function*(){var d=a.querySelectorAll?a.querySelectorAll("use"):[];if(d.length===0)return a;var c={};for(var e=0;e<d.length;e++){var f=d[e].getAttribute("xlink:href");if(f){const g=document.querySelector(f);a.querySelector(f)||!g||c[f]||(c[f]=yield P(g,b,!0))}}d=Object.values(c);if(d.length){c=document.createElementNS("http://www.w3.org/1999/xhtml","svg");c.setAttribute("xmlns","http://www.w3.org/1999/xhtml");c.style.position="absolute";c.style.width="0";c.style.height="0";
c.style.overflow="hidden";c.style.display="none";e=document.createElementNS("http://www.w3.org/1999/xhtml","defs");c.appendChild(e);for(f=0;f<d.length;f++)e.appendChild(d[f]);a.appendChild(c)}return a})}
function P(a,b,d){return t(function*(){return d||!b.filter||b.filter(a)?Promise.resolve(a).then(c=>ca(c,b)).then(c=>da(a,c,b)).then(c=>{E(c,Element)&&(ea(a,c,b),G(a,c,":before",b),G(a,c,":after",b),E(a,HTMLTextAreaElement)&&(c.textContent=a.value),E(a,HTMLInputElement)&&c.setAttribute("value",a.value),fa(a,c));return c}).then(c=>ha(c,b)):null})};const Q=/url\((['"]?)([^'"]+?)\1\)/g,ia=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,ja=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function ka(a){const b=[];a.replace(Q,(d,c,e)=>{b.push(e);return d});return b.filter(d=>!H(d))}
function la(a,b,d,c){return t(function*(){try{const e=d?(new URL(b,d||void 0)).toString():b;let f;f=yield L(e,M[N(b).toLowerCase()]||"",c);return a.replace(new RegExp(`(url\\(['"]?)(${b.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")})(['"]?\\))`,"g"),`$1${f}$3`)}catch(e){}return a})}function ma(a,{I:b}){return b?a.replace(ja,d=>{for(;;){const [c,,e]=ia.exec(d)||[],f=c,g=e;if(!g)return"";if(g===b)return`src: ${f};`}}):a}
function R(a,b,d){return t(function*(){if(a.search(Q)===-1)return a;const c=ma(a,d);return ka(c).reduce((e,f)=>e.then(g=>la(g,f,b,d)),Promise.resolve(c))})};function S(a,b,d){return t(function*(){var c;const e=(c=b.style)==null?void 0:c.getPropertyValue(a);return e?(c=yield R(e,null,d),b.style.setProperty(a,c,b.style.getPropertyPriority(a)),!0):!1})}function na(a,b){return t(function*(){(yield S("background",a,b))||(yield S("background-image",a,b));(yield S("mask",a,b))||(yield S("-webkit-mask",a,b))||(yield S("mask-image",a,b))||(yield S("-webkit-mask-image",a,b))})}
function oa(a,b){return t(function*(){const d=E(a,HTMLImageElement);if(d&&!H(a.src)||E(a,SVGImageElement)&&!H(a.href.baseVal)){var c=d?a.src:a.href.baseVal,e=yield L(c,M[N(c).toLowerCase()]||"",b);yield new Promise((f,g)=>{a.onload=f;a.onerror=b.m?(...k)=>{try{f(b.m(...k))}catch(m){g(m)}}:g;a.decode&&(a.decode=f);a.loading==="lazy"&&(a.loading="eager");d?(a.srcset="",a.src=e):a.href.baseVal=e})}})}
function pa(a,b){return t(function*(){const d=w(a.childNodes).map(c=>T(c,b));yield Promise.all(d).then(()=>a)})}function T(a,b){return t(function*(){E(a,Element)&&(yield na(a,b),yield oa(a,b),yield pa(a,b))})};const U={};function V(a){return t(function*(){var b=U[a];if(b!=null)return b;b=yield(yield fetch(a)).text();b={url:a,cssText:b};return U[a]=b})}function W(a,b){return t(function*(){let d=a.cssText;const c=/url\(["']?([^"')]+)["']?\)/g,e=(d.match(/url\([^)]+\)/g)||[]).map(f=>t(function*(){let g=f.replace(c,"$1");g.startsWith("https://")||(g=(new URL(g,a.url)).href);return I(g,b.i,({result:k})=>{d=d.replace(f,`url(${k})`);return[f,k]})}));return Promise.all(e).then(()=>d)})}
function X(a){if(a==null)return[];const b=[];a=a.replace(/(\/\*[\s\S]*?\*\/)/gi,"");for(var d=RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");;){var c=d.exec(a);if(c===null)break;b.push(c[0])}a=a.replace(d,"");d=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi;for(c=RegExp("((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})","gi");;){let e=d.exec(a);if(e===null)if(e=c.exec(a),e===null)break;else d.lastIndex=c.lastIndex;else c.lastIndex=
d.lastIndex;b.push(e[0])}return b}
function qa(a,b){return t(function*(){const d=[],c=[];a.forEach(e=>{if("cssRules"in e)try{w(e.cssRules||[]).forEach((f,g)=>{if(f.type===CSSRule.IMPORT_RULE){let k=g+1;f=V(f.href).then(m=>W(m,b)).then(m=>X(m).forEach(q=>{try{e.insertRule(q,q.startsWith("@import")?k+=1:e.cssRules.length)}catch(Da){}})).catch(()=>{});c.push(f)}})}catch(f){const g=a.find(k=>k.href==null)||document.styleSheets[0];e.href!=null&&c.push(V(e.href).then(k=>W(k,b)).then(k=>X(k).forEach(m=>{g.insertRule(m,g.cssRules.length)})).catch(()=>
{}))}});return Promise.all(c).then(()=>{a.forEach(e=>{if("cssRules"in e)try{w(e.cssRules||[]).forEach(f=>{d.push(f)})}catch(f){}});return d})})}function ra(a){return a.filter(b=>b.type===CSSRule.FONT_FACE_RULE).filter(b=>b.style.getPropertyValue("src").search(Q)!==-1)}function sa(a,b){return t(function*(){if(a.ownerDocument==null)throw Error("Provided element is not within a Document");var d=w(a.ownerDocument.styleSheets);d=yield qa(d,b);return ra(d)})}
function ta(a){function b(c){(c.style.fontFamily||getComputedStyle(c).fontFamily).split(",").forEach(e=>{d.add(e.trim().replace(/["']/g,""))});Array.from(c.children).forEach(e=>{e instanceof HTMLElement&&b(e)})}const d=new Set;b(a);return d}function ua(a,b){return t(function*(){const d=yield sa(a,b),c=ta(a);return(yield Promise.all(d.filter(e=>c.has(e.style.fontFamily.trim().replace(/["']/g,""))).map(e=>R(e.cssText,e.parentStyleSheet?e.parentStyleSheet.href:null,b)))).join("\n")})}
function va(a,b){return t(function*(){const d=b.j!=null?b.j:b.K?null:yield ua(a,b);if(d){const c=document.createElement("style");c.appendChild(document.createTextNode(d));a.firstChild?a.insertBefore(c,a.firstChild):a.appendChild(c)}})};function wa(a,b={}){return t(function*(){const {width:d,height:c}=A(a,b),e=yield P(a,b,!0);yield va(e,b);yield T(e,b);u(e,b);return yield D(e,d,c)})}
function xa(a,b={}){return t(function*(){const {width:d,height:c}=A(a,b);var e=yield wa(a,b);e=yield B(e);const f=document.createElement("canvas"),g=f.getContext("2d"),k=b.G||window.devicePixelRatio||1,m=b.h||d,q=b.g||c;f.width=m*k;f.height=q*k;!b.J&&(f.width>16384||f.height>16384)&&(f.width>16384&&f.height>16384?f.width>f.height?(f.height*=16384/f.width,f.width=16384):(f.width*=16384/f.height,f.height=16384):f.width>16384?(f.height*=16384/f.width,f.width=16384):(f.width*=16384/f.height,f.height=
16384));f.style.width=`${m}`;f.style.height=`${q}`;b.backgroundColor&&(g.fillStyle=b.backgroundColor,g.fillRect(0,0,f.width,f.height));g.drawImage(e,0,0,f.width,f.height);return f})}function ya(a,b={}){return t(function*(){return(yield xa(a,b)).toDataURL()})};const za=["gemini.google.com","corp.google.com","proxy.googlers.com"];function Y(){return document.body.querySelectorAll('[class*="animate"]').length>0}function Z(a){return t(function*(){try{return yield ya(a,{h:a.offsetWidth,g:a.offsetHeight})}catch(d){var b=a.offsetHeight;const c=document.createElement("canvas");c.width=a.offsetWidth;c.height=b;return c.toDataURL("image/png")}})}
function Aa(){return t(function*(){const a=document.body.offsetWidth,b=document.body.offsetHeight,d=document.body.cloneNode(!0);d.querySelectorAll('[class*="animate"]').forEach(c=>{c.classList.remove(...Array.from(c.classList).filter(e=>e.startsWith("animate")))});d.style.width=`${a}px`;d.style.height=`${b}px`;return d})}
function Ba(a){return t(function*(){let b=document.body;if(Y()){var d=yield Aa();b=d;document.body.appendChild(d)}d=yield Z(b);Y()&&document.body.removeChild(b);window.parent.postMessage({type:"SEND_SCREENSHOT",image:d,topOffset:document.documentElement.scrollTop},a.origin)})}function Ca(a){return t(function*(){const b={type:"SEND_SCREENSHOT_FOR_DATA_VISUALIZATION",image:yield Z(document.body),topOffset:0};window.parent.postMessage(b,a.origin)})}
window.addEventListener("message",a=>t(function*(){if(za.some(d=>a.origin.includes(d))){var b=a.data;b&&(b.type==="MAKE_SCREENSHOT"&&(yield Ba(a)),b.type==="MAKE_SCREENSHOT_FOR_DATA_VISUALIZATION"&&(yield Ca(a)))}}));
</script><script>(function() {
  // Ensure this script is executed only once
  if (window.firebaseAuthBridgeScriptLoaded) {
    return;
  }
  window.firebaseAuthBridgeScriptLoaded = true;

  let nextTokenPromiseId = 0;

  // Stores { resolve, reject } for ongoing token requests
  const pendingTokenPromises = {};

  // Listen for messages from the Host Application
  window.addEventListener('message', function(event) {

    const messageData = event.data;

  if (messageData && messageData.type === 'RESOLVE_NEW_FIREBASE_TOKEN') {
      const { success, token, error, promiseId } = messageData ?? {};
      if (pendingTokenPromises[promiseId]) {
        if (success) {
          pendingTokenPromises[promiseId].resolve(token);
        } else {
          pendingTokenPromises[promiseId].reject(new Error(error || 'Token refresh failed from host.'));
        }
        delete pendingTokenPromises[promiseId];
      }
    }
  });

  // Expose a function for the Generated App to request a new Firebase token
  window.requestNewFirebaseToken = function() {
    const currentPromiseId = nextTokenPromiseId++;
    const promise = new Promise((resolve, reject) => {
      pendingTokenPromises[currentPromiseId] = { resolve, reject };
    });
    if (window.parent && window.parent !== window) {
      window.parent.postMessage({
        type: 'REQUEST_NEW_FIREBASE_TOKEN',
        promiseId: currentPromiseId
      }, '*');
    } else {
      pendingTokenPromises[currentPromiseId].reject(new Error('No parent window to request token from.'));
      delete pendingTokenPromises[currentPromiseId];
    }
    return promise;
  };
})();</script><script>
let realOriginalGetUserMedia = null;
if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
  realOriginalGetUserMedia = navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);
}

(function() {
  if (navigator.mediaDevices && navigator.mediaDevices.__proto__) {
    try {
      Object.defineProperty(navigator.mediaDevices.__proto__, 'getUserMedia', {
        get: function() {
          return undefined; // Or throw an error
        },
        configurable: false
      });
    } catch (error) {
      console.error("Error defining prototype getter:", error);
    }
  }
})();

(function() {
  const pendingMediaResolvers = {};
  let nextMediaPromiseId = 0;

  function requestMediaPermissions(constraints) {
    const mediaPromiseId = nextMediaPromiseId++;
    const promise = new Promise((resolve, reject) => {
      pendingMediaResolvers[mediaPromiseId] = (granted) => {
        delete pendingMediaResolvers[mediaPromiseId];
        resolve(granted);
      };
    });

    window.parent.postMessage({
      type: 'requestMediaPermission',
      constraints: constraints,
      promiseId: mediaPromiseId,
    }, '*');

    return promise;
  }

  let originalGetUserMedia = realOriginalGetUserMedia;

  function interceptGetUserMedia() {
    if (navigator.mediaDevices) {
      Object.defineProperty(navigator.mediaDevices, 'getUserMedia', {
        value: function(constraints) {
          return requestMediaPermissions(constraints).then((granted) => {
            if (granted) {
              if (originalGetUserMedia) {
                return originalGetUserMedia(constraints);
              } else {
                throw new Error("Original getUserMedia not available.");
              }
            } else {
              throw new DOMException('Permission denied', 'NotAllowedError');
            }
          });
        },
        writable: false,
        configurable: false
      });
    }
  }

  interceptGetUserMedia();

  const observer = new MutationObserver(function(mutationsList, observer) {
    for (const mutation of mutationsList) {
      if (mutation.type === 'reconfigured' && mutation.name === 'getUserMedia' && mutation.object === navigator.mediaDevices) {
        interceptGetUserMedia();
      } else if (mutation.type === 'attributes' && mutation.attributeName === 'getUserMedia' && mutation.target === navigator.mediaDevices) {
        interceptGetUserMedia();
      } else if (mutation.type === 'childList' && mutation.addedNodes) {
        mutation.addedNodes.forEach(node => {
          if (node === navigator.mediaDevices) {
            interceptGetUserMedia();
          }
        });
      }
    }
  });

  function interceptSpeechRecognition() {
    if (!window.SpeechRecognition && !window.webkitSpeechRecognition) {
      return;
    }

    const OriginalSpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;

    const SpeechRecognitionWrapper = function(...args) {
      const recognizer = new OriginalSpeechRecognition(...args);
      const originalStart = recognizer.start.bind(recognizer);

      recognizer.start = function() {
        requestMediaPermissions({ audio: true }).then(granted => {
          if (granted) {
            originalStart();
          } else {
            const errorEvent = new SpeechRecognitionErrorEvent('error');
            errorEvent.error = 'not-allowed'; // This is the standard error for permission denial.
            recognizer.dispatchEvent(errorEvent);
          }
        });
      };

      return recognizer;
    };

    SpeechRecognitionWrapper.prototype = OriginalSpeechRecognition.prototype;
    SpeechRecognitionWrapper.prototype.constructor = SpeechRecognitionWrapper;

    if (window.SpeechRecognition) {
      window.SpeechRecognition = SpeechRecognitionWrapper;
    }
    if (window.webkitSpeechRecognition) {
      window.webkitSpeechRecognition = SpeechRecognitionWrapper;
    }
  }

  interceptSpeechRecognition();

  window.addEventListener('message', function(event) {
    if (event.data) {
      if (event.data.type === 'resolveMediaPermission') {
        const { promiseId, granted } = event.data;
        if (pendingMediaResolvers[promiseId]) {
          pendingMediaResolvers[promiseId](granted);
        }
      }
    }
  });

})();</script><script>((function(modelInformation) {
  const originalFetch = window.fetch;
  // TODO: b/421908508 - Move these out of the script and match all generative AI model calls.
  let googleLlmBaseApiUrls = [
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.textModelName + ':streamGenerateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.textModelName + ':generateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageModelName + ':predict',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageModelName + ':predictLongRunning',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageEditModelName + ':generateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageTransformModelName + ':generateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.videoModelName + ':predict',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.videoModelName + ':predictLongRunning',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.ttsModelName + ':generateContent',
  ];
  modelInformation.deprecatedTextModelNames.forEach((modelName) => {
    googleLlmBaseApiUrls.push(
      'https://generativelanguage.googleapis.com/v1beta/models/' + modelName + ':streamGenerateContent',
      'https://generativelanguage.googleapis.com/v1beta/models/' + modelName + ':generateContent',
    );
  });
  modelInformation.deprecatedImageModelNames.forEach((modelName) => {
    googleLlmBaseApiUrls.push(
      'https://generativelanguage.googleapis.com/v1beta/models/' + modelName + ':predict',
      'https://generativelanguage.googleapis.com/v1beta/models/' + modelName + ':predictLongRunning',
    );
  });

  const pendingFetchResolvers = {};
  let nextPromiseId = 0;

  function handleStringInput(input, optionsArgument) {
    const actualUrl = input;
    const fetchCallArgs = [actualUrl, optionsArgument];
    const effectiveOptions = optionsArgument || {};
    const bodyForApiKeyCheck = effectiveOptions.body;
    const bodyForPostMessage = effectiveOptions.body;
    return { actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage };
  }

  function handleRequestInput(input, optionsArgument) {
    const actualUrl = input.url;
    const fetchCallArgs = [input, optionsArgument];
    const effectiveOptions = { method: input.method, headers: new Headers(input.headers) };
    let bodyForApiKeyCheck;
    let bodyForPostMessage;

    if (optionsArgument) {
      if (optionsArgument.method) effectiveOptions.method = optionsArgument.method;
      if (optionsArgument.headers) effectiveOptions.headers = new Headers(optionsArgument.headers);
      if ('body' in optionsArgument) {
        bodyForApiKeyCheck = optionsArgument.body;
        bodyForPostMessage = optionsArgument.body;
      } else {
        bodyForApiKeyCheck = undefined;
        bodyForPostMessage = input.body;
      }
    } else {
      bodyForApiKeyCheck = undefined;
      bodyForPostMessage = input.body;
    }
    return { actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage };
  }

  window.fetch = function(input, optionsArgument) {
    let actualUrl;
    let fetchCallArgs;
    let effectiveOptions = {};
    let bodyForApiKeyCheck;
    let bodyForPostMessage;

    if (typeof input === 'string') {
      ({actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage} = handleStringInput(input, optionsArgument));
    } else if (input instanceof Request) {
      ({actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage} = handleRequestInput(input, optionsArgument));
    } else {
      return originalFetch.apply(window, [input, optionsArgument]);
    }

    effectiveOptions.method = effectiveOptions.method || 'GET';
    if (!effectiveOptions.headers) {
      effectiveOptions.headers = new Headers();
    }


    if (typeof actualUrl === 'string' && googleLlmBaseApiUrls.some((url) => actualUrl.startsWith(url))) {
      let apiKeyIsNull = true;

      const regex = new RegExp("models/([^:]+)");
      const modelNameMatch = actualUrl.match(regex);
      const modelName = modelNameMatch ? modelNameMatch[1] : 'unspecified';


      try {
        const urlObject = new URL(actualUrl);  // Use URL object for robust parsing
        const apiKeyParam = urlObject.searchParams.get('key');
        if (apiKeyParam) {
          apiKeyIsNull = false;
        }
      } catch (e) {
        // Continue checks even if URL parsing fails
      }

      if (apiKeyIsNull && effectiveOptions.headers) {
        const h = new Headers(effectiveOptions.headers);
        const apiKeyHeaderValue = h.get('X-API-Key') || h.get('x-api-key');
        if (apiKeyHeaderValue) {
          apiKeyIsNull = false;
          return originalFetch.apply(window, fetchCallArgs);
        }
      }

      if (apiKeyIsNull && effectiveOptions.method && ['POST', 'PUT', 'PATCH'].includes(effectiveOptions.method.toUpperCase()) && typeof bodyForApiKeyCheck === 'string') {
        try {
          const bodyData = JSON.parse(bodyForApiKeyCheck);
          if (bodyData && bodyData.apiKey) {
            apiKeyIsNull = false;
            return originalFetch.apply(window, fetchCallArgs);
          }
        } catch (e) {
          // Ignore JSON parsing errors
        }
      }

      if(apiKeyIsNull) {
        const promiseId = nextPromiseId++;
        const promise = new Promise((resolve) => {
          pendingFetchResolvers[promiseId] = (resolvedResponse) => {
            delete pendingFetchResolvers[promiseId];
            resolve(resolvedResponse);
          };
        });

        let serializedBodyForPostMessage;
        if (typeof bodyForPostMessage === 'string' || bodyForPostMessage == null) {
            serializedBodyForPostMessage = bodyForPostMessage;
        } else if (bodyForPostMessage instanceof ReadableStream) {
            serializedBodyForPostMessage = null;
        } else {
            try {
                serializedBodyForPostMessage = JSON.stringify(bodyForPostMessage);
            } catch (e) {
                serializedBodyForPostMessage = null;
            }
        }

        const messageOptions = {
            method: effectiveOptions.method,
            headers: Object.fromEntries(new Headers(effectiveOptions.headers).entries()),
            body: serializedBodyForPostMessage
        };

        window.parent.postMessage({
          type: 'requestFetch',
          url: actualUrl,
          modelName: modelName,
          options: messageOptions,
          promiseId: promiseId,
        }, '*');

        return promise;
      }
      return originalFetch.apply(window, fetchCallArgs);
    }
    return originalFetch.apply(window, fetchCallArgs);
  };

  window.addEventListener('message', function(event) {
    if (event.data && event.data.type === 'resolveFetch') {
      const { promiseId, response } = event.data;
      if (pendingFetchResolvers[promiseId]) {
        try {
          const reconstructedResponse = new Response(response.body, {
            status: response.status,
            statusText: response.statusText,
            headers: new Headers(response.headers),
          });
          pendingFetchResolvers[promiseId](reconstructedResponse);
        } catch (error) {
          pendingFetchResolvers[promiseId](new Response(null, { status: 500, statusText: "Interceptor Response Reconstruction Error" }));
        }
      }
    }
  });

}))({"textModelName":"gemini-2.5-flash-preview-09-2025","imageModelName":"imagen-4.0-generate-001","imageEditModelName":"gemini-2.5-flash-image-preview","imageTransformModelName":"gemini-2.5-flash-image-preview","videoModelName":"veo-2.0-generate-001","ttsModelName":"gemini-2.5-flash-preview-tts","deprecatedTextModelNames":["gemini-2.0-flash","gemini-2.5-flash-preview-04-17","gemini-2.5-flash-preview-05-20"],"deprecatedImageModelNames":["imagen-3.0-generate-001","imagen-3.0-generate-002"]})</script><script>(function() {
  const originalConsoleLog = console.log;
  const originalConsoleError = console.error;

    /**
   * Normalizes an error event or a promise rejection reason into a structured error object.
   * @param {*} errorEventOrReason The error object or reason.
   * @return {object} Structured error data { message, name, stack }.
   */
  function getErrorObject(errorEventOrReason) {
    if (errorEventOrReason instanceof Error) {
      return {
        message: errorEventOrReason.message,
        name: errorEventOrReason.name,
        stack: errorEventOrReason.stack,
      };
    }
    // Fallback for non-Error objects.
    try {
      return {
        message: JSON.stringify(errorEventOrReason),
        name: 'UnknownErrorType',
        stack: null,
      };
    } catch (e) {
      return {
        message: String(errorEventOrReason),
        name: 'UnknownErrorTypeNonStringifiable',
        stack: null,
      };
    }
  }

  /**
   * Converts an array of arguments (from log/error) into a single string.
   * Handles Error objects specially to include their message and stack.
   * @param {Array<*>} args - Arguments passed to console methods.
   * @return {string} A string representation of the arguments.
   */
  function stringifyArgs(args) {
    return args
      .map((arg) => {
        if (arg instanceof Error) {
          const {message, stack} = arg;
          return `Error: ${message}${stack ? ('\nStack: ' + stack) : ''}`;
        }
        if (typeof arg === 'object' && arg !== null) {
          try {
            return JSON.stringify(arg);
          } catch (error) {
            return '[Circular Object]';
          }
        } else {
          return String(arg);
        }
      })
      .join(' ');
  }

  console.log = function(...args) {
    const logString = stringifyArgs(args);
    window.parent.postMessage({ type: 'log', message: logString }, '*');
    originalConsoleLog.apply(console, args);
  };

  console.error = function(...args) {
    let errorData;
    if (args.length > 0 && args[0] instanceof Error) {
      const err = args[0];
      // If the first arg is an Error, capture its details.
      errorData = {
        type: 'error',
        source: 'CONSOLE_ERROR',
        ...getErrorObject(err),
        rawArgsString: stringifyArgs(args.slice(1)),
        timestamp: new Date().toISOString(),
      };
    } else {
      // If not an Error object, treat all args as a general error message.
      errorData = {
        type: 'error',
        source: 'CONSOLE_ERROR',
        message: stringifyArgs(args),
        name: 'ConsoleLoggedError',
        stack: null,
        timestamp: new Date().toISOString(),
      };
    }
    window.parent.postMessage(errorData, '*');
    originalConsoleError.apply(console, args);
  };

  // Listen for global unhandled synchronous errors.
  window.addEventListener('error', function(event) {
    const errorDetails = event.error ? getErrorObject(event.error) : {
      message: event.message,
      name: 'GlobalError',
      stack: null,
      filename: event.filename,
      lineno: event.lineno,
      colno: event.colno,
    };

    window.parent.postMessage({
      type: 'error',
      source: 'global',
      ...errorDetails,
      message: errorDetails.message || event.message,
      timestamp: new Date().toISOString(),
    }, '*');
  });

  // Listen for unhandled promise rejections (asynchronous errors).
  window.addEventListener('unhandledrejection', function(event) {
    const errorDetails = getErrorObject(event.reason);

    window.parent.postMessage({
      type: 'error',
      source: 'unhandledrejection',
      ...errorDetails,
      message: errorDetails.message || 'Unhandled Promise Rejection',
      timestamp: new Date().toISOString(),
    }, '*');
  });

})();</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2025年11月19日 金融市場日報|洞察•解構•透視全球資產</title>
    <meta name="description" content="2025年11月19日 金融市場日報|洞察•解構•透視全球資產">

    <style>
        /* 系統字體堆疊 */
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Noto Sans TC", Roboto, "Helvetica Neue", Arial, sans-serif;
            background: #f8fafc;
            line-height: 1.6;
            color: #1e293b;
            margin: 0;
            padding: 0;
        }

        /* 標題階層 - 字體大小已調換 */
        .main-title {
            font-size: 2.5rem; /* 原為 3.125rem */
            font-weight: 700;
            color: #1e293b;
            text-align: center;
            margin-bottom: 0.5rem;
            background: linear-gradient(to right, #4f46e5, #ec4899);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        /* --- v3.1.1 修正: 移除 max-width --- */
        .sub-title {
            font-size: 3.125rem; /* 原為 2.5rem */
            font-weight: 600;
            color: #2563eb;
            text-align: center;
            margin-top: 0.5rem;
            display: block;
            margin-left: auto;
            margin-right: auto;
            /* 移除 max-width */
        }

        @media (max-width: 768px) {
             /* 響應式字體大小已調換 */
            .main-title { font-size: 1.5rem; } /* 原為 1.875rem */
            .sub-title { font-size: 1.875rem; } /* 原為 1.5rem */
        }

        /* 章節與容器 */
        section { scroll-margin-top: 120px; }
        h2 {
            font-size: 1.5rem;
            font-weight: 700;
            margin: 0.5rem 0 1.5rem 0;
            display: flex;
            align-items: center;
        }
        h3.table-title {
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: 1rem;
            text-align: left;
            color: #374151;
        }

        .container {
            max-width: 80rem;
            margin: 0 auto;
            padding: 1rem;
        }
        @media (min-width: 768px) {
            .container { padding: 2rem; }
        }

        /* 表格樣式 */
        .table-styled {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            margin: 1rem 0;
        }
        .table-styled caption {
            padding: 1rem;
            font-weight: 600;
            text-align: left;
            background: #f8fafc;
            border-bottom: 1px solid #e2e8f0;
            caption-side: top;
        }
        .table-styled thead th {
            background: #f1f5f9;
            padding: 0.75rem;
            font-weight: 600;
            color: #374151;
            border-bottom: 2px solid #e5e7eb;
            position: sticky;
            top: 0;
            text-align: center;
        }
        .table-styled thead th:first-child {
            text-align: left;
        }
        .table-styled tbody td {
            padding: 0.75rem;
            border-bottom: 1px solid #f1f5f9;
            font-weight: 400; /* 強制所有表格內容為正常字重 */
            text-align: center;
        }
        .table-styled tbody td:first-child {
            text-align: left;
            font-weight: 500; /* 第一欄稍加強調 */
        }
        /* 強制表格內容非粗體 */
        .table-styled tbody td strong {
             font-weight: normal !important;
        }
        /* 允許特定行加粗 */
         .table-styled tbody tr.summary-row td {
            font-weight: 600 !important; /* 針對總計行加粗 */
            border-top: 2px solid #e5e7eb;
         }


        /* 漲跌顏色 */
        .text-up { color: #dc2626; font-weight: 600; }
        .text-down { color: #059669; font-weight: 600; }
        .text-flat { color: #6b7280; font-weight: 500; }

        /* 熱度條 */
        .heat-container {
            margin: 1rem 0;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        .heat-item {
            display: flex;
            align-items: center;
            background: #f1f5f9;
            border-radius: 8px;
            overflow: hidden;
            position: relative;
            height: 2.5rem;
        }
        .heat-bar {
            display: flex;
            align-items: center;
            justify-content: flex-start; /* 文字靠左 */
            padding: 0.5rem 1rem;
            font-weight: 700;
            font-size: 1rem;
            color: white;
            height: 100%;
            border-radius: 8px 0 0 8px; /* 只有左邊圓角 */
            transition: all 0.3s ease;
            white-space: nowrap; /* 防止文字換行 */
            overflow: hidden; /* 隱藏超出部分 */
            text-overflow: ellipsis; /* 超出部分顯示省略號 */
        }
        .heat-bar-1 { background: #dc2626; width: 100%; border-radius: 8px; } /* 100% 兩邊都圓角 */
        .heat-bar-2 { background: #dc2626; width: 92%; }
        .heat-bar-3 { background: #ea580c; width: 84%; }
        .heat-bar-4 { background: #ea580c; width: 76%; }
        .heat-bar-5 { background: #d97706; width: 68%; }
        .heat-bar-6 { background: #d97706; width: 60%; }
        .heat-bar-7 { background: #eab308; width: 52%; color: #1f2937; }
        .heat-bar-8 { background: #eab308; width: 44%; color: #1f2937; }
        .heat-bar-9 { background: #84cc16; width: 36%; color: #1f2937; }
        .heat-bar-10 { background: #84cc16; width: 28%; color: #1f2937; }

        /* 卡片 */
        .section-card {
            background: white;
            border-radius: 16px;
            padding: 2rem;
            margin: 2rem 0;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            border-left: 4px solid transparent;
            transition: all 0.3s ease;
        }
        .section-card:first-child { margin-top: 0.5rem; }
        .section-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
            border-left-color: #4f46e5;
        }

        /* 導覽列 */
        .nav-sticky {
            position: sticky;
            top: 0;
            z-index: 50;
            background: rgba(255, 255, 255, 0.95);
            border-bottom: 1px solid #e2e8f0;
            padding: 1rem;
            backdrop-filter: blur(8px);
        }
        .nav-content {
            max-width: 80rem;
            margin: 0 auto;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow-x: auto;
            scroll-behavior: smooth;
            scrollbar-width: none; /* Firefox */
        }
        .nav-content::-webkit-scrollbar { display: none; } /* Chrome, Safari, Opera */
        .nav-links-group {
            display: flex;
            gap: 1rem;
            font-size: 0.875rem;
            white-space: nowrap;
            align-items: center;
            min-width: fit-content;
        }
        .nav-links-group a {
            padding: 0.5rem 1rem;
            border-radius: 8px;
            text-decoration: none;
            background: #dc2626;
            color: white;
            font-weight: 700;
            transition: all 0.2s ease;
            white-space: nowrap;
            flex-shrink: 0;
        }
        .nav-links-group a:hover {
            background: #b91c1c;
            transform: translateY(-1px);
        }
        .nav-links-group .download-btn {
            background: #059669;
            color: white;
            border: none;
            border-radius: 8px;
            padding: 0.5rem 1rem;
            font-size: 0.875rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            white-space: nowrap;
            flex-shrink: 0;
        }
        .nav-links-group .download-btn:hover {
            background: #047857;
            transform: translateY(-1px);
        }

        /* 時間軸標籤 */
        .timeline-tag {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-right: 0.75rem;
            vertical-align: top;
        }
        .timeline-tag-taiwan { background: #f1f5f9; color: #1e293b; }
        .timeline-tag-us { background: #f1f5f9; color: #dc2626; }
        .timeline-container p {
            margin: 0;
            padding: 0.125rem 0;
            line-height: 1.4;
             /* 字數控制由JS確保, CSS不強制 */
        }

        /* --- v3.1.9 保持 v3.1.8 的深度分析格式 --- */
        /* --- v3.1.10 維持 v3.1.9 (即 v2.8) 的深度分析格式 --- */
        .analysis-block {
            background: #fffbeb; /* 淺黃色背景 */
            border-left: 4px solid #f59e0b; /* 琥珀色左邊框 */
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 8px;
        }
        .analysis-block h4 { /* v2.8 "深度分析:" 標題樣式 */
            font-weight: 600;
            color: #92400e; /* 深琥珀色 */
            margin-bottom: 1rem;
            font-size: 1.125rem;
        }
        .structured-analysis p { /* v2.8 分析段落樣式 */
            line-height: 1.75;
            margin-bottom: 1rem;
        }
        .structured-analysis p:last-child {
            margin-bottom: 0;
        }
        .structured-analysis strong { /* v2.8 段落內粗體標題樣式 */
             display: inline; /* 與內容同行 */
             margin-right: 0.5em; /* 和內容稍微隔開 */
             color: #92400e; /* 深琥珀色 */
             font-size: 1rem;
             font-weight: 700;
        }
         /* v2.8 不使用 br 換行 */
         .structured-analysis br {
            display: none;
         }

        /* 市場數據卡片 */
        .market-overview-custom { margin: 1.5rem 0; }
        .market-overview-row-1 {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }
        /* --- v3.1.3 修正: 並排斷點改為 lg --- */
        .grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); } /* For Top10/Timeline */
        .grid-cols-1 { grid-template-columns: repeat(1, minmax(0, 1fr)); } /* Default for small screens */
        @media (min-width: 1024px) { /* lg breakpoint */
          .lg\:grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }
        }

        .market-overview-row-2 {
            display: grid;
            grid-template-columns: 1fr 3fr; /* 保持1:3比例 */
            gap: 1.5rem;
        }
        .market-card-new {
            background: white;
            border-radius: 12px;
            padding: 1.25rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            transition: all 0.2s ease;
            display: flex; /* 使用 Flexbox 布局 */
            flex-direction: column; /* 垂直排列 */
            justify-content: space-between; /* 內容均勻分布 */
            min-height: 120px; /* 設定最小高度 */
        }
        .market-card-new:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }
        .market-card-new.us-stock { border-left: 4px solid #dc2626; }
        .market-card-new.tw-stock { border-left: 4px solid #059669; }
        .market-card-new.bond { border-left: 4px solid #2563eb; }
        .market-card-new.commodity { border-left: 4px solid #f59e0b; }
        .market-card-new.fx { border-left: 4px solid #0891b2; }
        .market-card-title-new {
            font-size: 0.875rem;
            font-weight: 600;
            color: #6b7280;
            margin-bottom: 0.5rem;
        }
        .market-card-value-new {
            font-size: 1.125rem;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 0.5rem;
        }
         .market-card-value-new strong { font-weight: 700 !important; } /* 確保卡片數值加粗 */
        .market-card-change-new {
            font-size: 0.75rem;
            font-weight: 500;
            margin-top: auto; /* 將描述文字推到底部 */
        }
         .market-card-change-new strong { font-weight: bold !important; } /* 確保卡片漲跌幅加粗 */


        /* --- v3.1.9 維持 v3.1.8 的第7章表格樣式 (源自v2.8) --- */
        /* --- v3.1.10 維持 v3.1.9 (即 v2.8) 的第7章表格樣式 --- */
        .analysis-table { /* v2.8 style */
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            margin: 1rem 0;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            border-spacing: 0;
            table-layout: fixed;
        }
        .analysis-table th:first-child, .analysis-table td:first-child {
            width: 30%; /* v2.8 寬度 */
            padding-left: 0.75rem;
            vertical-align: top;
        }
        .analysis-table th:last-child, .analysis-table td:last-child {
            width: 70%; /* v2.8 寬度 */
            padding-right: 0.75rem;
            vertical-align: top;
        }
        .analysis-table td { /* v2.8 style */
            padding-top: 0.75rem;
            padding-bottom: 0.75rem;
            border-bottom: 1px solid #f1f5f9;
            word-wrap: break-word;
            text-align: left; /* v2.8 靠左對齊 */
            font-weight: 400 !important; /* 強制非粗體 */
        }
        .analysis-table th { /* v2.8 style */
            background: #f8fafc;
            padding-top: 0.75rem;
            padding-bottom: 0.75rem;
            font-weight: 600;
            text-align: left;
            color: #374151;
        }
        .analysis-table td strong { font-weight: normal !important; } /* 強制非粗體 */
        .analysis-table .font-semibold { font-weight: 600 !important; } /* 允許維度名稱加粗 */


        /* 個股推薦卡片 */
        .stock-recommendation {
            background: white;
            border-radius: 12px;
            padding: 2rem;
            margin: 2rem 0;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        /* --- v3.1.9 維持 v3.1.8 的 class name (源自v2.8) --- */
        /* --- v3.1.10 維持 v3.1.9 (即 v2.8) 的 class name (修改買進/賣出為看多/看空) --- */
        .stock-recommendation.bullish { border-left: 4px solid #059669; } /* 改為 bullish */
        .stock-recommendation.bearish { border-left: 4px solid #dc2626; } /* 改為 bearish */
        .recommendation-title {
            font-size: 1.125rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
        }
        /* --- v3.1.9 維持 v3.1.8 的 class name (源自v2.8) --- */
        /* --- v3.1.10 維持 v3.1.9 (即 v2.8) の class name (修改買進/賣出為看多/看空) --- */
        .recommendation-title.bullish { color: #059669; } /* 改為 bullish */
        .recommendation-title.bearish { color: #dc2626; } /* 改為 bearish */


        /* --- v3.1.9 維持 v3.1.8 的第7章按鈕樣式 (源自v2.8) --- */
        /* --- v3.1.10 維持 v3.1.9 (即 v2.8) 的第7章按鈕樣式 --- */
        .link-button-container { /* v2.8 container */
             display: flex;
             flex-direction: column;
             gap: 0.5rem;
             width: 100%; /* 確保容器寬度 */
             align-items: flex-start; /* 按鈕靠左 */
        }
        .link-button { /* v2.8 style */
            display: block; /* 改回 block */
            padding: 0.6rem 0.8rem;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.2s ease;
            text-align: center;
            width: 95%; /* 調整寬度 */
            max-width: 150px; /* 最大寬度 */
            margin: 0; /* 移除 auto margin */
            font-size: 0.875rem;
            box-sizing: border-box; /* 包含 padding */
        }
        .link-button.fundamental { background: #2563eb; color: white; }
        .link-button.fundamental:hover { background: #1d4ed8; }
        .link-button.technical { background: #374151; color: white; }
        .link-button.technical:hover { background: #111827; }
        .link-button-subtitle {
            display: block;
            font-size: 0.75rem;
            font-weight: 400;
            opacity: 0.9;
            margin-top: 0.25rem;
        }


        /* 回頂按鈕 */
        .back-to-top {
            position: fixed;
            left: 1.5rem;
            bottom: 1.5rem;
            background: #4f46e5;
            color: white;
            border: none;
            border-radius: 50%;
            width: 48px;
            height: 48px;
            font-size: 1.125rem;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 40;
            transition: all 0.2s ease;
        }
        .back-to-top:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
        }

        /* 進度條 */
        .progress-bar {
            height: 3px;
            background: #4f46e5;
            position: fixed;
            top: 0;
            left: 0;
            z-index: 100;
            transition: width 0.3s ease;
        }

        /* 網格佈局 (通用) */
        .grid { display: grid; }
        .gap-8 { gap: 2rem; }

        /* TL;DR區塊 */
        .tldr-block {
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1.5rem;
        }
        .tldr-block ul {
            list-style: none;
            padding: 0;
            margin: 0;
            font-size: 1rem;
        }
        /* --- v3.1.1 修正: 移除 max-width --- */
        .tldr-block li {
            margin: 0.75rem 0;
            padding-left: 1rem;
            position: relative;
            /* 移除 max-width */
        }
        .tldr-block li::before {
            content: "•";
            position: absolute;
            left: 0;
            font-weight: 700;
        }
         /* --- v3.1.10 修正: TL;DR 區塊內的 strong 標籤改為粗體 --- */
         .tldr-block li strong {
            font-weight: 700 !important;
         }

        /* 響應式 */
        @media (max-width: 1024px) {
            .market-overview-row-1 { grid-template-columns: repeat(2, 1fr); }
            /* lg斷點以下 (平板) Top10/時間軸垂直排列已由上方 grid-cols-1 處理 */
        }
        @media (max-width: 768px) {
            .grid-cols-2, .lg\:grid-cols-2 { grid-template-columns: 1fr; } /* 手機全部垂直排列 */
            .market-overview-row-1,
            .market-overview-row-2 { grid-template-columns: 1fr; }
            .back-to-top { left: 1rem; bottom: 5rem; }
            /* --- v3.1.9 維持 v3.1.8 的手機表格寬度 --- */
            /* --- v3.1.10 維持 v3.1.9 (即 v2.8) 的第7章手機表格寬度 --- */
            .analysis-table th:first-child, .analysis-table td:first-child {
                width: 40%; /* v2.8 手機版寬度 */
            }
            .analysis-table th:last-child, .analysis-table td:last-child {
                width: 60%; /* v2.8 手機版寬度 */
            }

            .nav-content {
                justify-content: flex-start;
                padding-left: 0.5rem;
                padding-right: 0.5rem;
            }
            .nav-links-group { gap: 0.75rem; }
        }

        /* 工具類 */
        .text-center { text-align: center; }
        .text-right { text-align: right; }
        .font-semibold { font-weight: 600; }
        .text-xs { font-size: 0.75rem; }
        .mt-4 { margin-top: 1rem; }
        .overflow-x-auto { overflow-x: auto; }

        @media print {
            .nav-sticky, .back-to-top, .download-btn, .progress-bar { display: none; }
        }
    </style>
</head>
<body>

<!-- 進度條 -->
<div class="progress-bar" id="progressBar" style="width: 0%; opacity: 0; transition: opacity 0.5s ease-out; display: none;"></div>

<!-- 導覽工具列 -->
<div class="nav-sticky">
    <div class="nav-content">
        <div class="nav-links-group">
            <a href="#sec-1">市場總覽</a>
            <a href="#sec-2">歐美股市</a>
            <a href="#sec-3">債券市場</a>
            <a href="#sec-4">大宗商品</a>
            <a href="#sec-5">台股解析</a>
            <a href="#sec-6">匯率市場</a>
            <a href="#sec-7">產業展望</a>
            <button class="download-btn" id="smartDownloadBtn">🔥 下載日報</button>
        </div>
    </div>
</div>

<div class="container">

    <!-- 標題 -->
    <header style="text-align: center; margin: 0;">
        <h1 class="main-title" style="margin: 0; margin-bottom: 0.125rem;">2025年11月19日 金融市場日報</h1>
        <p class="sub-title" style="margin: 0;">費半跌逾2%,輝達財報前夕市場避險升溫</p>
    </header>

    <!-- 第1章:市場總覽與重點 -->
    <section id="sec-1" class="section-card">
        <h2 style="color: #015fb4;"><span style="margin-right: 0.75rem;">📋</span>第1章｜市場總覽與重點</h2>

        <div class="tldr-block" style="background: #f0f9ff;">
            <h3 class="table-title">市場三大要點</h3>
            <ul>
                <li style="color: #015fb4;"><strong>科技股賣壓湧現：</strong>輝達財報公布在即，市場擔憂AI估值過高，費城半導體指數重挫2.31%，科技巨頭普遍回檔修正。</li>
                <li style="color: #015fb4;"><strong>台股遭外資提款：</strong>台股重挫691點摜破27000點關卡，外資單日大賣485億元，權值股全線走弱，股匯雙殺格局成形。</li>
                <li style="color: #015fb4;"><strong>避險資產走勢分歧：</strong>儘管股市動盪，黃金微幅收黑，WTI原油反彈逾1%，美元指數持平，市場靜待更多經濟數據指引。</li>
            </ul>
        </div>

        <div class="market-overview-custom">
            <h3 class="table-title">市場核心數據速覽</h3>
            <div class="market-overview-row-1">
                <div class="market-card-new us-stock">
                    <div class="market-card-title-new">美股市場</div>
                    <div class="market-card-value-new">費城半導體 <strong>6,551.03</strong></div>
                    <div class="market-card-change-new text-up">▼ <strong>-2.31%</strong> • 輝達財報前夕避險，半導體族群領跌。</div>
                </div>
                <div class="market-card-new tw-stock">
                    <div class="market-card-title-new">台股市場</div>
                    <div class="market-card-value-new">加權 <strong>26,756.12</strong></div>
                    <div class="market-card-change-new text-up">▼ <strong>-2.52%</strong> • 外資大賣485億，指數重挫近700點。</div>
                </div>
                <div class="market-card-new bond">
                    <div class="market-card-title-new">債券市場</div>
                    <div class="market-card-value-new">10年期殖利率 <strong>4.12%</strong></div>
                    <div class="market-card-change-new text-down">▼ <strong>-1.0 bps</strong> • 避險買盤進場，殖利率高檔微幅回落。</div>
                </div>
                <div class="market-card-new commodity">
                    <div class="market-card-title-new">大宗商品</div>
                    <div class="market-card-value-new">黃金期貨 <strong>4,067.40</strong></div>
                    <div class="market-card-change-new text-up">▼ <strong>-0.02%</strong> • 降息預期波動，金價高檔震盪，布蘭特 +0.25%。</div>
                </div>
            </div>
            <div class="market-overview-row-2">
                <div class="market-card-new fx">
                    <div class="market-card-title-new">匯率市場</div>
                    <div class="market-card-value-new">美元指數 <strong>99.58</strong></div>
                    <div class="market-card-change-new text-down">▼ <strong>-0.01%</strong> • 市場觀望聯準會動向，美元指數橫盤整理。</div>
                </div>
                <div></div>
            </div>
        </div>

         <!-- --- v3.1.3 修正: 並排斷點改為 lg --- -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <div>
                <h3 class="table-title">Top 10 市場熱點事件榜</h3>
                <div class="heat-container">
                    <div class="heat-item"><div class="heat-bar heat-bar-1">輝達財報觀望</div></div>
                    <div class="heat-item"><div class="heat-bar heat-bar-2">台股重挫近700點</div></div>
                    <div class="heat-item"><div class="heat-bar heat-bar-3">外資大逃殺</div></div>
                    <div class="heat-item"><div class="heat-bar heat-bar-4">比特幣跌破9萬</div></div>
                    <div class="heat-item"><div class="heat-bar heat-bar-5">中日關係急凍</div></div>
                    <div class="heat-item"><div class="heat-bar heat-bar-6">俄油港恢復出口</div></div>
                    <div class="heat-item"><div class="heat-bar heat-bar-7">美國就業疲軟</div></div>
                    <div class="heat-item"><div class="heat-bar heat-bar-8">AI估值疑慮</div></div>
                    <div class="heat-item"><div class="heat-bar heat-bar-9">日股暴跌</div></div>
                    <div class="heat-item"><div class="heat-bar heat-bar-10">川普聯準會人選</div></div>
                </div>
                <p class="text-xs" style="color: #64748b; margin-top: 0.5rem;">*熱度基於過去24小時新聞與社群討論量標準化</p>
            </div>
            <div>
                <h3 class="table-title">市場關鍵時間軸</h3>
                <div class="structured-analysis space-y-4 timeline-container">
                    <p><span class="timeline-tag timeline-tag-taiwan">台股盤前</span> 09:00 台股開盤跳水,權值股全線走弱,指數迅速跌破二萬七千點關卡。</p>
                    <p><span class="timeline-tag timeline-tag-taiwan">台股盤中</span> 盤中賣壓湧現,電子金融傳產無一倖免,恐慌情緒蔓延導致跌幅擴大。</p>
                    <p><span class="timeline-tag timeline-tag-taiwan">台股盤後</span> 14:30 台股收盤重挫近七百點,外資單日賣超逾四百八十億元,創波段新低。</p>
                    <p><span class="timeline-tag timeline-tag-taiwan">台股盤後</span> 16:00 三大法人合計賣超逾七百億元,自營商大舉調節,市場信心遭受重擊。</p>
                    <p><span class="timeline-tag timeline-tag-taiwan">台股盤後</span> 19:49 台幣匯率重貶,收盤創半年新低,資金外流壓力沉重,股匯雙殺格局成形。</p>
                    <p><span class="timeline-tag timeline-tag-us">美股盤前</span> 21:30 美國公布最新房市數據,營建許可不如預期,顯示高利率持續壓抑房市需求。</p>
                    <p><span class="timeline-tag timeline-tag-us">美股盤中</span> 輝達財報發布前夕市場觀望,科技股賣壓沈重,那斯達克指數盤中走弱。</p>
                    <p><span class="timeline-tag timeline-tag-us">美股盤中</span> 俄羅斯油港恢復出口緩解供應擔憂,原油價格小幅回落,能源股隨之調整。</p>
                    <p><span class="timeline-tag timeline-tag-us">美股盤中</span> 投資人擔憂聯準會降息路徑不確定,公債殖利率高檔震盪,壓抑風險資產。</p>
                    <p><span class="timeline-tag timeline-tag-us">美股盤後</span> 05:00 美股收盤全線下跌,費半指數重挫逾百分之二,科技巨頭普遍修正。</p>
                </div>
            </div>
        </div>
    </section>

    <!-- 第2章:歐美股市 -->
    <section id="sec-2" class="section-card">
        <h2 style="color: #dc2626;"><span style="margin-right: 0.75rem;">📈</span>第2章｜歐美股市</h2>

        <div class="tldr-block" style="background: #fef2f2;">
            <ul>
                <li style="color: #dc2626;"><strong>科技估值修正：</strong>輝達財報發布前夕，市場擔憂AI泡沫風險，導致科技股湧現賣壓，費城半導體指數重挫2.31%。</li>
                <li style="color: #dc2626;"><strong>市場避險升溫：</strong>隨著川普交易熱度消退及地緣政治風險仍存，資金從風險資產撤出，導致主要指數全面收黑。</li>
                <li style="color: #dc2626;"><strong>降息預期分歧：</strong>經濟數據表現不一，市場對聯準會12月降息的信心動搖，加劇了市場觀望氛圍與波動性。</li>
            </ul>
        </div>

        <h3 class="table-title">歐美主要股市行情</h3>
        <div class="overflow-x-auto">
            <table class="table-styled">
                <caption>歐美主要股市指數漲跌概覽</caption>
                <thead>
                    <tr>
                        <th>指標名稱</th>
                        <th>最新收盤價</th>
                        <th>日漲跌</th>
                        <th>五日漲跌</th>
                        <th>月漲跌</th>
                        <th>季漲跌</th>
                        <th>年初至今</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>道瓊工業指數</td>
                        <td><strong>46,091.74</strong></td>
                        <td class="text-up"><strong>-1.07%</strong></td>
                        <td class="text-up"><strong>-2.70%</strong></td>
                        <td class="text-up"><strong>-0.21%</strong></td>
                        <td class="text-down"><strong>+2.55%</strong></td>
                        <td class="text-down"><strong>+8.34%</strong></td>
                    </tr>
                    <tr>
                        <td>標普500</td>
                        <td><strong>6,617.32</strong></td>
                        <td class="text-up"><strong>-0.83%</strong></td>
                        <td class="text-up"><strong>-3.15%</strong></td>
                        <td class="text-up"><strong>-0.70%</strong></td>
                        <td class="text-down"><strong>+2.60%</strong></td>
                        <td class="text-down"><strong>+12.51%</strong></td>
                    </tr>
                    <tr>
                        <td>那斯達克</td>
                        <td><strong>22,432.85</strong></td>
                        <td class="text-up"><strong>-1.21%</strong></td>
                        <td class="text-up"><strong>-4.65%</strong></td>
                        <td class="text-up"><strong>-1.09%</strong></td>
                        <td class="text-down"><strong>+3.75%</strong></td>
                        <td class="text-down"><strong>+16.17%</strong></td>
                    </tr>
                    <tr>
                        <td>費城半導體指數</td>
                        <td><strong>6,551.03</strong></td>
                        <td class="text-up"><strong>-2.31%</strong></td>
                        <td class="text-up"><strong>-8.47%</strong></td>
                        <td class="text-up"><strong>-3.35%</strong></td>
                        <td class="text-down"><strong>+13.88%</strong></td>
                        <td class="text-down"><strong>+31.55%</strong></td>
                    </tr>
                    <tr>
                        <td>羅素2000</td>
                        <td><strong>2,348.74</strong></td>
                        <td class="text-down"><strong>+0.31%</strong></td>
                        <td class="text-up"><strong>-4.35%</strong></td>
                        <td class="text-up"><strong>-4.22%</strong></td>
                        <td class="text-down"><strong>+2.72%</strong></td>
                        <td class="text-down"><strong>+5.32%</strong></td>
                    </tr>
                    <tr>
                        <td>道瓊歐洲50</td>
                        <td><strong>5,534.71</strong></td>
                        <td class="text-up"><strong>-1.88%</strong></td>
                        <td class="text-up"><strong>-2.29%</strong></td>
                        <td class="text-up"><strong>-1.30%</strong></td>
                        <td class="text-down"><strong>+1.58%</strong></td>
                        <td class="text-down"><strong>+13.67%</strong></td>
                    </tr>
                </tbody>
            </table>
        </div>
        <p class="text-xs text-right" style="color: #64748b; margin-top: 0.5rem;">資料來源: Yahoo Finance</p>

        <!-- --- v3.1.9 替換: 深度分析區塊使用 v2.8 格式 --- -->
        <div class="analysis-block">
            <h4>深度分析:</h4>
            <div class="structured-analysis">
                 <p><strong>輝達財報前夕與川普交易退燒，導致科技股估值修正</strong><br>市場焦點轉向即將公布的輝達財報，投資人對AI泡沫的擔憂重燃，加上川普當選後的政策紅利預期逐漸消退，導致資金從高估值的科技股撤出。費城半導體指數大跌<strong>2.31%</strong>，那斯達克指數亦下跌<strong>1.21%</strong>，顯示市場風險偏好顯著降溫。軟體與硬體巨頭同步走弱，反映出市場對於未來資本支出回報率的疑慮正在上升，避險情緒主導了盤面走勢。</p>
                 <p><strong>AI資本支出回報率受質疑，需關注輝達財測指引</strong><br>當前最大風險在於市場對AI基礎建設的高額投入能否轉化為實質獲利開始產生分歧。關鍵訊號顯示VIX恐慌指數上升，若輝達財測不如預期，恐引發更深層的科技股去槓桿化效應。深層解讀來看，這波修正反映了市場對「完美定價」的重新評估。建議投資人密切關注那斯達克指數在<strong>22,000點</strong>附近的支撐力道，以及半導體供應鏈的庫存去化狀況。</p>
            </div>
        </div>
    </section>

    <!-- 第3章:債券市場 -->
    <section id="sec-3" class="section-card">
        <h2 style="color: #2563eb;"><span style="margin-right: 0.75rem;">🏛️</span>第3章｜債券市場</h2>

        <div class="tldr-block" style="background: #eff6ff;">
            <ul>
                <li style="color: #2563eb;"><strong>降息預期分歧：</strong>聯準會官員言論鷹鴿交錯，市場對12月降息與否看法分歧，導致債市缺乏明確方向，殖利率區間震盪。</li>
                <li style="color: #2563eb;"><strong>長債需求回溫：</strong>股市動盪引發部分資金轉入債市避險，推動10年期公債價格小幅反彈，殖利率微幅回落至4.12%。</li>
                <li style="color: #2563eb;"><strong>信用風險可控：</strong>儘管股市下跌，高收益債與新興市場債表現相對平穩，顯示市場目前並未過度擔憂企業違約風險。</li>
            </ul>
        </div>

        <h3 class="table-title">主要債券與殖利率行情</h3>
        <div class="overflow-x-auto">
            <table class="table-styled">
                <caption>主要債券與殖利率變動概覽</caption>
                <thead>
                    <tr>
                        <th>指標名稱</th>
                        <th>最新殖利率/價格</th>
                        <th>日變動</th>
                        <th>五日變動</th>
                        <th>月變動</th>
                        <th>季變動</th>
                        <th>年初至今變動</th>
                    </tr>
                </thead>
                <!-- --- v3.1.2 修正: 補齊表格行佔位符 --- -->
                <tbody>
                    <tr>
                        <td>美國3月期殖利率</td>
                        <td><strong>3.77%</strong></td>
                        <td class="text-flat"><strong>+0.0 bps</strong></td>
                        <td class="text-down"><strong>-1.1 bps</strong></td>
                        <td class="text-down"><strong>-6.0 bps</strong></td>
                        <td class="text-down"><strong>-34.0 bps</strong></td>
                        <td class="text-down"><strong>-43.6 bps</strong></td>
                    </tr>
                    <tr>
                        <td>美國5年期殖利率</td>
                        <td><strong>3.69%</strong></td>
                        <td class="text-down"><strong>-2.7 bps</strong></td>
                        <td class="text-down"><strong>-1.6 bps</strong></td>
                        <td class="text-up"><strong>+10.2 bps</strong></td>
                        <td class="text-down"><strong>-15.1 bps</strong></td>
                        <td class="text-down"><strong>-68.6 bps</strong></td>
                    </tr>
                    <tr>
                        <td>美國10年期殖利率</td>
                        <td><strong>4.12%</strong></td>
                        <td class="text-down"><strong>-1.0 bps</strong></td>
                        <td class="text-up"><strong>+1.3 bps</strong></td>
                        <td class="text-up"><strong>+11.6 bps</strong></td>
                        <td class="text-down"><strong>-20.5 bps</strong></td>
                        <td class="text-down"><strong>-45.0 bps</strong></td>
                    </tr>
                    <tr>
                        <td>美國30年期殖利率</td>
                        <td><strong>4.74%</strong></td>
                        <td class="text-up"><strong>+0.7 bps</strong></td>
                        <td class="text-up"><strong>+4.1 bps</strong></td>
                        <td class="text-up"><strong>+14.0 bps</strong></td>
                        <td class="text-down"><strong>-18.3 bps</strong></td>
                        <td class="text-down"><strong>-4.3 bps</strong></td>
                    </tr>
                    <tr>
                        <td>高收益債券ETF(HYG)</td>
                        <td><strong>80.11</strong></td>
                        <td class="text-down"><strong>+0.02%</strong></td>
                        <td class="text-up"><strong>-0.61%</strong></td>
                        <td class="text-up"><strong>-0.76%</strong></td>
                        <td class="text-up"><strong>-0.43%</strong></td>
                        <td class="text-down"><strong>+1.86%</strong></td>
                    </tr>
                    <tr>
                        <td>新興市場美元債ETF(EMB)</td>
                        <td><strong>95.96</strong></td>
                        <td class="text-up"><strong>-0.03%</strong></td>
                        <td class="text-up"><strong>-0.29%</strong></td>
                        <td class="text-down"><strong>+0.23%</strong></td>
                        <td class="text-down"><strong>+2.25%</strong></td>
                        <td class="text-down"><strong>+7.77%</strong></td>
                    </tr>
                </tbody>
            </table>
        </div>
        <p class="text-xs text-right" style="color: #64748b; margin-top: 0.5rem;">資料來源: Yahoo Finance</p>

        <!-- --- v3.1.9 替換: 深度分析區塊使用 v2.8 格式 --- -->
        <div class="analysis-block">
            <h4>深度分析:</h4>
            <div class="structured-analysis">
                <p><strong>經濟數據多空交雜，殖利率曲線倒掛程度未變</strong><br>美國近期公布的房市與就業數據好壞參半，加上聯準會官員對於通膨前景的看法不一，導致市場對未來降息路徑的預期出現分歧。資金在觀望中尋找方向，10年期公債殖利率微幅下跌<strong>1.0 bps</strong>至<strong>4.12%</strong>，而短債殖利率波動相對有限，殖利率曲線倒掛的結構性問題依然存在，反映出市場對經濟軟著陸的信心仍需更多數據佐證。</p>
                <p><strong>企業發債與避險需求拉鋸，信用利差維持低檔</strong><br>當前債市面臨企業年底前發債鎖定資金成本的供給壓力，與股市修正引發的避險需求之間的拉鋸。關鍵訊號在於投資級債券利差維持在相對低檔，且高收益債券ETF(HYG)在股市下跌時仍逆勢微漲<strong>0.02%</strong>，顯示信用風險尚未全面惡化。深層解讀指出，市場資金充裕，對收益率的追求仍支撐著債券價格，下檔具備一定承接力道。</p>
            </div>
        </div>
    </section>

    <!-- 第4章:大宗商品 -->
    <section id="sec-4" class="section-card">
        <h2 style="color: #cc4e01;"><span style="margin-right: 0.75rem;">🔥</span>第4章｜大宗商品</h2>

        <div class="tldr-block" style="background: #fffbeb;">
            <ul>
                <li style="color: #cc4e01;"><strong>油價技術反彈：</strong>儘管俄羅斯油港恢復出口消息緩解供應擔憂，但技術性買盤進場推升油價，WTI原油反彈1.27%重回60美元。</li>
                <li style="color: #cc4e01;"><strong>金價高檔震盪：</strong>美元指數維持高檔，壓抑黃金上漲空間，金價在4067美元附近狹幅整理，市場等待新的催化劑。</li>
                <li style="color: #cc4e01;"><strong>基本金屬疲軟：</strong>全球經濟成長放緩的擔憂持續影響工業金屬需求預期，基礎金屬ETF(DBB)下跌0.52%，表現相對弱勢。</li>
            </ul>
        </div>

        <h3 class="table-title">能源與商品市場行情</h3>
        <div class="overflow-x-auto">
            <table class="table-styled">
                <caption>能源與商品市場價格變動概覽</caption>
                <thead>
                    <tr>
                        <th>指標名稱</th>
                        <th>最新價格</th>
                        <th>日漲跌</th>
                        <th>五日漲跌</th>
                        <th>月漲跌</th>
                        <th>季漲跌</th>
                        <th>年初至今</th>
                    </tr>
                </thead>
                 <!-- --- v3.1.2 修正: 補齊表格行佔位符 --- -->
                <tbody>
                    <tr>
                        <td>WTI原油</td>
                        <td><strong>60.67</strong></td>
                        <td class="text-down"><strong>+1.27%</strong></td>
                        <td class="text-down"><strong>+0.90%</strong></td>
                        <td class="text-down"><strong>+5.44%</strong></td>
                        <td class="text-up"><strong>-3.39%</strong></td>
                        <td class="text-up"><strong>-15.41%</strong></td>
                    </tr>
                    <tr>
                        <td>布蘭特原油</td>
                        <td><strong>64.36</strong></td>
                        <td class="text-down"><strong>+0.25%</strong></td>
                        <td class="text-down"><strong>+0.47%</strong></td>
                        <td class="text-down"><strong>+5.01%</strong></td>
                        <td class="text-up"><strong>-2.26%</strong></td>
                        <td class="text-up"><strong>-13.77%</strong></td>
                    </tr>
                    <tr>
                        <td>黃金期貨</td>
                        <td><strong>4,067.40</strong></td>
                        <td class="text-up"><strong>-0.02%</strong></td>
                        <td class="text-up"><strong>-1.08%</strong></td>
                        <td class="text-up"><strong>-2.92%</strong></td>
                        <td class="text-down"><strong>+21.92%</strong></td>
                        <td class="text-down"><strong>+54.70%</strong></td>
                    </tr>
                    <tr>
                        <td>基礎金屬ETF (DBB)</td>
                        <td><strong>21.22</strong></td>
                        <td class="text-up"><strong>-0.52%</strong></td>
                        <td class="text-up"><strong>-2.53%</strong></td>
                        <td class="text-down"><strong>+1.29%</strong></td>
                        <td class="text-down"><strong>+8.71%</strong></td>
                        <td class="text-down"><strong>+12.57%</strong></td>
                    </tr>
                </tbody>
            </table>
        </div>
        <p class="text-xs text-right" style="color: #64748b; margin-top: 0.5rem;">資料來源: Yahoo Finance</p>

        <!-- --- v3.1.9 替換: 深度分析區塊使用 v2.8 格式 --- -->
        <div class="analysis-block">
            <h4>深度分析:</h4>
            <div class="structured-analysis">
                <p><strong>供應擔憂雖緩解，技術買盤推升油價反彈</strong><br>雖然俄羅斯黑海油港恢復出口的消息緩解了部分地緣政治供應擔憂，但原油市場出現技術性反彈。WTI原油上漲<strong>1.27%</strong>，重回60美元整數關卡之上，布蘭特原油亦小幅收高。這反映出在近期連續修正後，市場對低接能源資產的興趣回溫，且冬季用油旺季預期仍提供一定支撐，能源板塊表現相對大盤強勢。</p>
                <p><strong>美元高檔震盪壓抑金價，長線避險需求仍存</strong><br>黃金期貨受制於美元指數維持在99.58的高檔位置，價格在<strong>4,067美元</strong>附近呈現狹幅整理走勢，單日微跌<strong>0.02%</strong>。當前最大風險在於聯準會降息節奏若不如預期，將持續對不孳息的黃金構成壓力。然而，深層解讀顯示，地緣政治局勢未明朗以及各國央行持續購金的趨勢，仍為金價提供長線支撐。建議投資人關注4000美元關卡的支撐力道。</p>
            </div>
        </div>
    </section>

    <!-- 第5章:台股解析 -->
    <section id="sec-5" class="section-card">
        <h2 style="color: #059669;"><span style="margin-right: 0.75rem;">🗻</span>第5章｜台股解析</h2>

        <div class="tldr-block" style="background: #f0fdf4;">
            <ul>
                <li style="color: #059669;"><strong>外資大舉提款：</strong>外資單日大幅賣超485億元，電子、金融、傳產權值股全線遭調節，指數重挫691點，跌破多道均線支撐。</li>
                <li style="color: #059669;"><strong>股匯雙殺格局：</strong>資金外流壓力沉重，新台幣匯率顯著貶值，股匯市同步走弱，顯示市場信心受到嚴重打擊。</li>
                <li style="color: #059669;"><strong>技術面轉弱：</strong>加權指數長黑摜破27000點整數關卡，技術指標轉空，短線融資多殺多風險升高，需留意籌碼面變化。</li>
            </ul>
        </div>

        <div class="overflow-x-auto">
            <table class="table-styled">
                <caption>亞洲主要股市指數漲跌概覽</caption>
                <thead>
                    <tr>
                        <th>指標名稱</th>
                        <th>最新收盤價</th>
                        <th>日漲跌</th>
                        <th>五日漲跌</th>
                        <th>月漲跌</th>
                        <th>季漲跌</th>
                        <th>年初至今</th>
                    </tr>
                </thead>
                 <!-- --- v3.1.2 修正: 補齊表格行佔位符 --- -->
                <tbody>
                    <tr>
                        <td>台灣加權指數</td>
                        <td><strong>26,756.12</strong></td>
                        <td class="text-up"><strong>-2.52%</strong></td>
                        <td class="text-up"><strong>-4.00%</strong></td>
                        <td class="text-up"><strong>-2.00%</strong></td>
                        <td class="text-down"><strong>+9.95%</strong></td>
                        <td class="text-down"><strong>+16.15%</strong></td>
                    </tr>
                    <tr>
                        <td>日經225</td>
                        <td><strong>48,702.98</strong></td>
                        <td class="text-up"><strong>-3.22%</strong></td>
                        <td class="text-up"><strong>-4.34%</strong></td>
                        <td class="text-down"><strong>+2.36%</strong></td>
                        <td class="text-down"><strong>+12.27%</strong></td>
                        <td class="text-down"><strong>+22.08%</strong></td>
                    </tr>
                    <tr>
                        <td>香港恆生指數</td>
                        <td><strong>25,930.03</strong></td>
                        <td class="text-up"><strong>-1.72%</strong></td>
                        <td class="text-up"><strong>-2.70%</strong></td>
                        <td class="text-down"><strong>+2.70%</strong></td>
                        <td class="text-down"><strong>+2.61%</strong></td>
                        <td class="text-down"><strong>+29.26%</strong></td>
                    </tr>
                    <tr>
                        <td>韓國KOSPI</td>
                        <td><strong>3,953.62</strong></td>
                        <td class="text-up"><strong>-3.32%</strong></td>
                        <td class="text-up"><strong>-2.94%</strong></td>
                        <td class="text-down"><strong>+5.46%</strong></td>
                        <td class="text-down"><strong>+22.57%</strong></td>
                        <td class="text-down"><strong>+64.77%</strong></td>
                    </tr>
                    <tr>
                        <td>印度SENSEX</td>
                        <td><strong>84,673.02</strong></td>
                        <td class="text-up"><strong>-0.33%</strong></td>
                        <td class="text-down"><strong>+1.36%</strong></td>
                        <td class="text-down"><strong>+0.86%</strong></td>
                        <td class="text-down"><strong>+5.06%</strong></td>
                        <td class="text-down"><strong>+8.36%</strong></td>
                    </tr>
                </tbody>
            </table>
        </div>
        <p class="text-xs text-right" style="color: #64748b; margin-top: 0.5rem;">資料來源: Yahoo Finance</p>

        <h3 class="table-title" style="margin-top: 2rem;">台股三大法人買賣超 (2025年11月18日)</h3>
        <div class="overflow-x-auto">
            <table class="table-styled">
                <caption>台股三大法人買賣超統計</caption>
                <thead>
                    <tr>
                        <th>法人別</th>
                        <th>當日淨額(億)</th>
                        <th>5日累計(億)</th>
                        <th>20日累計(億)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>外資</td>
                        <td class="text-up"><strong>-485.38</strong></td>
                        <td class="text-up"><strong>-1167.22</strong></td>
                        <td class="text-up"><strong>-3141.21</strong></td>
                    </tr>
                    <tr>
                        <td>投信</td>
                        <td class="text-up"><strong>-33.51</strong></td>
                        <td class="text-up"><strong>-204.43</strong></td>
                        <td class="text-up"><strong>-360.28</strong></td>
                    </tr>
                    <tr>
                        <td>自營商</td>
                        <td class="text-up"><strong>-191.42</strong></td>
                        <td class="text-up"><strong>-476.53</strong></td>
                        <td class="text-up"><strong>-157.05</strong></td>
                    </tr>
                    <tr class="summary-row">
                        <td>總計</td>
                        <td class="text-up"><strong>-710.31</strong></td>
                        <td class="text-up"><strong>-1848.18</strong></td>
                        <td class="text-up"><strong>-3658.54</strong></td>
                    </tr>
                </tbody>
            </table>
        </div>
        <p class="text-xs text-right" style="color: #64748b; margin-top: 0.5rem;">資料來源: 交易所資料整理</p>

        <!-- --- v3.1.9 替換: 深度分析區塊使用 v2.8 格式 --- -->
        <div class="analysis-block">
            <h4>深度分析:</h4>
            <div class="structured-analysis">
                <p><strong>外資大舉調節權值股，市場信心受AI泡沫論衝擊</strong><br>外資單日大舉賣超<strong>485億元</strong>，創下波段賣超紀錄，嚴重打擊市場多頭信心。台積電、聯發科等AI概念股領跌，電子指數跌幅最深，拖累加權指數重挫<strong>2.52%</strong>。市場情緒受到美股科技股回檔及輝達財報前夕觀望氣氛影響，避險情緒升溫，自營商亦同步大賣191億元，法人籌碼面呈現全面撤退態勢。</p>
                <p><strong>跌破關鍵支撐引發技術性賣壓，短線留意多殺多風險</strong><br>指數長黑摜破月線與27000點整數關卡，技術型態顯著轉弱。當前最大風險在於融資餘額若未隨指數下跌而顯著減少，短線恐面臨融資斷頭的多殺多壓力。可驗證指標為外資期貨空單是否持續增加以及新台幣匯率是否止穩。若輝達財報無法提振市場信心，台股恐將向下尋求季線支撐。</p>
            </div>
        </div>
    </section>

    <!-- 第6章:匯率市場 -->
    <section id="sec-6" class="section-card">
        <h2 style="color: #0891b2;"><span style="margin-right: 0.75rem;">💱</span>第6章｜匯率市場</h2>

        <div class="tldr-block" style="background: #ecfeff;">
            <ul>
                <li style="color: #0891b2;"><strong>美元橫盤整理：</strong>市場靜待聯準會更多貨幣政策訊號，美元指數持平於99.58，多空雙方交投謹慎，非美貨幣表現分歧。</li>
                <li style="color: #0891b2;"><strong>台幣顯著貶值：</strong>受外資在台股大舉賣超並匯出影響，新台幣兌美元單日重貶1.79%，收在31.10，貶值壓力沉重。</li>
                <li style="color: #0891b2;"><strong>日圓反彈走升：</strong>日本央行總裁暗示可能調整貨幣政策，帶動日圓兌美元升值0.57%，成為表現相對強勢的亞幣。</li>
            </ul>
        </div>

        <h3 class="table-title">主要貨幣兌美元匯率</h3>
        <div class="overflow-x-auto">
            <table class="table-styled">
                <caption>主要貨幣兌美元匯率變動概覽</caption>
                <thead>
                    <tr>
                        <th>指標名稱</th>
                        <th>最新匯率</th>
                        <th>日漲跌</th>
                        <th>五日漲跌</th>
                        <th>月漲跌</th>
                        <th>季漲跌</th>
                        <th>年初至今</th>
                    </tr>
                </thead>
                 <!-- --- v3.1.2 修正: 補齊表格行佔位符 --- -->
                <tbody>
                    <tr>
                        <td>美元指數</td>
                        <td><strong>99.58</strong></td>
                        <td class="text-up"><strong>-0.01%</strong></td>
                        <td class="text-up"><strong>-0.04%</strong></td>
                        <td class="text-down"><strong>+1.17%</strong></td>
                        <td class="text-down"><strong>+1.77%</strong></td>
                        <td class="text-up"><strong>-8.21%</strong></td>
                    </tr>
                    <tr>
                        <td>美元兌台幣</td>
                        <td><strong>31.1000</strong></td>
                        <td class="text-down"><strong>+1.79%</strong></td>
                        <td class="text-down"><strong>+0.43%</strong></td>
                        <td class="text-down"><strong>+1.59%</strong></td>
                        <td class="text-down"><strong>+3.39%</strong></td>
                        <td class="text-up"><strong>-5.07%</strong></td>
                    </tr>
                    <tr>
                        <td>歐元兌美元</td>
                        <td><strong>1.1583</strong></td>
                        <td class="text-up"><strong>-0.27%</strong></td>
                        <td class="text-down"><strong>+0.34%</strong></td>
                        <td class="text-up"><strong>-0.99%</strong></td>
                        <td class="text-up"><strong>-0.58%</strong></td>
                        <td class="text-down"><strong>+11.31%</strong></td>
                    </tr>
                    <tr>
                        <td>美元兌日圓</td>
                        <td><strong>155.4660</strong></td>
                        <td class="text-down"><strong>+0.57%</strong></td>
                        <td class="text-down"><strong>+1.07%</strong></td>
                        <td class="text-down"><strong>+3.56%</strong></td>
                        <td class="text-down"><strong>+5.26%</strong></td>
                        <td class="text-up"><strong>-0.97%</strong></td>
                    </tr>
                </tbody>
            </table>
        </div>
        <p class="text-xs text-right" style="color: #64748b; margin-top: 0.5rem;">資料來源: Yahoo Finance</p>

        <!-- --- v3.1.9 替換: 深度分析區塊使用 v2.8 格式 --- -->
        <div class="analysis-block">
            <h4>深度分析:</h4>
            <div class="structured-analysis">
                <p><strong>美日貨幣政策預期拉鋸，非美貨幣走勢分歧</strong><br>美元指數維持在<strong>99.58</strong>附近的窄幅區間，主要因市場正在評估聯準會降息路徑與日本央行可能的升息動作。日圓因日本央行總裁偏鷹派的發言而反彈，升值<strong>0.57%</strong>。相對地，歐元受歐元區經濟數據疲軟拖累而走貶。匯市短期將受制於主要央行的政策預期差，波動可能加劇。</p>
                <p><strong>外資匯出壓力沈重，台幣面臨補貶效應</strong><br>新台幣(USD/TWD)單日出現<strong>1.79%</strong>的顯著貶值，收在<strong>31.10元</strong>。這主要反映了台股外資鉅額賣超後的實質匯出需求，加上美元維持高檔，導致台幣面臨補貶壓力。深層解讀顯示，股匯雙殺的負向螺旋正在形成，央行是否會進場調節以及外資對台股的態度變化，將是觀察台幣能否止穩的關鍵指標。</p>
            </div>
        </div>
    </section>

    <!-- --- v3.1.9 替換: 整個第7章區塊使用 v2.8 格式 --- -->
    <!-- --- v3.1.10 修正: 將 [買進] 改為 [看多], [賣出] 改為 [看空], class buy -> bullish, sell -> bearish --- -->
    <section id="sec-7" class="section-card">
        <h2 style="color: #7c3aed;">
            <span style="margin-right: 0.75rem;">🏭</span>第7章｜產業多空展望
        </h2>

        <!-- TL;DR -->
        <div class="tldr-block" style="background: #faf5ff;">
            <ul>
                <li style="color: #7c3aed;"><strong>[看多]</strong> AI軟體服務 (GOOGL.US): Gemini 3模型發布獲市場好評，加上巴菲特建倉背書，顯示軟體服務價值浮現。</li>
                <li style="color: #7c3aed;"><strong>[看多]</strong> 國防工業 (RHM.DE): 萊茵金屬預估2030年營收將翻五倍，地緣政治緊張持續推升國防訂單需求。</li>
                <li style="color: #7c3aed;"><strong>[看空]</strong> 居家修繕 (HD.US): 家得寶下調財測，顯示高利率環境持續壓抑房市需求，消費動能疲軟。</li>
                <li style="color: #7c3aed;"><strong>[看空]</strong> 社群媒體 (DJT.US): 川普媒體股價暴跌，市值大幅縮水，反映迷因股估值缺乏基本面支撐的風險。</li>
            </ul>
        </div>

        <!-- 看多推薦第一檔 -->
        <div class="stock-recommendation bullish">
            <h3 class="recommendation-title bullish">[看多]:AI軟體服務 (以Alphabet (GOOGL.US)為例)</h3>

            <div class="overflow-x-auto">
                <table class="analysis-table">
                    <thead>
                        <tr>
                            <th>分析維度</th>
                            <th>觀點與數據</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="font-semibold text-slate-600">新產品催化</td>
                            <td>Google發布Gemini 3模型，性能宣稱優於ChatGPT，市場看好其在AI應用層的競爭力提升。</td>
                        </tr>
                        <tr>
                            <td class="font-semibold text-slate-600">機構背書</td>
                            <td>波克夏(巴菲特)最新13F報告揭露建倉Alphabet，顯示價值投資人認可其長期護城河與估值優勢。</td>
                        </tr>
                        <tr>
                            <td class="font-semibold text-slate-600">股價動能</td>
                            <td>新聞報導指出Alphabet近期股價表現強勢，飆漲50%領跑科技七雄，技術面呈現強勢格局。</td>
                        </tr>
                        <tr>
                            <td class="font-semibold text-slate-600">
                                <div class="link-button-container">
                                    <a href="https://tw.tradingview.com/symbols/NASDAQ-GOOGL/financials-overview/" target="_blank" class="link-button fundamental">
                                        基本面
                                        <span class="link-button-subtitle">按此看財務數據</span>
                                    </a>
                                    <a href="https://tw.tradingview.com/symbols/NASDAQ-GOOGL/technicals/" target="_blank" class="link-button technical">
                                        技術面
                                        <span class="link-button-subtitle">按此看技術圖表</span>
                                    </a>
                                </div>
                            </td>
                            <td>
                                在硬體股面臨估值修正之際，AI軟體服務商因具備實質變現能力與相對合理的估值，成為資金輪動的目標。Google憑藉強大的搜尋引擎護城河及新推出的AI模型，可望在應用層市場佔據有利位置。<br><br>
                                股價近期表現優於大盤，巴菲特的進場更是強力的信心支撐。技術面維持多頭排列，若能守穩支撐，後市仍具上漲空間。
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <p class="text-xs text-right" style="color: #64748b; margin-top: 0.5rem;">資料來源: TradingView</p>

            <div class="analysis-block">
                <h4>深度分析:</h4>
                <div class="structured-analysis">
                    <p><strong>AI軟體價值浮現，巴菲特進場與新品發布雙重利多</strong><br>Alphabet (GOOGL.US) 近期利多頻傳，除了Gemini 3模型展現強大競爭力外，波克夏的建倉更是對其長期價值的肯定。在市場擔憂AI硬體資本支出過高的同時，軟體服務商的變現模式相對清晰。數據顯示其股價領跑科技巨頭，顯示資金正從硬體轉向軟體，具備補漲潛力。</p>
                </div>
            </div>
        </div>

        <!-- 看多推薦第二檔 -->
        <div class="stock-recommendation bullish">
            <h3 class="recommendation-title bullish">[看多]:國防工業 (以Rheinmetall (RHM.DE)為例)</h3>

            <div class="overflow-x-auto">
                <table class="analysis-table">
                    <thead>
                        <tr>
                            <th>分析維度</th>
                            <th>觀點與數據</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="font-semibold text-slate-600">營收展望</td>
                            <td>公司預估2030年營收將達到去年的五倍，顯示訂單能見度極高，成長動能強勁。</td>
                        </tr>
                        <tr>
                            <td class="font-semibold text-slate-600">地緣政治</td>
                            <td>全球地緣政治衝突持續，各國增加國防預算，軍工產業處於長週期的上升趨勢中。</td>
                        </tr>
                        <tr>
                            <td class="font-semibold text-slate-600">股價表現</td>
                            <td>新聞報導指出其股價三年內已上漲900%，反映市場對其未來成長性的高度認同。</td>
                        </tr>
                         <tr>
                            <td class="font-semibold text-slate-600">
                                <div class="link-button-container">
                                    <a href="https://tw.tradingview.com/symbols/XETR-RHM/financials-overview/" target="_blank" class="link-button fundamental">
                                        基本面
                                        <span class="link-button-subtitle">按此看財務數據</span>
                                    </a>
                                    <a href="https://tw.tradingview.com/symbols/XETR-RHM/technicals/" target="_blank" class="link-button technical">
                                        技術面
                                        <span class="link-button-subtitle">按此看技術圖表</span>
                                    </a>
                                </div>
                            </td>
                            <td>
                                萊茵金屬(RHM.DE)作為歐洲國防龍頭，直接受惠於歐洲各國的再武裝計畫。公司給出的長期營收指引極具野心，且有充沛的積壓訂單支持。在充滿不確定性的宏觀環境下，國防股具備獨特的成長確定性。<br><br>
                                股價長期呈現強勢多頭格局，雖累積漲幅較大，但在基本面持續好轉的支撐下，多頭趨勢尚未改變，適合偏多操作。
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <p class="text-xs text-right" style="color: #64748b; margin-top: 0.5rem;">資料來源: TradingView</p>

            <div class="analysis-block">
                <h4>深度分析:</h4>
                <div class="structured-analysis">
                    <p><strong>地緣衝突推升國防需求，萊茵金屬長線成長確立</strong><br>萊茵金屬 (RHM.DE) 受惠於全球軍備競賽，其預估2030年營收翻五倍的指引震驚市場。這顯示國防需求並非短期現象，而是結構性的長期增長。在俄烏戰爭與中東局勢未解的情況下，國防預算將持續增加，為軍工類股提供堅實的基本面支撐，是規避經濟衰退風險的優質標的。</p>
                </div>
            </div>
        </div>

        <!-- 看空推薦第一檔 -->
        <div class="stock-recommendation bearish">
            <h3 class="recommendation-title bearish">[看空]:居家修繕 (以Home Depot (HD.US)為例)</h3>

            <div class="overflow-x-auto">
                <table class="analysis-table">
                    <thead>
                        <tr>
                            <th>分析維度</th>
                            <th>觀點與數據</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="font-semibold text-slate-600">財測下修</td>
                            <td>家得寶(Home Depot)下調全年財測，且連續三季獲利不如預期，顯示營運逆風未除。</td>
                        </tr>
                        <tr>
                            <td class="font-semibold text-slate-600">房市壓力</td>
                            <td>高利率環境持續壓抑房市交易與裝修需求，消費者在大額支出上變得更加謹慎。</td>
                        </tr>
                        <tr>
                            <td class="font-semibold text-slate-600">市場反應</td>
                            <td>財報公布後股價單日重挫6%，顯示投資人對其未來展望感到失望，賣壓沈重。</td>
                        </tr>
                         <tr>
                            <td class="font-semibold text-slate-600">
                                <div class="link-button-container">
                                    <a href="https://tw.tradingview.com/symbols/NYSE-HD/financials-overview/" target="_blank" class="link-button fundamental">
                                        基本面
                                        <span class="link-button-subtitle">按此看財務數據</span>
                                    </a>
                                    <a href="https://tw.tradingview.com/symbols/NYSE-HD/technicals/" target="_blank" class="link-button technical">
                                        技術面
                                        <span class="link-button-subtitle">按此看技術圖表</span>
                                    </a>
                                </div>
                            </td>
                            <td>
                                家得寶(HD.US)作為房市景氣的風向球，其財測下修揭示了高利率對實體經濟的滯後影響正在發酵。房貸利率居高不下，導致成屋銷售低迷，連帶拖累居家修繕需求。在聯準會降息路徑不明確前，營運恐難見起色。<br><br>
                                股價受利空消息衝擊出現長黑K棒，跌破重要支撐線，技術面轉弱，短期內恐面臨持續修正壓力，建議保守看待。
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <p class="text-xs text-right" style="color: #64748b; margin-top: 0.5rem;">資料來源: TradingView</p>

            <div class="analysis-block">
                 <h4>深度分析:</h4>
                <div class="structured-analysis">
                    <p><strong>高利率滯後效應顯現，家得寶財測示警房市寒冬</strong><br>家得寶 (HD.US) 下調財測是消費市場疲軟的重要警訊。數據顯示連續三季獲利不如預期，證實高利率環境正實質壓縮消費者的可支配所得與房市相關支出。在降息預期反覆的情況下，依賴房市景氣的零售商將持續面臨逆風，基本面轉弱趨勢明確。</p>
                </div>
            </div>
        </div>

        <!-- 看空推薦第二檔 -->
        <div class="stock-recommendation bearish">
            <h3 class="recommendation-title bearish">[看空]:社群媒體 (以Trump Media (DJT.US)為例)</h3>

            <div class="overflow-x-auto">
                <table class="analysis-table">
                    <thead>
                        <tr>
                            <th>分析維度</th>
                            <th>觀點與數據</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="font-semibold text-slate-600">估值泡沫</td>
                            <td>川普媒體(DJT)股價與基本面嚴重脫鉤，主要依賴消息面與投機資金支撐，泡沫化風險極高。</td>
                        </tr>
                        <tr>
                            <td class="font-semibold text-slate-600">財富蒸發</td>
                            <td>新聞報導指出其股價慘跌，抹去超過50億美元的市值，顯示投機熱潮正在快速退去。</td>
                        </tr>
                        <tr>
                            <td class="font-semibold text-slate-600">題材退燒</td>
                            <td>隨著大選結束及川普交易熱度降溫，市場焦點回歸企業獲利，缺乏基本面的迷因股首當其衝。</td>
                        </tr>
                         <tr>
                            <td class="font-semibold text-slate-600">
                                <div class="link-button-container">
                                    <a href="https://tw.tradingview.com/symbols/NASDAQ-DJT/financials-overview/" target="_blank" class="link-button fundamental">
                                        基本面
                                        <span class="link-button-subtitle">按此看財務數據</span>
                                    </a>
                                    <a href="https://tw.tradingview.com/symbols/NASDAQ-DJT/technicals/" target="_blank" class="link-button technical">
                                        技術面
                                        <span class="link-button-subtitle">按此看技術圖表</span>
                                    </a>
                                </div>
                            </td>
                            <td>
                                川普媒體(DJT.US)是典型的迷因股，其股價走勢高度依賴市場情緒而非營運數據。隨著選舉題材利多出盡，加上市場風險偏好下降，資金撤離速度加快。公司營收規模極小且持續虧損，難以支撐當前的高估值。<br><br>
                                股價呈現崩跌走勢，籌碼面極度不穩定，上方套牢賣壓沈重。在缺乏實質利多支撐下，股價回歸基本面的修正過程可能相當劇烈。
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <p class="text-xs text-right" style="color: #64748b; margin-top: 0.5rem;">資料來源: TradingView</p>

            <div class="analysis-block">
                <h4>深度分析:</h4>
                <div class="structured-analysis">
                    <p><strong>川普交易熱度消退，DJT估值泡沫面臨破裂風險</strong><br>川普媒體 (DJT.US) 的暴跌反映了市場投機情緒的退潮。新聞指出其市值短時間內蒸發數十億美元，顯示在缺乏基本面支撐下，僅靠題材炒作的股價極其脆弱。隨著市場回歸理性關注財報數據，此類高估值迷因股面臨巨大的修正壓力，投資風險極高。</p>
                </div>
            </div>
        </div>
    </section>


    <!-- 頁尾 -->
    <footer class="text-center" style="margin-top: 3rem; padding-top: 2rem; border-top: 1px solid #e2e8f0;">
        <p class="text-xs" style="color: #64748b;">© 2025 金融市場研究團隊 — 洞察•解構•透視全球資產</p>
        <p class="text-xs" style="color: #64748b; margin-top: 0.5rem;">本報告僅為資訊分享,不構成任何投資建議,投資人應秉持獨立判斷,審慎評估並自負投資風險。</p>
    </footer>

</div>

<!-- 回頂按鈕 -->
<button class="back-to-top" onclick="window.scrollTo({top: 0, behavior: 'smooth'})" title="回到頂部" style="display: none;">↑</button>

<script>
// 進度條功能
function updateProgressBar() {
    const winScroll = document.body.scrollTop || document.documentElement.scrollTop;
    const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
    const scrolled = (winScroll / height) * 100;
    const progressBar = document.getElementById("progressBar");
    if (progressBar) { // Check if progressBar exists
        progressBar.style.width = scrolled + "%";
        // Show progress bar only when scrolling starts
        progressBar.style.opacity = scrolled > 0 ? "1" : "0";
    }
}
window.onscroll = function() { updateProgressBar(); };


// --- 穩健性: 確保 DOM 載入後才綁定事件 ---
window.addEventListener('load', function() {

    // 智能下載功能
    const smartDownloadBtn = document.getElementById('smartDownloadBtn');
    if (smartDownloadBtn) {
        smartDownloadBtn.addEventListener('click', function() {
            const element = document.createElement('a');
            // --- v3.1.8 Use placeholder for date string ---
            const dateStr = '20251119'; // Use placeholder
            // CRITICAL: Download filename MUST be in 'yyyymmdd.html' format.
            const filename = dateStr + '.html'; // 強制要求 yyyymmdd.html 格式

            // Temporarily hide elements that shouldn't be in the downloaded file
            const progressBar = document.getElementById('progressBar');
            const backToTopButton = document.querySelector('.back-to-top');
            const originalProgressBarStyle = progressBar ? progressBar.style.display : '';
            const originalBackToTopStyle = backToTopButton ? backToTopButton.style.display : '';

            if (progressBar) progressBar.style.display = 'none';
            if (backToTopButton) backToTopButton.style.display = 'none';

            // Get the HTML content AFTER hiding elements
            const content = document.documentElement.outerHTML;

            // Restore elements
            if (progressBar) progressBar.style.display = originalProgressBarStyle;
            if (backToTopButton) backToTopButton.style.display = originalBackToTopStyle;


            const file = new Blob([content], {type: 'text/html;charset=utf-8'});
            element.href = URL.createObjectURL(file);
            element.download = filename; // Use dynamic filename
            document.body.appendChild(element);
            element.click();
            document.body.removeChild(element);
            URL.revokeObjectURL(element.href);
        });
    } // end if(smartDownloadBtn)

    // 平滑滾動導航
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute('href'));
            if (target) {
                const offset = 120; // Adjusted offset for sticky nav
                const bodyRect = document.body.getBoundingClientRect().top;
                const elementRect = target.getBoundingClientRect().top;
                const elementPosition = elementRect - bodyRect;
                const offsetPosition = elementPosition - offset;
                window.scrollTo({ top: offsetPosition, behavior: 'smooth' });
            }
        });
    });

    // 載入完成後隱藏進度條 (fade out effect)
    const progressBar = document.getElementById("progressBar");
     if (progressBar) { // Check if progressBar exists
        progressBar.style.transition = 'opacity 0.5s ease-out'; // Add fade out transition
        setTimeout(function() {
            progressBar.style.opacity = "0";
        }, 500); // Start fade out after 500ms
     }
}); // end window.load
</script>


</body></html>