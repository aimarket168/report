<html lang="zh-TW"><head><script>(function(firebaseConfig, initialAuthToken, appId) {
        window.__firebase_config = firebaseConfig;
        window.__initial_auth_token = initialAuthToken;
        window.__app_id = appId;
            })("\n{\n  \"apiKey\": \"AIzaSyCqyCcs2R2e7AegGjvFAwG98wlamtbHvZY\",\n  \"authDomain\": \"bard-frontend.firebaseapp.com\",\n  \"projectId\": \"bard-frontend\",\n  \"storageBucket\": \"bard-frontend.firebasestorage.app\",\n  \"messagingSenderId\": \"175205271074\",\n  \"appId\": \"1:175205271074:web:2b7bd4d34d33bf38e6ec7b\"\n}\n","eyJhbGciOiJSUzI1NiIsImtpZCI6IjA5ZmNiMTMxOGNkZGNmOWU4YjczZjZhMzM3ZTk2ZTIwNjJmMjEwZGIiLCJ0eXAiOiJKV1QifQ.eyJzdWIiOiJmaXJlYmFzZS1hZG1pbnNkay1mYnN2Y0BiYXJkLWZyb250ZW5kLmlhbS5nc2VydmljZWFjY291bnQuY29tIiwiYXVkIjoiaHR0cHM6Ly9pZGVudGl0eXRvb2xraXQuZ29vZ2xlYXBpcy5jb20vZ29vZ2xlLmlkZW50aXR5LmlkZW50aXR5dG9vbGtpdC52MS5JZGVudGl0eVRvb2xraXQiLCJ1aWQiOiIwMTYyNzg3NDM4ODM1OTc2Mjk5OCIsImlzcyI6ImZpcmViYXNlLWFkbWluc2RrLWZic3ZjQGJhcmQtZnJvbnRlbmQuaWFtLmdzZXJ2aWNlYWNjb3VudC5jb20iLCJjbGFpbXMiOnsiYXBwSWQiOiJjXzc1YTgzOWQwNzBiN2I0NjBfMjAyNTExMTguaHRtbC0yOTQifSwiZXhwIjoxNzYzNDIyOTA0LCJpYXQiOjE3NjM0MTkzMDQsImFsZyI6IlJTMjU2In0.eReRwWZ8vgSDMQ09hMqj9pNHmm6F29wUJ9JKQjmRqXfl_Ug9tNCCzTqp4hBJd0doD8Ihmu_-ApVROSa8xaxRgfVu53Lc09L03kpTX4H75m8z6NPRHwuygiZ43VVutzC0IWjvhHIv1x1uI5eQ6KiXzl4ZafkcK-rLR-dZJSTBYPfFJtJwYc62VPddlw3ePzIZQYNyHD-8wMvzSigyp3niLLJuhEmSgt2t2G092bcQSaTGxWZwx5PEDaPJLuM9k5hFomz_eZQur6hAS979dgmVf4yQ1xpG2pNRbovq-le8k_KxgeTPzOm5UYs4krgoC81VtwyOR_-97TfX91ZCrdEkcw","c_75a839d070b7b460_20251118.html-294")</script><script>'use strict';var h=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,b,d){if(a==Array.prototype||a==Object.prototype)return a;a[b]=d.value;return a};function l(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var d=a[b];if(d&&d.Math==Math)return d}throw Error("Cannot find global object");}var n=l(this);
function p(a,b){if(b)a:{var d=n;a=a.split(".");for(var c=0;c<a.length-1;c++){var e=a[c];if(!(e in d))break a;d=d[e]}a=a[a.length-1];c=d[a];b=b(c);b!=c&&b!=null&&h(d,a,{configurable:!0,writable:!0,value:b})}}function r(a){function b(c){return a.next(c)}function d(c){return a.throw(c)}return new Promise(function(c,e){function f(g){g.done?c(g.value):Promise.resolve(g.value).then(b,d).then(f,e)}f(a.next())})}function t(a){return r(a())}
p("Object.values",function(a){return a?a:function(b){var d=[],c;for(c in b)Object.prototype.hasOwnProperty.call(b,c)&&d.push(b[c]);return d}});p("Array.prototype.includes",function(a){return a?a:function(b,d){var c=this;c instanceof String&&(c=String(c));var e=c.length;d=d||0;for(d<0&&(d=Math.max(d+e,0));d<e;d++){var f=c[d];if(f===b||Object.is(f,b))return!0}return!1}});/*

 MIT License

 Copyright (c) 2017-2023 W.Y.

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in
 all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 SOFTWARE.

*/
function u(a,b){const d=a.style;b.backgroundColor&&(d.backgroundColor=b.backgroundColor);b.width&&(d.width=`${b.width}px`);b.height&&(d.height=`${b.height}px`);const c=b.style;c!=null&&Object.keys(c).forEach(e=>{d[e]=c[e]})};var v=(()=>{let a=0;return()=>{a+=1;return`u${`0000${(Math.random()*1679616<<0).toString(36)}`.slice(-4)}${a}`}})();function w(a){const b=[];for(let d=0,c=a.length;d<c;d++)b.push(a[d]);return b}let x=null;function y(a={}){return x?x:a.l?x=a.l:x=w(window.getComputedStyle(document.documentElement))}function z(a,b){return(a=(a.ownerDocument.defaultView||window).getComputedStyle(a).getPropertyValue(b))?parseFloat(a.replace("px","")):0}
function A(a,b={}){var d;if(!(d=b.width)){d=z(a,"border-left-width");var c=z(a,"border-right-width");d=a.clientWidth+d+c}(b=b.height)||(b=z(a,"border-top-width"),c=z(a,"border-bottom-width"),b=a.clientHeight+b+c);return{width:d,height:b}}function B(a){return new Promise((b,d)=>{const c=new Image;c.onload=()=>{c.decode().then(()=>{requestAnimationFrame(()=>b(c))})};c.onerror=d;c.crossOrigin="anonymous";c.decoding="async";c.src=a})}
function C(a){return t(function*(){return Promise.resolve().then(()=>(new XMLSerializer).serializeToString(a)).then(encodeURIComponent).then(b=>`data:image/svg+xml;charset=utf-8,${b}`)})}
function D(a,b,d){return t(function*(){const c=document.createElementNS("http://www.w3.org/2000/svg","svg"),e=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");c.setAttribute("width",`${b}`);c.setAttribute("height",`${d}`);c.setAttribute("viewBox",`0 0 ${b} ${d}`);e.setAttribute("width","100%");e.setAttribute("height","100%");e.setAttribute("x","0");e.setAttribute("y","0");e.setAttribute("externalResourcesRequired","true");c.appendChild(e);e.appendChild(a);return C(c)})}
var E=(a,b)=>{if(a instanceof b)return!0;a=Object.getPrototypeOf(a);return a===null?!1:a.constructor.name===b.name||E(a,b)};function F(a,b){return y(b).map(d=>{const c=a.getPropertyValue(d),e=a.getPropertyPriority(d);return`${d}: ${c}${e?" !important":""};`}).join(" ")}
function G(a,b,d,c){a=window.getComputedStyle(a,d);var e=a.getPropertyValue("content");if(e!==""&&e!=="none"){var f=v();try{b.className=`${b.className} ${f}`}catch(k){return}e=document.createElement("style");var g=e.appendChild;d=`.${f}:${d}`;a.cssText?(c=a.getPropertyValue("content"),c=`${a.cssText} content: '${c.replace(/'|"/g,"")}';`):c=F(a,c);g.call(e,document.createTextNode(`${d}{${c}}`));b.appendChild(e)}};function H(a){return a.search(/^(data:)/)!==-1}function I(a,b,d){return t(function*(){const c=yield fetch(a,b);if(c.status===404)throw Error(`Resource "${c.url}" not found`);const e=yield c.blob();return new Promise((f,g)=>{const k=new FileReader;k.onerror=g;k.onloadend=()=>{try{f(d({o:c,result:k.result}))}catch(m){g(m)}};k.readAsDataURL(e)})})}const J={};function K(a,b,d){let c=a.replace(/\?.*/,"");d&&(c=a);/ttf|otf|eot|woff2?/i.test(c)&&(c=c.replace(/.*\//,""));return b?`[${b}]${c}`:c}
function L(a,b,d){return t(function*(){const c=K(a,b,d.C);if(J[c]!=null)return J[c];d.u&&(a+=(/\?/.test(a)?"&":"?")+(new Date).getTime());let e;try{const f=yield I(a,d.i,({o:g,result:k})=>{b||(b=g.headers.get("Content-Type")||"");return k.split(/,/)[1]});e=`data:${b};base64,${f}`}catch(f){e=d.B||""}return J[c]=e})};const M={P:"application/font-woff",R:"application/font-woff",N:"application/font-truetype",v:"application/vnd.ms-fontobject",H:"image/png",F:"image/jpeg",D:"image/jpeg",A:"image/gif",M:"image/tiff",L:"image/svg+xml",O:"image/webp"};function N(a){return(a=/\.([^./]*?)$/g.exec(a))?a[1]:""};function O(a){return t(function*(){const b=a.toDataURL();return b==="data:,"?a.cloneNode(!1):B(b)})}function aa(a,b){return t(function*(){if(a.currentSrc){var d=document.createElement("canvas");const c=d.getContext("2d");d.width=a.clientWidth;d.height=a.clientHeight;c==null||c.drawImage(a,0,0,d.width,d.height);d=d.toDataURL();return B(d)}d=a.poster;d=yield L(d,M[N(d).toLowerCase()]||"",b);return B(d)})}
function ba(a,b){return t(function*(){try{let d;if(a==null?0:(d=a.contentDocument)==null?0:d.body)return yield P(a.contentDocument.body,b,!0)}catch(d){}return a.cloneNode(!1)})}function ca(a,b){return t(function*(){return E(a,HTMLCanvasElement)?O(a):E(a,HTMLVideoElement)?aa(a,b):E(a,HTMLIFrameElement)?ba(a,b):a.cloneNode(a.tagName!=null&&a.tagName.toUpperCase()==="SVG")})}
function da(a,b,d){return t(function*(){if(b.tagName!=null&&b.tagName.toUpperCase()==="SVG")return b;let c=[];if(a.tagName!=null&&a.tagName.toUpperCase()==="SLOT"&&a.assignedNodes)c=w(a.assignedNodes());else{let e;if(E(a,HTMLIFrameElement)&&((e=a.contentDocument)==null?0:e.body))c=w(a.contentDocument.body.childNodes);else{let f;c=w(((f=a.shadowRoot)!=null?f:a).childNodes)}}if(c.length===0||E(a,HTMLVideoElement))return b;yield c.reduce((e,f)=>e.then(()=>P(f,d)).then(g=>{g&&b.appendChild(g)}),Promise.resolve());
return b})}function ea(a,b,d){const c=b.style;if(c){var e=window.getComputedStyle(a);e.cssText?(c.cssText=e.cssText,c.transformOrigin=e.transformOrigin):y(d).forEach(f=>{let g=e.getPropertyValue(f);f==="font-size"&&g.endsWith("px")&&(g=`${Math.floor(parseFloat(g.substring(0,g.length-2)))-.1}px`);E(a,HTMLIFrameElement)&&f==="display"&&g==="inline"&&(g="block");f==="d"&&b.getAttribute("d")&&(g=`path(${b.getAttribute("d")})`);c.setProperty(f,g,e.getPropertyPriority(f))})}}
function fa(a,b){E(a,HTMLSelectElement)&&(b=Array.from(b.children).find(d=>a.value===d.getAttribute("value")))&&b.setAttribute("selected","")}
function ha(a,b){return t(function*(){var d=a.querySelectorAll?a.querySelectorAll("use"):[];if(d.length===0)return a;var c={};for(var e=0;e<d.length;e++){var f=d[e].getAttribute("xlink:href");if(f){const g=document.querySelector(f);a.querySelector(f)||!g||c[f]||(c[f]=yield P(g,b,!0))}}d=Object.values(c);if(d.length){c=document.createElementNS("http://www.w3.org/1999/xhtml","svg");c.setAttribute("xmlns","http://www.w3.org/1999/xhtml");c.style.position="absolute";c.style.width="0";c.style.height="0";
c.style.overflow="hidden";c.style.display="none";e=document.createElementNS("http://www.w3.org/1999/xhtml","defs");c.appendChild(e);for(f=0;f<d.length;f++)e.appendChild(d[f]);a.appendChild(c)}return a})}
function P(a,b,d){return t(function*(){return d||!b.filter||b.filter(a)?Promise.resolve(a).then(c=>ca(c,b)).then(c=>da(a,c,b)).then(c=>{E(c,Element)&&(ea(a,c,b),G(a,c,":before",b),G(a,c,":after",b),E(a,HTMLTextAreaElement)&&(c.textContent=a.value),E(a,HTMLInputElement)&&c.setAttribute("value",a.value),fa(a,c));return c}).then(c=>ha(c,b)):null})};const Q=/url\((['"]?)([^'"]+?)\1\)/g,ia=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,ja=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function ka(a){const b=[];a.replace(Q,(d,c,e)=>{b.push(e);return d});return b.filter(d=>!H(d))}
function la(a,b,d,c){return t(function*(){try{const e=d?(new URL(b,d||void 0)).toString():b;let f;f=yield L(e,M[N(b).toLowerCase()]||"",c);return a.replace(new RegExp(`(url\\(['"]?)(${b.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")})(['"]?\\))`,"g"),`$1${f}$3`)}catch(e){}return a})}function ma(a,{I:b}){return b?a.replace(ja,d=>{for(;;){const [c,,e]=ia.exec(d)||[],f=c,g=e;if(!g)return"";if(g===b)return`src: ${f};`}}):a}
function R(a,b,d){return t(function*(){if(a.search(Q)===-1)return a;const c=ma(a,d);return ka(c).reduce((e,f)=>e.then(g=>la(g,f,b,d)),Promise.resolve(c))})};function S(a,b,d){return t(function*(){var c;const e=(c=b.style)==null?void 0:c.getPropertyValue(a);return e?(c=yield R(e,null,d),b.style.setProperty(a,c,b.style.getPropertyPriority(a)),!0):!1})}function na(a,b){return t(function*(){(yield S("background",a,b))||(yield S("background-image",a,b));(yield S("mask",a,b))||(yield S("-webkit-mask",a,b))||(yield S("mask-image",a,b))||(yield S("-webkit-mask-image",a,b))})}
function oa(a,b){return t(function*(){const d=E(a,HTMLImageElement);if(d&&!H(a.src)||E(a,SVGImageElement)&&!H(a.href.baseVal)){var c=d?a.src:a.href.baseVal,e=yield L(c,M[N(c).toLowerCase()]||"",b);yield new Promise((f,g)=>{a.onload=f;a.onerror=b.m?(...k)=>{try{f(b.m(...k))}catch(m){g(m)}}:g;a.decode&&(a.decode=f);a.loading==="lazy"&&(a.loading="eager");d?(a.srcset="",a.src=e):a.href.baseVal=e})}})}
function pa(a,b){return t(function*(){const d=w(a.childNodes).map(c=>T(c,b));yield Promise.all(d).then(()=>a)})}function T(a,b){return t(function*(){E(a,Element)&&(yield na(a,b),yield oa(a,b),yield pa(a,b))})};const U={};function V(a){return t(function*(){var b=U[a];if(b!=null)return b;b=yield(yield fetch(a)).text();b={url:a,cssText:b};return U[a]=b})}function W(a,b){return t(function*(){let d=a.cssText;const c=/url\(["']?([^"')]+)["']?\)/g,e=(d.match(/url\([^)]+\)/g)||[]).map(f=>t(function*(){let g=f.replace(c,"$1");g.startsWith("https://")||(g=(new URL(g,a.url)).href);return I(g,b.i,({result:k})=>{d=d.replace(f,`url(${k})`);return[f,k]})}));return Promise.all(e).then(()=>d)})}
function X(a){if(a==null)return[];const b=[];a=a.replace(/(\/\*[\s\S]*?\*\/)/gi,"");for(var d=RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");;){var c=d.exec(a);if(c===null)break;b.push(c[0])}a=a.replace(d,"");d=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi;for(c=RegExp("((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})","gi");;){let e=d.exec(a);if(e===null)if(e=c.exec(a),e===null)break;else d.lastIndex=c.lastIndex;else c.lastIndex=
d.lastIndex;b.push(e[0])}return b}
function qa(a,b){return t(function*(){const d=[],c=[];a.forEach(e=>{if("cssRules"in e)try{w(e.cssRules||[]).forEach((f,g)=>{if(f.type===CSSRule.IMPORT_RULE){let k=g+1;f=V(f.href).then(m=>W(m,b)).then(m=>X(m).forEach(q=>{try{e.insertRule(q,q.startsWith("@import")?k+=1:e.cssRules.length)}catch(Da){}})).catch(()=>{});c.push(f)}})}catch(f){const g=a.find(k=>k.href==null)||document.styleSheets[0];e.href!=null&&c.push(V(e.href).then(k=>W(k,b)).then(k=>X(k).forEach(m=>{g.insertRule(m,g.cssRules.length)})).catch(()=>
{}))}});return Promise.all(c).then(()=>{a.forEach(e=>{if("cssRules"in e)try{w(e.cssRules||[]).forEach(f=>{d.push(f)})}catch(f){}});return d})})}function ra(a){return a.filter(b=>b.type===CSSRule.FONT_FACE_RULE).filter(b=>b.style.getPropertyValue("src").search(Q)!==-1)}function sa(a,b){return t(function*(){if(a.ownerDocument==null)throw Error("Provided element is not within a Document");var d=w(a.ownerDocument.styleSheets);d=yield qa(d,b);return ra(d)})}
function ta(a){function b(c){(c.style.fontFamily||getComputedStyle(c).fontFamily).split(",").forEach(e=>{d.add(e.trim().replace(/["']/g,""))});Array.from(c.children).forEach(e=>{e instanceof HTMLElement&&b(e)})}const d=new Set;b(a);return d}function ua(a,b){return t(function*(){const d=yield sa(a,b),c=ta(a);return(yield Promise.all(d.filter(e=>c.has(e.style.fontFamily.trim().replace(/["']/g,""))).map(e=>R(e.cssText,e.parentStyleSheet?e.parentStyleSheet.href:null,b)))).join("\n")})}
function va(a,b){return t(function*(){const d=b.j!=null?b.j:b.K?null:yield ua(a,b);if(d){const c=document.createElement("style");c.appendChild(document.createTextNode(d));a.firstChild?a.insertBefore(c,a.firstChild):a.appendChild(c)}})};function wa(a,b={}){return t(function*(){const {width:d,height:c}=A(a,b),e=yield P(a,b,!0);yield va(e,b);yield T(e,b);u(e,b);return yield D(e,d,c)})}
function xa(a,b={}){return t(function*(){const {width:d,height:c}=A(a,b);var e=yield wa(a,b);e=yield B(e);const f=document.createElement("canvas"),g=f.getContext("2d"),k=b.G||window.devicePixelRatio||1,m=b.h||d,q=b.g||c;f.width=m*k;f.height=q*k;!b.J&&(f.width>16384||f.height>16384)&&(f.width>16384&&f.height>16384?f.width>f.height?(f.height*=16384/f.width,f.width=16384):(f.width*=16384/f.height,f.height=16384):f.width>16384?(f.height*=16384/f.width,f.width=16384):(f.width*=16384/f.height,f.height=
16384));f.style.width=`${m}`;f.style.height=`${q}`;b.backgroundColor&&(g.fillStyle=b.backgroundColor,g.fillRect(0,0,f.width,f.height));g.drawImage(e,0,0,f.width,f.height);return f})}function ya(a,b={}){return t(function*(){return(yield xa(a,b)).toDataURL()})};const za=["gemini.google.com","corp.google.com","proxy.googlers.com"];function Y(){return document.body.querySelectorAll('[class*="animate"]').length>0}function Z(a){return t(function*(){try{return yield ya(a,{h:a.offsetWidth,g:a.offsetHeight})}catch(d){var b=a.offsetHeight;const c=document.createElement("canvas");c.width=a.offsetWidth;c.height=b;return c.toDataURL("image/png")}})}
function Aa(){return t(function*(){const a=document.body.offsetWidth,b=document.body.offsetHeight,d=document.body.cloneNode(!0);d.querySelectorAll('[class*="animate"]').forEach(c=>{c.classList.remove(...Array.from(c.classList).filter(e=>e.startsWith("animate")))});d.style.width=`${a}px`;d.style.height=`${b}px`;return d})}
function Ba(a){return t(function*(){let b=document.body;if(Y()){var d=yield Aa();b=d;document.body.appendChild(d)}d=yield Z(b);Y()&&document.body.removeChild(b);window.parent.postMessage({type:"SEND_SCREENSHOT",image:d,topOffset:document.documentElement.scrollTop},a.origin)})}function Ca(a){return t(function*(){const b={type:"SEND_SCREENSHOT_FOR_DATA_VISUALIZATION",image:yield Z(document.body),topOffset:0};window.parent.postMessage(b,a.origin)})}
window.addEventListener("message",a=>t(function*(){if(za.some(d=>a.origin.includes(d))){var b=a.data;b&&(b.type==="MAKE_SCREENSHOT"&&(yield Ba(a)),b.type==="MAKE_SCREENSHOT_FOR_DATA_VISUALIZATION"&&(yield Ca(a)))}}));
</script><script>(function() {
  // Ensure this script is executed only once
  if (window.firebaseAuthBridgeScriptLoaded) {
    return;
  }
  window.firebaseAuthBridgeScriptLoaded = true;

  let nextTokenPromiseId = 0;

  // Stores { resolve, reject } for ongoing token requests
  const pendingTokenPromises = {};

  // Listen for messages from the Host Application
  window.addEventListener('message', function(event) {

    const messageData = event.data;

  if (messageData && messageData.type === 'RESOLVE_NEW_FIREBASE_TOKEN') {
      const { success, token, error, promiseId } = messageData ?? {};
      if (pendingTokenPromises[promiseId]) {
        if (success) {
          pendingTokenPromises[promiseId].resolve(token);
        } else {
          pendingTokenPromises[promiseId].reject(new Error(error || 'Token refresh failed from host.'));
        }
        delete pendingTokenPromises[promiseId];
      }
    }
  });

  // Expose a function for the Generated App to request a new Firebase token
  window.requestNewFirebaseToken = function() {
    const currentPromiseId = nextTokenPromiseId++;
    const promise = new Promise((resolve, reject) => {
      pendingTokenPromises[currentPromiseId] = { resolve, reject };
    });
    if (window.parent && window.parent !== window) {
      window.parent.postMessage({
        type: 'REQUEST_NEW_FIREBASE_TOKEN',
        promiseId: currentPromiseId
      }, '*');
    } else {
      pendingTokenPromises[currentPromiseId].reject(new Error('No parent window to request token from.'));
      delete pendingTokenPromises[currentPromiseId];
    }
    return promise;
  };
})();</script><script>
let realOriginalGetUserMedia = null;
if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
  realOriginalGetUserMedia = navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);
}

(function() {
  if (navigator.mediaDevices && navigator.mediaDevices.__proto__) {
    try {
      Object.defineProperty(navigator.mediaDevices.__proto__, 'getUserMedia', {
        get: function() {
          return undefined; // Or throw an error
        },
        configurable: false
      });
    } catch (error) {
      console.error("Error defining prototype getter:", error);
    }
  }
})();

(function() {
  const pendingMediaResolvers = {};
  let nextMediaPromiseId = 0;

  function requestMediaPermissions(constraints) {
    const mediaPromiseId = nextMediaPromiseId++;
    const promise = new Promise((resolve, reject) => {
      pendingMediaResolvers[mediaPromiseId] = (granted) => {
        delete pendingMediaResolvers[mediaPromiseId];
        resolve(granted);
      };
    });

    window.parent.postMessage({
      type: 'requestMediaPermission',
      constraints: constraints,
      promiseId: mediaPromiseId,
    }, '*');

    return promise;
  }

  let originalGetUserMedia = realOriginalGetUserMedia;

  function interceptGetUserMedia() {
    if (navigator.mediaDevices) {
      Object.defineProperty(navigator.mediaDevices, 'getUserMedia', {
        value: function(constraints) {
          return requestMediaPermissions(constraints).then((granted) => {
            if (granted) {
              if (originalGetUserMedia) {
                return originalGetUserMedia(constraints);
              } else {
                throw new Error("Original getUserMedia not available.");
              }
            } else {
              throw new DOMException('Permission denied', 'NotAllowedError');
            }
          });
        },
        writable: false,
        configurable: false
      });
    }
  }

  interceptGetUserMedia();

  const observer = new MutationObserver(function(mutationsList, observer) {
    for (const mutation of mutationsList) {
      if (mutation.type === 'reconfigured' && mutation.name === 'getUserMedia' && mutation.object === navigator.mediaDevices) {
        interceptGetUserMedia();
      } else if (mutation.type === 'attributes' && mutation.attributeName === 'getUserMedia' && mutation.target === navigator.mediaDevices) {
        interceptGetUserMedia();
      } else if (mutation.type === 'childList' && mutation.addedNodes) {
        mutation.addedNodes.forEach(node => {
          if (node === navigator.mediaDevices) {
            interceptGetUserMedia();
          }
        });
      }
    }
  });

  function interceptSpeechRecognition() {
    if (!window.SpeechRecognition && !window.webkitSpeechRecognition) {
      return;
    }

    const OriginalSpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;

    const SpeechRecognitionWrapper = function(...args) {
      const recognizer = new OriginalSpeechRecognition(...args);
      const originalStart = recognizer.start.bind(recognizer);

      recognizer.start = function() {
        requestMediaPermissions({ audio: true }).then(granted => {
          if (granted) {
            originalStart();
          } else {
            const errorEvent = new SpeechRecognitionErrorEvent('error');
            errorEvent.error = 'not-allowed'; // This is the standard error for permission denial.
            recognizer.dispatchEvent(errorEvent);
          }
        });
      };

      return recognizer;
    };

    SpeechRecognitionWrapper.prototype = OriginalSpeechRecognition.prototype;
    SpeechRecognitionWrapper.prototype.constructor = SpeechRecognitionWrapper;

    if (window.SpeechRecognition) {
      window.SpeechRecognition = SpeechRecognitionWrapper;
    }
    if (window.webkitSpeechRecognition) {
      window.webkitSpeechRecognition = SpeechRecognitionWrapper;
    }
  }

  interceptSpeechRecognition();

  window.addEventListener('message', function(event) {
    if (event.data) {
      if (event.data.type === 'resolveMediaPermission') {
        const { promiseId, granted } = event.data;
        if (pendingMediaResolvers[promiseId]) {
          pendingMediaResolvers[promiseId](granted);
        }
      }
    }
  });

})();</script><script>((function(modelInformation) {
  const originalFetch = window.fetch;
  // TODO: b/421908508 - Move these out of the script and match all generative AI model calls.
  let googleLlmBaseApiUrls = [
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.textModelName + ':streamGenerateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.textModelName + ':generateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageModelName + ':predict',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageModelName + ':predictLongRunning',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageEditModelName + ':generateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageTransformModelName + ':generateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.videoModelName + ':predict',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.videoModelName + ':predictLongRunning',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.ttsModelName + ':generateContent',
  ];
  modelInformation.deprecatedTextModelNames.forEach((modelName) => {
    googleLlmBaseApiUrls.push(
      'https://generativelanguage.googleapis.com/v1beta/models/' + modelName + ':streamGenerateContent',
      'https://generativelanguage.googleapis.com/v1beta/models/' + modelName + ':generateContent',
    );
  });
  modelInformation.deprecatedImageModelNames.forEach((modelName) => {
    googleLlmBaseApiUrls.push(
      'https://generativelanguage.googleapis.com/v1beta/models/' + modelName + ':predict',
      'https://generativelanguage.googleapis.com/v1beta/models/' + modelName + ':predictLongRunning',
    );
  });

  const pendingFetchResolvers = {};
  let nextPromiseId = 0;

  function handleStringInput(input, optionsArgument) {
    const actualUrl = input;
    const fetchCallArgs = [actualUrl, optionsArgument];
    const effectiveOptions = optionsArgument || {};
    const bodyForApiKeyCheck = effectiveOptions.body;
    const bodyForPostMessage = effectiveOptions.body;
    return { actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage };
  }

  function handleRequestInput(input, optionsArgument) {
    const actualUrl = input.url;
    const fetchCallArgs = [input, optionsArgument];
    const effectiveOptions = { method: input.method, headers: new Headers(input.headers) };
    let bodyForApiKeyCheck;
    let bodyForPostMessage;

    if (optionsArgument) {
      if (optionsArgument.method) effectiveOptions.method = optionsArgument.method;
      if (optionsArgument.headers) effectiveOptions.headers = new Headers(optionsArgument.headers);
      if ('body' in optionsArgument) {
        bodyForApiKeyCheck = optionsArgument.body;
        bodyForPostMessage = optionsArgument.body;
      } else {
        bodyForApiKeyCheck = undefined;
        bodyForPostMessage = input.body;
      }
    } else {
      bodyForApiKeyCheck = undefined;
      bodyForPostMessage = input.body;
    }
    return { actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage };
  }

  window.fetch = function(input, optionsArgument) {
    let actualUrl;
    let fetchCallArgs;
    let effectiveOptions = {};
    let bodyForApiKeyCheck;
    let bodyForPostMessage;

    if (typeof input === 'string') {
      ({actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage} = handleStringInput(input, optionsArgument));
    } else if (input instanceof Request) {
      ({actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage} = handleRequestInput(input, optionsArgument));
    } else {
      return originalFetch.apply(window, [input, optionsArgument]);
    }

    effectiveOptions.method = effectiveOptions.method || 'GET';
    if (!effectiveOptions.headers) {
      effectiveOptions.headers = new Headers();
    }


    if (typeof actualUrl === 'string' && googleLlmBaseApiUrls.some((url) => actualUrl.startsWith(url))) {
      let apiKeyIsNull = true;

      const regex = new RegExp("models/([^:]+)");
      const modelNameMatch = actualUrl.match(regex);
      const modelName = modelNameMatch ? modelNameMatch[1] : 'unspecified';


      try {
        const urlObject = new URL(actualUrl);  // Use URL object for robust parsing
        const apiKeyParam = urlObject.searchParams.get('key');
        if (apiKeyParam) {
          apiKeyIsNull = false;
        }
      } catch (e) {
        // Continue checks even if URL parsing fails
      }

      if (apiKeyIsNull && effectiveOptions.headers) {
        const h = new Headers(effectiveOptions.headers);
        const apiKeyHeaderValue = h.get('X-API-Key') || h.get('x-api-key');
        if (apiKeyHeaderValue) {
          apiKeyIsNull = false;
          return originalFetch.apply(window, fetchCallArgs);
        }
      }

      if (apiKeyIsNull && effectiveOptions.method && ['POST', 'PUT', 'PATCH'].includes(effectiveOptions.method.toUpperCase()) && typeof bodyForApiKeyCheck === 'string') {
        try {
          const bodyData = JSON.parse(bodyForApiKeyCheck);
          if (bodyData && bodyData.apiKey) {
            apiKeyIsNull = false;
            return originalFetch.apply(window, fetchCallArgs);
          }
        } catch (e) {
          // Ignore JSON parsing errors
        }
      }

      if(apiKeyIsNull) {
        const promiseId = nextPromiseId++;
        const promise = new Promise((resolve) => {
          pendingFetchResolvers[promiseId] = (resolvedResponse) => {
            delete pendingFetchResolvers[promiseId];
            resolve(resolvedResponse);
          };
        });

        let serializedBodyForPostMessage;
        if (typeof bodyForPostMessage === 'string' || bodyForPostMessage == null) {
            serializedBodyForPostMessage = bodyForPostMessage;
        } else if (bodyForPostMessage instanceof ReadableStream) {
            serializedBodyForPostMessage = null;
        } else {
            try {
                serializedBodyForPostMessage = JSON.stringify(bodyForPostMessage);
            } catch (e) {
                serializedBodyForPostMessage = null;
            }
        }

        const messageOptions = {
            method: effectiveOptions.method,
            headers: Object.fromEntries(new Headers(effectiveOptions.headers).entries()),
            body: serializedBodyForPostMessage
        };

        window.parent.postMessage({
          type: 'requestFetch',
          url: actualUrl,
          modelName: modelName,
          options: messageOptions,
          promiseId: promiseId,
        }, '*');

        return promise;
      }
      return originalFetch.apply(window, fetchCallArgs);
    }
    return originalFetch.apply(window, fetchCallArgs);
  };

  window.addEventListener('message', function(event) {
    if (event.data && event.data.type === 'resolveFetch') {
      const { promiseId, response } = event.data;
      if (pendingFetchResolvers[promiseId]) {
        try {
          const reconstructedResponse = new Response(response.body, {
            status: response.status,
            statusText: response.statusText,
            headers: new Headers(response.headers),
          });
          pendingFetchResolvers[promiseId](reconstructedResponse);
        } catch (error) {
          pendingFetchResolvers[promiseId](new Response(null, { status: 500, statusText: "Interceptor Response Reconstruction Error" }));
        }
      }
    }
  });

}))({"textModelName":"gemini-2.5-flash-preview-09-2025","imageModelName":"imagen-4.0-generate-001","imageEditModelName":"gemini-2.5-flash-image-preview","imageTransformModelName":"gemini-2.5-flash-image-preview","videoModelName":"veo-2.0-generate-001","ttsModelName":"gemini-2.5-flash-preview-tts","deprecatedTextModelNames":["gemini-2.0-flash","gemini-2.5-flash-preview-04-17","gemini-2.5-flash-preview-05-20"],"deprecatedImageModelNames":["imagen-3.0-generate-001","imagen-3.0-generate-002"]})</script><script>(function() {
  const originalConsoleLog = console.log;
  const originalConsoleError = console.error;

    /**
   * Normalizes an error event or a promise rejection reason into a structured error object.
   * @param {*} errorEventOrReason The error object or reason.
   * @return {object} Structured error data { message, name, stack }.
   */
  function getErrorObject(errorEventOrReason) {
    if (errorEventOrReason instanceof Error) {
      return {
        message: errorEventOrReason.message,
        name: errorEventOrReason.name,
        stack: errorEventOrReason.stack,
      };
    }
    // Fallback for non-Error objects.
    try {
      return {
        message: JSON.stringify(errorEventOrReason),
        name: 'UnknownErrorType',
        stack: null,
      };
    } catch (e) {
      return {
        message: String(errorEventOrReason),
        name: 'UnknownErrorTypeNonStringifiable',
        stack: null,
      };
    }
  }

  /**
   * Converts an array of arguments (from log/error) into a single string.
   * Handles Error objects specially to include their message and stack.
   * @param {Array<*>} args - Arguments passed to console methods.
   * @return {string} A string representation of the arguments.
   */
  function stringifyArgs(args) {
    return args
      .map((arg) => {
        if (arg instanceof Error) {
          const {message, stack} = arg;
          return `Error: ${message}${stack ? ('\nStack: ' + stack) : ''}`;
        }
        if (typeof arg === 'object' && arg !== null) {
          try {
            return JSON.stringify(arg);
          } catch (error) {
            return '[Circular Object]';
          }
        } else {
          return String(arg);
        }
      })
      .join(' ');
  }

  console.log = function(...args) {
    const logString = stringifyArgs(args);
    window.parent.postMessage({ type: 'log', message: logString }, '*');
    originalConsoleLog.apply(console, args);
  };

  console.error = function(...args) {
    let errorData;
    if (args.length > 0 && args[0] instanceof Error) {
      const err = args[0];
      // If the first arg is an Error, capture its details.
      errorData = {
        type: 'error',
        source: 'CONSOLE_ERROR',
        ...getErrorObject(err),
        rawArgsString: stringifyArgs(args.slice(1)),
        timestamp: new Date().toISOString(),
      };
    } else {
      // If not an Error object, treat all args as a general error message.
      errorData = {
        type: 'error',
        source: 'CONSOLE_ERROR',
        message: stringifyArgs(args),
        name: 'ConsoleLoggedError',
        stack: null,
        timestamp: new Date().toISOString(),
      };
    }
    window.parent.postMessage(errorData, '*');
    originalConsoleError.apply(console, args);
  };

  // Listen for global unhandled synchronous errors.
  window.addEventListener('error', function(event) {
    const errorDetails = event.error ? getErrorObject(event.error) : {
      message: event.message,
      name: 'GlobalError',
      stack: null,
      filename: event.filename,
      lineno: event.lineno,
      colno: event.colno,
    };

    window.parent.postMessage({
      type: 'error',
      source: 'global',
      ...errorDetails,
      message: errorDetails.message || event.message,
      timestamp: new Date().toISOString(),
    }, '*');
  });

  // Listen for unhandled promise rejections (asynchronous errors).
  window.addEventListener('unhandledrejection', function(event) {
    const errorDetails = getErrorObject(event.reason);

    window.parent.postMessage({
      type: 'error',
      source: 'unhandledrejection',
      ...errorDetails,
      message: errorDetails.message || 'Unhandled Promise Rejection',
      timestamp: new Date().toISOString(),
    }, '*');
  });

})();</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2025年11月18日 金融市場日報|洞察•解構•透視全球資產</title>
    <meta name="description" content="2025年11月18日 金融市場日報|洞察•解構•透視全球資產">

    <style>
        /* 系統字體堆疊 */
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Noto Sans TC", Roboto, "Helvetica Neue", Arial, sans-serif;
            background: #f8fafc;
            line-height: 1.6;
            color: #1e293b;
            margin: 0;
            padding: 0;
        }

        /* 標題階層 - 字體大小已調換 */
        .main-title {
            font-size: 2.5rem; /* 原為 3.125rem */
            font-weight: 700;
            color: #1e293b;
            text-align: center;
            margin-bottom: 0.5rem;
            background: linear-gradient(to right, #4f46e5, #ec4899);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        /* --- v3.1.1 修正: 移除 max-width --- */
        .sub-title {
            font-size: 3.125rem; /* 原為 2.5rem */
            font-weight: 600;
            color: #2563eb;
            text-align: center;
            margin-top: 0.5rem;
            display: block;
            margin-left: auto;
            margin-right: auto;
            /* 移除 max-width */
        }

        @media (max-width: 768px) {
             /* 響應式字體大小已調換 */
            .main-title { font-size: 1.5rem; } /* 原為 1.875rem */
            .sub-title { font-size: 1.875rem; } /* 原為 1.5rem */
        }

        /* 章節與容器 */
        section { scroll-margin-top: 120px; }
        h2 {
            font-size: 1.5rem;
            font-weight: 700;
            margin: 0.5rem 0 1.5rem 0;
            display: flex;
            align-items: center;
        }
        h3.table-title {
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: 1rem;
            text-align: left;
            color: #374151;
        }

        .container {
            max-width: 80rem;
            margin: 0 auto;
            padding: 1rem;
        }
        @media (min-width: 768px) {
            .container { padding: 2rem; }
        }

        /* 表格樣式 */
        .table-styled {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            margin: 1rem 0;
        }
        .table-styled caption {
            padding: 1rem;
            font-weight: 600;
            text-align: left;
            background: #f8fafc;
            border-bottom: 1px solid #e2e8f0;
            caption-side: top;
        }
        .table-styled thead th {
            background: #f1f5f9;
            padding: 0.75rem;
            font-weight: 600;
            color: #374151;
            border-bottom: 2px solid #e5e7eb;
            position: sticky;
            top: 0;
            text-align: center;
        }
        .table-styled thead th:first-child {
            text-align: left;
        }
        .table-styled tbody td {
            padding: 0.75rem;
            border-bottom: 1px solid #f1f5f9;
            font-weight: 400; /* 強制所有表格內容為正常字重 */
            text-align: center;
        }
        .table-styled tbody td:first-child {
            text-align: left;
            font-weight: 500; /* 第一欄稍加強調 */
        }
        /* 強制表格內容非粗體 */
        .table-styled tbody td strong {
             font-weight: normal !important;
        }
        /* 允許特定行加粗 */
         .table-styled tbody tr.summary-row td {
            font-weight: 600 !important; /* 針對總計行加粗 */
            border-top: 2px solid #e5e7eb;
         }


        /* 漲跌顏色 */
        .text-up { color: #dc2626; font-weight: 600; }
        .text-down { color: #059669; font-weight: 600; }
        .text-flat { color: #6b7280; font-weight: 500; }

        /* 熱度條 */
        .heat-container {
            margin: 1rem 0;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        .heat-item {
            display: flex;
            align-items: center;
            background: #f1f5f9;
            border-radius: 8px;
            overflow: hidden;
            position: relative;
            height: 2.5rem;
        }
        .heat-bar {
            display: flex;
            align-items: center;
            justify-content: flex-start; /* 文字靠左 */
            padding: 0.5rem 1rem;
            font-weight: 700;
            font-size: 1rem;
            color: white;
            height: 100%;
            border-radius: 8px 0 0 8px; /* 只有左邊圓角 */
            transition: all 0.3s ease;
            white-space: nowrap; /* 防止文字換行 */
            overflow: hidden; /* 隱藏超出部分 */
            text-overflow: ellipsis; /* 超出部分顯示省略號 */
        }
        .heat-bar-1 { background: #dc2626; width: 100%; border-radius: 8px; } /* 100% 兩邊都圓角 */
        .heat-bar-2 { background: #dc2626; width: 92%; }
        .heat-bar-3 { background: #ea580c; width: 84%; }
        .heat-bar-4 { background: #ea580c; width: 76%; }
        .heat-bar-5 { background: #d97706; width: 68%; }
        .heat-bar-6 { background: #d97706; width: 60%; }
        .heat-bar-7 { background: #eab308; width: 52%; color: #1f2937; }
        .heat-bar-8 { background: #eab308; width: 44%; color: #1f2937; }
        .heat-bar-9 { background: #84cc16; width: 36%; color: #1f2937; }
        .heat-bar-10 { background: #84cc16; width: 28%; color: #1f2937; }

        /* 卡片 */
        .section-card {
            background: white;
            border-radius: 16px;
            padding: 2rem;
            margin: 2rem 0;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            border-left: 4px solid transparent;
            transition: all 0.3s ease;
        }
        .section-card:first-child { margin-top: 0.5rem; }
        .section-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
            border-left-color: #4f46e5;
        }

        /* 導覽列 */
        .nav-sticky {
            position: sticky;
            top: 0;
            z-index: 50;
            background: rgba(255, 255, 255, 0.95);
            border-bottom: 1px solid #e2e8f0;
            padding: 1rem;
            backdrop-filter: blur(8px);
        }
        .nav-content {
            max-width: 80rem;
            margin: 0 auto;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow-x: auto;
            scroll-behavior: smooth;
            scrollbar-width: none; /* Firefox */
        }
        .nav-content::-webkit-scrollbar { display: none; } /* Chrome, Safari, Opera */
        .nav-links-group {
            display: flex;
            gap: 1rem;
            font-size: 0.875rem;
            white-space: nowrap;
            align-items: center;
            min-width: fit-content;
        }
        .nav-links-group a {
            padding: 0.5rem 1rem;
            border-radius: 8px;
            text-decoration: none;
            background: #dc2626;
            color: white;
            font-weight: 700;
            transition: all 0.2s ease;
            white-space: nowrap;
            flex-shrink: 0;
        }
        .nav-links-group a:hover {
            background: #b91c1c;
            transform: translateY(-1px);
        }
        .nav-links-group .download-btn {
            background: #059669;
            color: white;
            border: none;
            border-radius: 8px;
            padding: 0.5rem 1rem;
            font-size: 0.875rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            white-space: nowrap;
            flex-shrink: 0;
        }
        .nav-links-group .download-btn:hover {
            background: #047857;
            transform: translateY(-1px);
        }

        /* 時間軸標籤 */
        .timeline-tag {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-right: 0.75rem;
            vertical-align: top;
        }
        .timeline-tag-taiwan { background: #f1f5f9; color: #1e293b; }
        .timeline-tag-us { background: #f1f5f9; color: #dc2626; }
        .timeline-container p {
            margin: 0;
            padding: 0.125rem 0;
            line-height: 1.4;
             /* 字數控制由JS確保, CSS不強制 */
        }

        /* --- v3.1.9 保持 v3.1.8 的深度分析格式 --- */
        /* --- v3.1.10 維持 v3.1.9 (即 v2.8) 的深度分析格式 --- */
        .analysis-block {
            background: #fffbeb; /* 淺黃色背景 */
            border-left: 4px solid #f59e0b; /* 琥珀色左邊框 */
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 8px;
        }
        .analysis-block h4 { /* v2.8 "深度分析:" 標題樣式 */
            font-weight: 600;
            color: #92400e; /* 深琥珀色 */
            margin-bottom: 1rem;
            font-size: 1.125rem;
        }
        .structured-analysis p { /* v2.8 分析段落樣式 */
            line-height: 1.75;
            margin-bottom: 1rem;
        }
        .structured-analysis p:last-child {
            margin-bottom: 0;
        }
        .structured-analysis strong { /* v2.8 段落內粗體標題樣式 */
             display: inline; /* 與內容同行 */
             margin-right: 0.5em; /* 和內容稍微隔開 */
             color: #92400e; /* 深琥珀色 */
             font-size: 1rem;
             font-weight: 700;
        }
         /* v2.8 不使用 br 換行 */
         .structured-analysis br {
            display: none;
         }

        /* 市場數據卡片 */
        .market-overview-custom { margin: 1.5rem 0; }
        .market-overview-row-1 {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }
        /* --- v3.1.3 修正: 並排斷點改為 lg --- */
        .grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); } /* For Top10/Timeline */
        .grid-cols-1 { grid-template-columns: repeat(1, minmax(0, 1fr)); } /* Default for small screens */
        @media (min-width: 1024px) { /* lg breakpoint */
          .lg\:grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }
        }

        .market-overview-row-2 {
            display: grid;
            grid-template-columns: 1fr 3fr; /* 保持1:3比例 */
            gap: 1.5rem;
        }
        .market-card-new {
            background: white;
            border-radius: 12px;
            padding: 1.25rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            transition: all 0.2s ease;
            display: flex; /* 使用 Flexbox 布局 */
            flex-direction: column; /* 垂直排列 */
            justify-content: space-between; /* 內容均勻分布 */
            min-height: 120px; /* 設定最小高度 */
        }
        .market-card-new:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }
        .market-card-new.us-stock { border-left: 4px solid #dc2626; }
        .market-card-new.tw-stock { border-left: 4px solid #059669; }
        .market-card-new.bond { border-left: 4px solid #2563eb; }
        .market-card-new.commodity { border-left: 4px solid #f59e0b; }
        .market-card-new.fx { border-left: 4px solid #0891b2; }
        .market-card-title-new {
            font-size: 0.875rem;
            font-weight: 600;
            color: #6b7280;
            margin-bottom: 0.5rem;
        }
        .market-card-value-new {
            font-size: 1.125rem;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 0.5rem;
        }
         .market-card-value-new strong { font-weight: 700 !important; } /* 確保卡片數值加粗 */
        .market-card-change-new {
            font-size: 0.75rem;
            font-weight: 500;
            margin-top: auto; /* 將描述文字推到底部 */
        }
         .market-card-change-new strong { font-weight: bold !important; } /* 確保卡片漲跌幅加粗 */


        /* --- v3.1.9 維持 v3.1.8 的第7章表格樣式 (源自v2.8) --- */
        /* --- v3.1.10 維持 v3.1.9 (即 v2.8) 的第7章表格樣式 --- */
        .analysis-table { /* v2.8 style */
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            margin: 1rem 0;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            border-spacing: 0;
            table-layout: fixed;
        }
        .analysis-table th:first-child, .analysis-table td:first-child {
            width: 30%; /* v2.8 寬度 */
            padding-left: 0.75rem;
            vertical-align: top;
        }
        .analysis-table th:last-child, .analysis-table td:last-child {
            width: 70%; /* v2.8 寬度 */
            padding-right: 0.75rem;
            vertical-align: top;
        }
        .analysis-table td { /* v2.8 style */
            padding-top: 0.75rem;
            padding-bottom: 0.75rem;
            border-bottom: 1px solid #f1f5f9;
            word-wrap: break-word;
            text-align: left; /* v2.8 靠左對齊 */
            font-weight: 400 !important; /* 強制非粗體 */
        }
        .analysis-table th { /* v2.8 style */
            background: #f8fafc;
            padding-top: 0.75rem;
            padding-bottom: 0.75rem;
            font-weight: 600;
            text-align: left;
            color: #374151;
        }
        .analysis-table td strong { font-weight: normal !important; } /* 強制非粗體 */
        .analysis-table .font-semibold { font-weight: 600 !important; } /* 允許維度名稱加粗 */


        /* 個股推薦卡片 */
        .stock-recommendation {
            background: white;
            border-radius: 12px;
            padding: 2rem;
            margin: 2rem 0;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        /* --- v3.1.9 維持 v3.1.8 的 class name (源自v2.8) --- */
        /* --- v3.1.10 維持 v3.1.9 (即 v2.8) 的 class name (修改買進/賣出為看多/看空) --- */
        .stock-recommendation.bullish { border-left: 4px solid #059669; } /* 改為 bullish */
        .stock-recommendation.bearish { border-left: 4px solid #dc2626; } /* 改為 bearish */
        .recommendation-title {
            font-size: 1.125rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
        }
        /* --- v3.1.9 維持 v3.1.8 的 class name (源自v2.8) --- */
        /* --- v3.1.10 維持 v3.1.9 (即 v2.8) の class name (修改買進/賣出為看多/看空) --- */
        .recommendation-title.bullish { color: #059669; } /* 改為 bullish */
        .recommendation-title.bearish { color: #dc2626; } /* 改為 bearish */


        /* --- v3.1.9 維持 v3.1.8 的第7章按鈕樣式 (源自v2.8) --- */
        /* --- v3.1.10 維持 v3.1.9 (即 v2.8) 的第7章按鈕樣式 --- */
        .link-button-container { /* v2.8 container */
             display: flex;
             flex-direction: column;
             gap: 0.5rem;
             width: 100%; /* 確保容器寬度 */
             align-items: flex-start; /* 按鈕靠左 */
        }
        .link-button { /* v2.8 style */
            display: block; /* 改回 block */
            padding: 0.6rem 0.8rem;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.2s ease;
            text-align: center;
            width: 95%; /* 調整寬度 */
            max-width: 150px; /* 最大寬度 */
            margin: 0; /* 移除 auto margin */
            font-size: 0.875rem;
            box-sizing: border-box; /* 包含 padding */
        }
        .link-button.fundamental { background: #2563eb; color: white; }
        .link-button.fundamental:hover { background: #1d4ed8; }
        .link-button.technical { background: #374151; color: white; }
        .link-button.technical:hover { background: #111827; }
        .link-button-subtitle {
            display: block;
            font-size: 0.75rem;
            font-weight: 400;
            opacity: 0.9;
            margin-top: 0.25rem;
        }


        /* 回頂按鈕 */
        .back-to-top {
            position: fixed;
            left: 1.5rem;
            bottom: 1.5rem;
            background: #4f46e5;
            color: white;
            border: none;
            border-radius: 50%;
            width: 48px;
            height: 48px;
            font-size: 1.125rem;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 40;
            transition: all 0.2s ease;
        }
        .back-to-top:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
        }

        /* 進度條 */
        .progress-bar {
            height: 3px;
            background: #4f46e5;
            position: fixed;
            top: 0;
            left: 0;
            z-index: 100;
            transition: width 0.3s ease;
        }

        /* 網格佈局 (通用) */
        .grid { display: grid; }
        .gap-8 { gap: 2rem; }

        /* TL;DR區塊 */
        .tldr-block {
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1.5rem;
        }
        .tldr-block ul {
            list-style: none;
            padding: 0;
            margin: 0;
            font-size: 1rem;
        }
        /* --- v3.1.1 修正: 移除 max-width --- */
        .tldr-block li {
            margin: 0.75rem 0;
            padding-left: 1rem;
            position: relative;
            /* 移除 max-width */
        }
        .tldr-block li::before {
            content: "•";
            position: absolute;
            left: 0;
            font-weight: 700;
        }
         /* --- v3.1.10 修正: TL;DR 區塊內的 strong 標籤改為粗體 --- */
         .tldr-block li strong {
            font-weight: 700 !important;
         }

        /* 響應式 */
        @media (max-width: 1024px) {
            .market-overview-row-1 { grid-template-columns: repeat(2, 1fr); }
            /* lg斷點以下 (平板) Top10/時間軸垂直排列已由上方 grid-cols-1 處理 */
        }
        @media (max-width: 768px) {
            .grid-cols-2, .lg\:grid-cols-2 { grid-template-columns: 1fr; } /* 手機全部垂直排列 */
            .market-overview-row-1,
            .market-overview-row-2 { grid-template-columns: 1fr; }
            .back-to-top { left: 1rem; bottom: 5rem; }
            /* --- v3.1.9 維持 v3.1.8 的手機表格寬度 --- */
            /* --- v3.1.10 維持 v3.1.9 (即 v2.8) 的第7章手機表格寬度 --- */
            .analysis-table th:first-child, .analysis-table td:first-child {
                width: 40%; /* v2.8 手機版寬度 */
            }
            .analysis-table th:last-child, .analysis-table td:last-child {
                width: 60%; /* v2.8 手機版寬度 */
            }

            .nav-content {
                justify-content: flex-start;
                padding-left: 0.5rem;
                padding-right: 0.5rem;
            }
            .nav-links-group { gap: 0.75rem; }
        }

        /* 工具類 */
        .text-center { text-align: center; }
        .text-right { text-align: right; }
        .font-semibold { font-weight: 600; }
        .text-xs { font-size: 0.75rem; }
        .mt-4 { margin-top: 1rem; }
        .overflow-x-auto { overflow-x: auto; }

        @media print {
            .nav-sticky, .back-to-top, .download-btn, .progress-bar { display: none; }
        }
    </style>
</head>
<body>

<!-- 進度條 -->
<div class="progress-bar" id="progressBar" style="width: 0%; opacity: 0; transition: opacity 0.5s ease-out; display: none;"></div>

<!-- 導覽工具列 -->
<div class="nav-sticky">
    <div class="nav-content">
        <div class="nav-links-group">
            <a href="#sec-1">市場總覽</a>
            <a href="#sec-2">歐美股市</a>
            <a href="#sec-3">債券市場</a>
            <a href="#sec-4">大宗商品</a>
            <a href="#sec-5">台股解析</a>
            <a href="#sec-6">匯率市場</a>
            <a href="#sec-7">產業展望</a>
            <button class="download-btn" id="smartDownloadBtn">🔥 下載日報</button>
        </div>
    </div>
</div>

<div class="container">

    <!-- 標題 -->
    <header style="text-align: center; margin: 0;">
        <h1 class="main-title" style="margin: 0; margin-bottom: 0.125rem;">2025年11月18日 金融市場日報</h1>
        <p class="sub-title" style="margin: 0;">Fed轉鷹、輝達財報前觀望，道瓊下跌逾550點</p>
    </header>

    <!-- 第1章:市場總覽與重點 -->
    <section id="sec-1" class="section-card">
        <h2 style="color: #015fb4;"><span style="margin-right: 0.75rem;">📋</span>第1章｜市場總覽與重點</h2>

        <div class="tldr-block" style="background: #f0f9ff;">
            <h3 class="table-title">市場三大要點</h3>
            <ul>
                <li style="color: #015fb4;"><strong>Fed官員轉鷹：</strong>Fed副主席稱政策接近中性、後續需更慢，市場對12月降息預期降溫，壓抑美股道瓊指數下跌逾550點。</li>
                <li style="color: #015fb4;"><strong>輝達財報前承壓：</strong>輝達(Nvidia)財報公布在即，市場觀望氣氛濃厚，科技股普遍承壓，費城半導體指數下跌1.55%。</li>
                <li style="color: #015fb4;"><strong>外資終止連賣：</strong>台股(11/17)擺脫前日大跌陰影，外資終止連續11賣轉為買超73億元，指數小漲49點收復27400點關卡。</li>
            </ul>
        </div>

        <div class="market-overview-custom">
            <h3 class="table-title">市場核心數據速覽</h3>
            <div class="market-overview-row-1">
                <div class="market-card-new us-stock">
                    <div class="market-card-title-new">美股市場</div>
                    <div class="market-card-value-new">標普500 <strong>6,672.41</strong></div>
                    <div class="market-card-change-new text-down">▼ <strong>-0.92%</strong> • 費半指數下跌1.55%，輝達財報前市場承壓。</div>
                </div>
                <div class="market-card-new tw-stock">
                    <div class="market-card-title-new">台股市場</div>
                    <div class="market-card-value-new">加權 <strong>27,447.31</strong></div>
                    <div class="market-card-change-new text-up">▲ <strong>+0.18%</strong> • (11/17)外資終止連11賣轉買超73億，指數小漲49點。</div>
                </div>
                <div class="market-card-new bond">
                    <div class="market-card-title-new">債券市場</div>
                    <div class="market-card-value-new">10年期殖利率 <strong>4.13%</strong></div>
                    <div class="market-card-change-new text-down">▼ <strong>-1.5 bps</strong> • Fed官員言論偏鷹，但數據公布前殖利率小幅回落。</div>
                </div>
                <div class="market-card-new commodity">
                    <div class="market-card-title-new">大宗商品</div>
                    <div class="market-card-value-new">黃金期貨 <strong>4,045.10</strong></div>
                    <div class="market-card-change-new text-down">▼ <strong>-1.04%</strong> • 降息預期降溫推升美元，金價承壓回落，布蘭特 -1.29%。</div>
                </div>
            </div>
            <div class="market-overview-row-2">
                <div class="market-card-new fx">
                    <div class="market-card-title-new">匯率市場</div>
                    <div class="market-card-value-new">美元指數 <strong>99.52</strong></div>
                    <div class="market-card-change-new text-up">▲ <strong>+0.26%</strong> • Fed降息預期緩和，美元指數反彈，台幣(11/17)貶至31.18元。</div>
                </div>
                <div></div>
            </div>
        </div>

         <!-- --- v3.1.3 修正: 並排斷點改為 lg --- -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <div>
                <h3 class="table-title">Top 10 市場熱點事件榜</h3>
                <div class="heat-container">
                    <div class="heat-item"><div class="heat-bar heat-bar-1">Fed官員轉鷹</div></div>
                    <div class="heat-item"><div class="heat-bar heat-bar-2">輝達財報觀望</div></div>
                    <div class="heat-item"><div class="heat-bar heat-bar-3">道瓊重挫逾550點</div></div>
                    <div class="heat-item"><div class="heat-bar heat-bar-4">俄油港恢復出口</div></div>
                    <div class="heat-item"><div class="heat-bar heat-bar-5">比特幣跌破9.4萬</div></div>
                    <div class="heat-item"><div class="heat-bar heat-bar-6">三星DRAM漲價60%</div></div>
                    <div class="heat-item"><div class="heat-bar heat-bar-7">中日外交衝突升溫</div></div>
                    <div class="heat-item"><div class="heat-bar heat-bar-8">外資終止連11賣</div></div>
                    <div class="heat-item"><div class="heat-bar heat-bar-9">記憶體庫存不足三周</div></div>
                    <div class="heat-item"><div class="heat-bar heat-bar-10">中美稀土協議</div></div>
                </div>
                <p class="text-xs" style="color: #64748b; margin-top: 0.5rem;">*熱度基於過去24小時新聞與社群討論量標準化</p>
            </div>
            <div>
                <h3 class="table-title">市場關鍵時間軸</h3>
                <div class="structured-analysis space-y-4 timeline-container">
                    <p><span class="timeline-tag timeline-tag-taiwan">台股盤中</span>(11/17) 外資終止連11賣轉買超73億元,權值股回穩,台積電上漲0.21%,指數開高走高收復27400點關卡。</p>
                    <p><span class="timeline-tag timeline-tag-taiwan">台股盤後</span> 16:54 (11/17) 記憶體漲價效應擴大,聯強法說會看旺景氣至2026年,但大摩警告漲價將壓縮PC廠毛利,下調戴爾、惠普評級。</p>
                    <p><span class="timeline-tag timeline-tag-taiwan">台股盤後</span> 17:05 (11/17) 創意(3443)宣布結盟Ayar Labs,將CPO(矽光子)技術整合進ASIC服務,立碁(8111)亦宣布加入矽光子國家隊。</p>
                    <p><span class="timeline-tag timeline-tag-taiwan">台股盤後</span> 18:25 (11/17) 台幣(USD/TWD)午後升幅回吐,終場貶值2.4分收31.18元,創逾半年新低。中信金估年底匯率在30元震盪。</p>
                    <p><span class="timeline-tag timeline-tag-taiwan">台股盤後</span> 19:42 (11/17) GMI Cloud攜手輝達,宣布在台打造5億美元AI資料中心。鴻海(2317)亦傳出將攜手三菱在日本生產電動巴士。</p>
                    <p><span class="timeline-tag timeline-tag-us">美股盤前</span> 23:00 (11/17) 加拿大10月CPI年增速降至2.2%,通膨數據降溫。日本Q3 GDP萎縮1.8%,六季來首次負成長,日圓承壓。</p>
                    <p><span class="timeline-tag timeline-tag-us">美股盤前</span> 04:30 (11/18) 阿里「千問」APP上線公測,揮軍AI to C市場,但傳出服務不穩。字節跳動旗下抖音則霸榜蘋果中國區免費榜前五名。</p>
                    <p><span class="timeline-tag timeline-tag-us">美股盤中</span>(11/18) Fed副主席(二把手)發表鷹派言論,稱政策已接近中性,後續需更慢,暗示12月降息恐卡關,市場預期降溫。</p>
                    <p><span class="timeline-tag timeline-tag-us">美股盤後</span> 05:56 (11/18) 俄羅斯黑海油港在短暫停擺後恢復出口,緩解上週供應擔憂,拖累WTI油價小幅回落0.72%,收於59.66美元。</p>
                    <p><span class="timeline-tag timeline-tag-us">美股盤後</span> 06:00 (11/18) 美股收盤,輝達財報前市場觀望,科技股領跌,道瓊下跌557點(-1.18%),費半指數下跌1.55%,台積電ADR下跌1.38%。</p>
                </div>
            </div>
        </div>
    </section>

    <!-- 第2章:歐美股市 -->
    <section id="sec-2" class="section-card">
        <h2 style="color: #dc2626;"><span style="margin-right: 0.75rem;">📈</span>第2章｜歐美股市</h2>

        <div class="tldr-block" style="background: #fef2f2;">
            <ul>
                <li style="color: #dc2626;"><strong>Fed官員轉鷹：</strong>Fed副主席稱政策接近中性、後續需更慢，市場對12月降息預期降溫，壓抑美股道瓊指數下跌逾550點。</li>
                <li style="color: #dc2626;"><strong>輝達財報觀望：</strong>輝達(Nvidia)財報將於本週三公布，市場觀望氣氛濃厚，科技股普遍承壓，費城半導體指數下跌1.55%。</li>
                <li style="color: #dc2626;"><strong>科技巨頭債務：</strong>華爾街對科技巨頭因AI競賽而飆升的債務感到擔憂，相關CDS避險部位激增，亞馬遜啟動新一輪公司債發行。</li>
            </ul>
        </div>

        <h3 class="table-title">歐美主要股市行情</h3>
        <div class="overflow-x-auto">
            <table class="table-styled">
                <caption>歐美主要股市指數漲跌概覽</caption>
                <thead>
                    <tr>
                        <th>指標名稱</th>
                        <th>最新收盤價</th>
                        <th>日漲跌</th>
                        <th>五日漲跌</th>
                        <th>月漲跌</th>
                        <th>季漲跌</th>
                        <th>年初至今</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>道瓊工業指數</td>
                        <td><strong>46,590.24</strong></td>
                        <td class="text-down"><strong>-1.18%</strong></td>
                        <td class="text-down"><strong>-0.84%</strong></td>
                        <td class="text-up"><strong>+1.39%</strong></td>
                        <td class="text-up"><strong>+3.66%</strong></td>
                        <td class="text-up"><strong>+9.51%</strong></td>
                    </tr>
                    <tr>
                        <td>標普500</td>
                        <td><strong>6,672.41</strong></td>
                        <td class="text-down"><strong>-0.92%</strong></td>
                        <td class="text-down"><strong>-0.84%</strong></td>
                        <td class="text-up"><strong>+0.65%</strong></td>
                        <td class="text-up"><strong>+3.45%</strong></td>
                        <td class="text-up"><strong>+13.44%</strong></td>
                    </tr>
                    <tr>
                        <td>那斯達克</td>
                        <td><strong>22,708.07</strong></td>
                        <td class="text-down"><strong>-0.84%</strong></td>
                        <td class="text-down"><strong>-1.29%</strong></td>
                        <td class="text-up"><strong>+0.65%</strong></td>
                        <td class="text-up"><strong>+5.02%</strong></td>
                        <td class="text-up"><strong>+17.59%</strong></td>
                    </tr>
                    <tr>
                        <td>費城半導體指數</td>
                        <td><strong>6,705.74</strong></td>
                        <td class="text-down"><strong>-1.55%</strong></td>
                        <td class="text-down"><strong>-3.48%</strong></td>
                        <td class="text-down"><strong>-1.39%</strong></td>
                        <td class="text-up"><strong>+16.57%</strong></td>
                        <td class="text-up"><strong>+34.66%</strong></td>
                    </tr>
                    <tr>
                        <td>羅素2000</td>
                        <td><strong>2,341.38</strong></td>
                        <td class="text-down"><strong>-1.96%</strong></td>
                        <td class="text-down"><strong>-3.76%</strong></td>
                        <td class="text-down"><strong>-5.09%</strong></td>
                        <td class="text-up"><strong>+2.40%</strong></td>
                        <td class="text-up"><strong>+4.99%</strong></td>
                    </tr>
                    <tr>
                        <td>道瓊歐洲50</td>
                        <td><strong>5,640.94</strong></td>
                        <td class="text-down"><strong>-0.93%</strong></td>
                        <td class="text-up"><strong>+1.34%</strong></td>
                        <td class="text-down"><strong>-0.20%</strong></td>
                        <td class="text-up"><strong>+3.53%</strong></td>
                        <td class="text-up"><strong>+15.85%</strong></td>
                    </tr>
                </tbody>
            </table>
        </div>
        <p class="text-xs text-right" style="color: #64748b; margin-top: 0.5rem;">資料來源: Yahoo Finance</p>

        <!-- --- v3.1.9 替換: 深度分析區塊使用 v2.8 格式 --- -->
        <div class="analysis-block">
            <h4>深度分析:</h4>
            <div class="structured-analysis">
                 <p><strong>Fed官員言論轉鷹，輝達財報前市場承壓，美股全面收黑</strong><br>美股週一(11/17)在鷹派言論與財報觀望情緒下全面收黑，道瓊工業指數下跌<strong>-1.18%</strong>(<strong>-557點</strong>)，標普500下跌<strong>-0.92%</strong>。主要驅動因子為Fed副主席(二把手)發表談話，稱政策已接近中性、後續需更慢，澆熄市場對12月降息的樂觀預期。此番言論導致科技股估值壓力重現，加上投資人靜待週三輝達(Nvidia)財報公布，市場觀望氣氛濃厚，費城半導體指數領跌<strong>-1.55%</strong>，小型股羅素2000指數跌幅更深達<strong>-1.96%</strong>，顯示市場風險偏好明顯降溫。</p>
                 <p><strong>AI泡沫擔憂浮現，科技巨頭債務風險引發華爾街關注</strong><br>市場對AI的狂熱正遭遇現實檢驗，CoreWeave上週的股價重挫顯示投資人不再對AI題材照單全收。同時，華爾街開始關注科技巨頭為應對AI競賽而大幅增加的資本支出與債務水平，相關的信用違約交換(CDS)避險部位激增。亞馬遜(Amazon)週一啟動近三年來首次美元公司債發行計畫，進一步引發市場對科技巨頭現金流的討論。在輝達財報公布前，市場正重新評估AI相關個股的高估值與其背後的財務風險。</p>
            </div>
        </div>
    </section>

    <!-- 第3章:債券市場 -->
    <section id="sec-3" class="section-card">
        <h2 style="color: #2563eb;"><span style="margin-right: 0.75rem;">🏛️</span>第3章｜債券市場</h2>

        <div class="tldr-block" style="background: #eff6ff;">
            <ul>
                <li style="color: #2563eb;"><strong>降息預期降溫：</strong>Fed副主席言論偏鷹，暗示12月降息機率降低，市場重新評估利率路徑，壓抑債券價格，殖利率小幅波動。</li>
                <li style="color: #2563eb;"><strong>數據真空期：</strong>市場靜待本週將公布的美國9月非農就業數據(因政府停擺延後)，在關鍵數據出爐前，債市交易員態度謹慎。</li>
                <li style="color: #2563eb;"><strong>巨頭發債：</strong>亞馬遜啟動美元公司債發行計畫，科技巨頭為AI籌資的需求可能增加債券市場供給，對殖利率形成潛在壓力。</li>
            </ul>
        </div>

        <h3 class="table-title">主要債券與殖利率行情</h3>
        <div class="overflow-x-auto">
            <table class="table-styled">
                <caption>主要債券與殖利率變動概覽</caption>
                <thead>
                    <tr>
                        <th>指標名稱</th>
                        <th>最新殖利率/價格</th>
                        <th>日變動</th>
                        <th>五日變動</th>
                        <th>月變動</th>
                        <th>季變動</th>
                        <th>年初至今變動</th>
                    </tr>
                </thead>
                <!-- --- v3.1.2 修正: 補齊表格行佔位符 --- -->
                <tbody>
                    <tr>
                        <td>美國3月期殖利率</td>
                        <td><strong>3.77%</strong></td>
                        <td class="text-down"><strong>-1.6 bps</strong></td>
                        <td class="text-up"><strong>+1.5 bps</strong></td>
                        <td class="text-down"><strong>-8.1 bps</strong></td>
                        <td class="text-down"><strong>-34.0 bps</strong></td>
                        <td class="text-down"><strong>-43.6 bps</strong></td>
                    </tr>
                    <tr>
                        <td>美國5年期殖利率</td>
                        <td><strong>3.72%</strong></td>
                        <td class="text-down"><strong>-1.4 bps</strong></td>
                        <td class="text-up"><strong>+4.1 bps</strong></td>
                        <td class="text-up"><strong>+17.1 bps</strong></td>
                        <td class="text-down"><strong>-12.4 bps</strong></td>
                        <td class="text-down"><strong>-65.9 bps</strong></td>
                    </tr>
                    <tr>
                        <td>美國10年期殖利率</td>
                        <td><strong>4.13%</strong></td>
                        <td class="text-down"><strong>-1.5 bps</strong></td>
                        <td class="text-up"><strong>+4.0 bps</strong></td>
                        <td class="text-up"><strong>+15.7 bps</strong></td>
                        <td class="text-down"><strong>-19.5 bps</strong></td>
                        <td class="text-down"><strong>-44.0 bps</strong></td>
                    </tr>
                    <tr>
                        <td>美國30年期殖利率</td>
                        <td><strong>4.74%</strong></td>
                        <td class="text-down"><strong>-1.1 bps</strong></td>
                        <td class="text-up"><strong>+3.6 bps</strong></td>
                        <td class="text-up"><strong>+15.3 bps</strong></td>
                        <td class="text-down"><strong>-19.0 bps</strong></td>
                        <td class="text-down"><strong>-5.0 bps</strong></td>
                    </tr>
                    <tr>
                        <td>高收益債券ETF(HYG)</td>
                        <td><strong>80.09</strong></td>
                        <td class="text-down"><strong>-0.16%</strong></td>
                        <td class="text-down"><strong>-0.30%</strong></td>
                        <td class="text-down"><strong>-0.52%</strong></td>
                        <td class="text-down"><strong>-0.46%</strong></td>
                        <td class="text-up"><strong>+1.83%</strong></td>
                    </tr>
                    <tr>
                        <td>新興市場美元債ETF(EMB)</td>
                        <td><strong>95.99</strong></td>
                        <td class="text-up"><strong>+0.02%</strong></td>
                        <td class="text-down"><strong>-0.03%</strong></td>
                        <td class="text-up"><strong>+0.29%</strong></td>
                        <td class="text-up"><strong>+2.28%</strong></td>
                        <td class="text-up"><strong>+7.81%</strong></td>
                    </tr>
                </tbody>
            </table>
        </div>
        <p class="text-xs text-right" style="color: #64748b; margin-top: 0.5rem;">資料來源: Yahoo Finance</p>

        <!-- --- v3.1.9 替換: 深度分析區塊使用 v2.8 格式 --- -->
        <div class="analysis-block">
            <h4>深度分析:</h4>
            <div class="structured-analysis">
                <p><strong>Fed官員鷹派言論降溫降息預期，債市靜待非農數據</strong><br>美國公債殖利率週一(11/17)漲跌互見，10年期殖利率小幅回落<strong>-1.5 bps</strong>至<strong>4.13%</strong>。市場主要在消化Fed副主席的鷹派言論，其暗示12月降息可能性降低，使殖利率在盤中一度走高。然而，由於美國政府停擺導致的9月非農就業數據延後至本週公布，在關鍵數據明朗前，市場情緒謹慎，美債交易員不敢大舉押注，殖利率走勢陷入盤整。</p>
                <p><strong>科技巨頭發債需求升溫，高收益債隨股市承壓</strong><br>隨著亞馬遜等科技巨頭為AI資本支出而重啟公司債發行，市場擔憂債券供給增加可能對殖利率造成上行壓力。同時，華爾街對科技巨頭債務風險的擔憂，也使得信用利差擴大。高收益債券ETF(HYG)下跌<strong>-0.16%</strong>，顯示在股市風險偏好降溫時，資金同樣從高風險債券中流出，反映出市場對信貸風險的警惕性正在提高。</p>
            </div>
        </div>
    </section>

    <!-- 第4章:大宗商品 -->
    <section id="sec-4" class="section-card">
        <h2 style="color: #cc4e01;"><span style="margin-right: 0.75rem;">🔥</span>第4章｜大宗商品</h2>

        <div class="tldr-block" style="background: #fffbeb;">
            <ul>
                <li style="color: #cc4e01;"><strong>油價小幅回落：</strong>俄羅斯黑海油港在週五(11/14)遭襲擊後恢復出口，市場對供應中斷的擔憂緩解，WTI原油價格回落0.72%。</li>
                <li style="color: #cc4e01;"><strong>降息預期降溫：</strong>Fed官員發表鷹派言論，推動美元指數反彈，對以美元計價的黃金構成壓力，金價下跌1.04%，收於4045美元。</li>
                <li style="color: #cc4e01;"><strong>黃豆價格反彈：</strong>受中國採購預期提振，黃豆期貨價格反彈，一度創下17個月新高，顯示農產品市場仍受需求面支撐。</li>
            </ul>
        </div>

        <h3 class="table-title">能源與商品市場行情</h3>
        <div class="overflow-x-auto">
            <table class="table-styled">
                <caption>能源與商品市場價格變動概覽</caption>
                <thead>
                    <tr>
                        <th>指標名稱</th>
                        <th>最新價格</th>
                        <th>日漲跌</th>
                        <th>五日漲跌</th>
                        <th>月漲跌</th>
                        <th>季漲跌</th>
                        <th>年初至今</th>
                    </tr>
                </thead>
                 <!-- --- v3.1.2 修正: 補齊表格行佔位符 --- -->
                <tbody>
                    <tr>
                        <td>WTI原油</td>
                        <td><strong>59.66</strong></td>
                        <td class="text-down"><strong>-0.72%</strong></td>
                        <td class="text-down"><strong>-0.15%</strong></td>
                        <td class="text-up"><strong>+3.83%</strong></td>
                        <td class="text-down"><strong>-5.00%</strong></td>
                        <td class="text-down"><strong>-16.82%</strong></td>
                    </tr>
                    <tr>
                        <td>布蘭特原油</td>
                        <td><strong>63.56</strong></td>
                        <td class="text-down"><strong>-1.29%</strong></td>
                        <td class="text-down"><strong>-0.11%</strong></td>
                        <td class="text-up"><strong>+4.09%</strong></td>
                        <td class="text-down"><strong>-3.48%</strong></td>
                        <td class="text-down"><strong>-14.84%</strong></td>
                    </tr>
                    <tr>
                        <td>黃金期貨</td>
                        <td><strong>4,045.10</strong></td>
                        <td class="text-down"><strong>-1.04%</strong></td>
                        <td class="text-up"><strong>+1.14%</strong></td>
                        <td class="text-down"><strong>-5.49%</strong></td>
                        <td class="text-up"><strong>+21.26%</strong></td>
                        <td class="text-up"><strong>+53.85%</strong></td>
                    </tr>
                    <tr>
                        <td>基礎金屬ETF (DBB)</td>
                        <td><strong>21.33</strong></td>
                        <td class="text-down"><strong>-1.16%</strong></td>
                        <td class="text-down"><strong>-1.25%</strong></td>
                        <td class="text-up"><strong>+1.19%</strong></td>
                        <td class="text-up"><strong>+9.27%</strong></td>
                        <td class="text-up"><strong>+13.16%</strong></td>
                    </tr>
                </tbody>
            </table>
        </div>
        <p class="text-xs text-right" style="color: #64748b; margin-top: 0.5rem;">資料來源: Yahoo Finance</p>

        <!-- --- v3.1.9 替換: 深度分析區塊使用 v2.8 格式 --- -->
        <div class="analysis-block">
            <h4>深度分析:</h4>
            <div class="structured-analysis">
                <p><strong>俄油港恢復出口緩解供應擔憂，油價自高點回落</strong><br>國際油價週一(11/17)小幅回落，WTI原油收跌<strong>-0.72%</strong>至每桶<strong>59.66美元</strong>。主要原因是上週五遭烏克蘭襲擊的俄羅斯黑海油港已恢復出口作業，緩解了市場對全球約2%供應中斷的擔憂。儘管地緣政治衝突未歇，但短期供應風險的解除導致油價從高位回調。同時，傳出雪佛龍(Chevron)可能加入競購盧克石油海外資產，顯示大型油企仍在尋求擴張。</p>
                <p><strong>Fed鷹派言論推升美元，黃金價格承壓失守4050關卡</strong><br>黃金期貨價格下跌<strong>-1.04%</strong>，收於<strong>4,045.10美元</strong>。Fed副主席的鷹派言論導致市場對12月降息的預期降溫，推動美元指數(DXY)反彈。由於黃金以美元計價且不孳息，美元走強和利率預期上升對金價構成直接壓力。公股銀行認為，在關鍵經濟數據公布前，金價短期可能陷入盤整格局。</p>
            </div>
        </div>
    </section>

    <!-- 第5章:台股解析 -->
    <section id="sec-5" class="section-card">
        <h2 style="color: #059669;"><span style="margin-right: 0.75rem;">🗻</span>第5章｜台股解析</h2>

        <div class="tldr-block" style="background: #f0fdf4;">
            <ul>
                <li style="color: #059669;"><strong>外資終止連賣：</strong>(11/17) 外資終止連續11個交易日的賣超，轉為買超73.35億元，帶動投信與自營商賣壓，指數小漲49點。</li>
                <li style="color: #059669;"><strong>記憶體漲價：</strong>(11/17) 三星傳DRAM報價大漲60%，聯強看旺景氣至2026年，但大摩警告PC廠成本壓力，相關個股走勢分歧。</li>
                <li style="color: #059669;"><strong>矽光子題材熱：</strong>(11/17) 創意(3443)宣布結盟Ayar Labs導入CPO技術，立碁(8111)亦宣布加入矽光子國家隊，題材增溫。</li>
            </ul>
        </div>

        <div class="overflow-x-auto">
            <table class="table-styled">
                <caption>亞洲主要股市指數漲跌概覽</caption>
                <thead>
                    <tr>
                        <th>指標名稱</th>
                        <th>最新收盤價</th>
                        <th>日漲跌</th>
                        <th>五日漲跌</th>
                        <th>月漲跌</th>
                        <th>季漲跌</th>
                        <th>年初至今</th>
                    </tr>
                </thead>
                 <!-- --- v3.1.2 修正: 補齊表格行佔位符 --- -->
                <tbody>
                    <tr>
                        <td>台灣加權指數</td>
                        <td><strong>27,447.31</strong></td>
                        <td class="text-up"><strong>+0.18%</strong></td>
                        <td class="text-down"><strong>-0.74%</strong></td>
                        <td class="text-down"><strong>-0.73%</strong></td>
                        <td class="text-up"><strong>+12.79%</strong></td>
                        <td class="text-up"><strong>+19.15%</strong></td>
                    </tr>
                    <tr>
                        <td>日經225</td>
                        <td><strong>50,323.91</strong></td>
                        <td class="text-down"><strong>-0.10%</strong></td>
                        <td class="text-up"><strong>+0.09%</strong></td>
                        <td class="text-up"><strong>+4.24%</strong></td>
                        <td class="text-up"><strong>+16.01%</strong></td>
                        <td class="text-up"><strong>+26.14%</strong></td>
                    </tr>
                    <tr>
                        <td>香港恆生指數</td>
                        <td><strong>26,384.28</strong></td>
                        <td class="text-down"><strong>-0.71%</strong></td>
                        <td class="text-up"><strong>+0.54%</strong></td>
                        <td class="text-up"><strong>+1.92%</strong></td>
                        <td class="text-up"><strong>+4.41%</strong></td>
                        <td class="text-up"><strong>+31.53%</strong></td>
                    </tr>
                    <tr>
                        <td>韓國KOSPI</td>
                        <td><strong>4,089.25</strong></td>
                        <td class="text-up"><strong>+1.94%</strong></td>
                        <td class="text-up"><strong>+3.43%</strong></td>
                        <td class="text-up"><strong>+9.09%</strong></td>
                        <td class="text-up"><strong>+26.77%</strong></td>
                        <td class="text-up"><strong>+70.42%</strong></td>
                    </tr>
                    <tr>
                        <td>印度SENSEX</td>
                        <td><strong>84,950.95</strong></td>
                        <td class="text-up"><strong>+0.46%</strong></td>
                        <td class="text-up"><strong>+2.08%</strong></td>
                        <td class="text-up"><strong>+1.78%</strong></td>
                        <td class="text-up"><strong>+5.40%</strong></td>
                        <td class="text-up"><strong>+8.72%</strong></td>
                    </tr>
                </tbody>
            </table>
        </div>
        <p class="text-xs text-right" style="color: #64748b; margin-top: 0.5rem;">資料來源: Yahoo Finance</p>

        <h3 class="table-title" style="margin-top: 2rem;">台股三大法人買賣超 (2025年11月17日)</h3>
        <div class="overflow-x-auto">
            <table class="table-styled">
                <caption>台股三大法人買賣超統計</caption>
                <thead>
                    <tr>
                        <th>法人別</th>
                        <th>當日淨額(億)</th>
                        <th>5日累計(億)</th>
                        <th>20日累計(億)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>外資</td>
                        <td class="text-up"><strong>+73.35</strong></td>
                        <td class="text-down"><strong>-855.52</strong></td>
                        <td class="text-down"><strong>-2513.60</strong></td>
                    </tr>
                    <tr>
                        <td>投信</td>
                        <td class="text-down"><strong>-86.13</strong></td>
                        <td class="text-down"><strong>-148.30</strong></td>
                        <td class="text-down"><strong>-355.46</strong></td>
                    </tr>
                    <tr>
                        <td>自營商</td>
                        <td class="text-down"><strong>-146.99</strong></td>
                        <td class="text-down"><strong>-332.97</strong></td>
                        <td class="text-up"><strong>+93.11</strong></td>
                    </tr>
                    <tr class="summary-row">
                        <td>總計</td>
                        <td class="text-down"><strong>-159.77</strong></td>
                        <td class="text-down"><strong>-1336.79</strong></td>
                        <td class="text-down"><strong>-2775.95</strong></td>
                    </tr>
                </tbody>
            </table>
        </div>
        <p class="text-xs text-right" style="color: #64748b; margin-top: 0.5rem;">資料來源: 交易所資料整理</p>

        <!-- --- v3.1.9 替換: 深度分析區塊使用 v2.8 格式 --- -->
        <div class="analysis-block">
            <h4>深度分析:</h4>
            <div class="structured-analysis">
                <p><strong>外資終止連11賣轉買超73億，台股反彈49點站回月線</strong><br>台股週一(11/17)止跌反彈，加權指數上漲<strong>+0.18%</strong>(<strong>+49點</strong>)，收在<strong>27,447.31點</strong>，重新站回月線之上。主要動能來自外資籌碼回穩，終止了連續11個交易日的賣超，轉為買超<strong>73.35億元</strong>。台積電(2330)上漲<strong>+0.21%</strong>，扮演穩定軍心的角色。然而，投信(賣超<strong>-86.13億</strong>)與自營商(賣超<strong>-146.99億</strong>)仍持續調節，三大法人合計仍賣超<strong>-159.77億元</strong>，顯示本土法人態度相對保守。</p>
                <p><strong>記憶體漲價與矽光子題材增溫，惟PC鏈面臨成本壓力</strong><br>盤面焦點集中在題材股。記憶體族群受三星傳出DRAM報價大漲<strong>60%</strong>激勵，聯強(2347)法說會亦看旺景氣至2026年；但大摩隨即發布報告警告，記憶體漲價將壓縮PC品牌廠毛利，下調戴爾、惠普評級，使個股走勢分歧。另一方面，矽光子題材持續發酵，創意(3443)宣布結盟Ayar Labs導入CPO技術，立碁(8111)亦加入國家隊，吸引部分資金轉進。</p>
            </div>
        </div>
    </section>

    <!-- 第6章:匯率市場 -->
    <section id="sec-6" class="section-card">
        <h2 style="color: #0891b2;"><span style="margin-right: 0.75rem;">💱</span>第6章｜匯率市場</h2>

        <div class="tldr-block" style="background: #ecfeff;">
            <ul>
                <li style="color: #0891b2;"><strong>美元指數反彈：</strong>Fed副主席暗示12月降息機率降低，鷹派言論推動美元指數(DXY)反彈上漲0.26%，收復99.5關卡。</li>
                <li style="color: #0891b2;"><strong>台幣貶至半年新低：</strong>(11/17) 儘管外資轉買台股，但台幣午後升幅回吐，終場貶值2.4分收31.18元，創逾半年收盤新低。</li>
                <li style="color: #0891b2;"><strong>中日情勢升溫：</strong>中日外交衝突升溫，日本外務省官員赴中溝通，但中國教育部仍發布赴日留學警示，日圓(USD/JPY)承壓。</li>
            </ul>
        </div>

        <h3 class="table-title">主要貨幣兌美元匯率</h3>
        <div class="overflow-x-auto">
            <table class="table-styled">
                <caption>主要貨幣兌美元匯率變動概覽</caption>
                <thead>
                    <tr>
                        <th>指標名稱</th>
                        <th>最新匯率</th>
                        <th>日漲跌</th>
                        <th>五日漲跌</th>
                        <th>月漲跌</th>
                        <th>季漲跌</th>
                        <th>年初至今</th>
                    </tr>
                </thead>
                 <!-- --- v3.1.2 修正: 補齊表格行佔位符 --- -->
                <tbody>
                    <tr>
                        <td>美元指數</td>
                        <td><strong>99.52</strong></td>
                        <td class="text-up"><strong>+0.26%</strong></td>
                        <td class="text-down"><strong>-0.08%</strong></td>
                        <td class="text-up"><strong>+1.15%</strong></td>
                        <td class="text-up"><strong>+1.71%</strong></td>
                        <td class="text-down"><strong>-8.26%</strong></td>
                    </tr>
                    <tr>
                        <td>美元兌台幣</td>
                        <td><strong>31.1720</strong></td>
                        <td class="text-up"><strong>+0.15%</strong></td>
                        <td class="text-up"><strong>+0.62%</strong></td>
                        <td class="text-up"><strong>+1.84%</strong></td>
                        <td class="text-up"><strong>+3.63%</strong></td>
                        <td class="text-down"><strong>-4.85%</strong></td>
                    </tr>
                    <tr>
                        <td>歐元兌美元</td>
                        <td><strong>1.1594</strong></td>
                        <td class="text-down"><strong>-0.32%</strong></td>
                        <td class="text-up"><strong>+0.39%</strong></td>
                        <td class="text-down"><strong>-0.45%</strong></td>
                        <td class="text-down"><strong>-0.49%</strong></td>
                        <td class="text-up"><strong>+11.42%</strong></td>
                    </tr>
                    <tr>
                        <td>美元兌日圓</td>
                        <td><strong>155.2130</strong></td>
                        <td class="text-up"><strong>+0.38%</strong></td>
                        <td class="text-up"><strong>+1.48%</strong></td>
                        <td class="text-up"><strong>+2.81%</strong></td>
                        <td class="text-up"><strong>+5.09%</strong></td>
                        <td class="text-down"><strong>-1.14%</strong></td>
                    </tr>
                </tbody>
            </table>
        </div>
        <p class="text-xs text-right" style="color: #64748b; margin-top: 0.5rem;">資料來源: Yahoo Finance</p>

        <!-- --- v3.1.9 替換: 深度分析區塊使用 v2.8 格式 --- -->
        <div class="analysis-block">
            <h4>深度分析:</h4>
            <div class="structured-analysis">
                <p><strong>Fed降息預期降溫，美元指數反彈站上99.5</strong><br>美元指數(DXY)週一(11/17)反彈上漲<strong>+0.26%</strong>，收於<strong>99.52</strong>。主要驅動因子來自Fed官員的鷹派言論，Fed副主席暗示政策已近中性，12月降息的必要性降低，市場隨即修正利率預期。在下週關鍵非農數據公布前，美元獲得支撐。相較之下，歐元兌美元則下跌<strong>-0.32%</strong>，反映歐美央行政策預期的分歧。</p>
                <p><strong>外資回補台股，台幣(11/17)卻逆勢貶至半年新低</strong><br>新台幣(USD/TWD)週一(11/17)走勢疲軟，終場貶值<strong>2.4分</strong>收在<strong>31.18元</strong>，創下逾半年收盤新低。盤中走勢較為震盪，儘管外資終止連賣轉為買超台股，但匯市似乎未受激勵，午後升幅全數回吐。中信金總經理預估年底匯率將在<strong>30元</strong>附近震盪，但台美匯率聯合聲明後的市場波動值得持續關注。</p>
            </div>
        </div>
    </section>

    <!-- --- v3.1.9 替換: 整個第7章區塊使用 v2.8 格式 --- -->
    <!-- --- v3.1.10 修正: 將 [買進] 改為 [看多], [賣出] 改為 [看空], class buy -> bullish, sell -> bearish --- -->
    <section id="sec-7" class="section-card">
        <h2 style="color: #7c3aed;">
            <span style="margin-right: 0.75rem;">🏭</span>第7章｜產業多空展望
        </h2>

        <!-- TL;DR -->
        <div class="tldr-block" style="background: #faf5ff;">
            <ul>
                <li style="color: #7c3aed;"><strong>[看多]</strong> 記憶體 (MU.US): 三星傳DRAM報價大漲60%，中芯示警缺貨，顯示產業供不應求，漲價週期確立。</li>
                <li style="color: #7c3aed;"><strong>[看多]</strong> AI軟體服務 (GOOGL.US): 波克夏(巴菲特)13F報告揭露建倉Alphabet，顯示「聰明錢」看好其AI軟體服務價值。</li>
                <li style="color: #7c3aed;"><strong>[看空]</strong> PC品牌 (DELL.US): 大摩警告記憶體價格飆升將壓縮PC廠毛利率，下調戴爾(Dell)、惠普(HPQ)評級。</li>
                <li style="color: #7c3aed;"><strong>[看空]</strong> AI新創 (CoreWeave): AI雲端新創CoreWeave上週股價暴跌26%，顯示市場對AI題材不再照單全收，高估值面臨修正。</li>
            </ul>
        </div>

        <!-- 看多推薦第一檔 -->
        <div class="stock-recommendation bullish">
            <h3 class="recommendation-title bullish">[看多]:記憶體 (以美光 (MU.US)為例)</h3>

            <div class="overflow-x-auto">
                <table class="analysis-table">
                    <thead>
                        <tr>
                            <th>分析維度</th>
                            <th>觀點與數據</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="font-semibold text-slate-600">價格訊號</td>
                            <td>三星傳將部分DRAM晶片價格大幅上調60%，中芯國際亦罕見示警記憶體「大缺貨」，漲價週期確立。</td>
                        </tr>
                        <tr>
                            <td class="font-semibold text-slate-600">需求排擠</td>
                            <td>AI伺服器對HBM的需求強勁，排擠了DDR5與NAND產能，導致標準型記憶體供給緊縮。</td>
                        </tr>
                        <tr>
                            <td class="font-semibold text-slate-600">庫存見底</td>
                            <td>手機廠商庫存傳不足三周，客戶恐慌性追單，三星、SK海力士庫存均已見底。</td>
                        </tr>
                        <tr>
                            <td class="font-semibold text-slate-600">
                                <div class="link-button-container">
                                    <a href="https://tw.tradingview.com/symbols/NASDAQ-MU/financials-overview/" target="_blank" class="link-button fundamental">
                                        基本面
                                        <span class="link-button-subtitle">按此看財務數據</span>
                                    </a>
                                    <a href="https://tw.tradingview.com/symbols/NASDAQ-MU/technicals/" target="_blank" class="link-button technical">
                                        技術面
                                        <span class="link-button-subtitle">按此看技術圖表</span>
                                    </a>
                                </div>
                            </td>
                            <td>
                                三星大漲價60%與中芯缺貨警告，證實記憶體已進入超級週期。AI對HBM的需求排擠效應顯現，美光(MU)作為HBM與DDR5的關鍵供應商，將是漲價週期的主要受惠者，營收與毛利率有望大幅改善。<br><br>
                                股價(11/17)隨半導體族群回檔-1.85%，但仍站穩於月線之上。在產業景氣確立翻揚下，技術面回檔可視為布局機會，觀察前高壓力區是否能帶量突破。
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <p class="text-xs text-right" style="color: #64748b; margin-top: 0.5rem;">資料來源: TradingView</p>

            <div class="analysis-block">
                <h4>深度分析:</h4>
                <div class="structured-analysis">
                    <p><strong>漲價週期確立，AI排擠效應助攻，美光營運迎來拐點</strong><br>記憶體產業的基本面已發生根本性轉變。三星罕見的大幅漲價60%，加上中芯的缺貨警告，顯示供給緊縮遠超預期。AI對HBM的強勁需求是主要催化劑，正排擠標準型DRAM/NAND的產能。美光(MU.US)作為技術領先者，將直接受惠於HBM與DDR5的量價齊揚，預期2026年獲利將迎來顯著增長。</p>
                </div>
            </div>
        </div>

        <!-- 看多推薦第二檔 -->
        <div class="stock-recommendation bullish">
            <h3 class="recommendation-title bullish">[看多]:AI軟體服務 (以Alphabet (GOOGL.US)為例)</h3>

            <div class="overflow-x-auto">
                <table class="analysis-table">
                    <thead>
                        <tr>
                            <th>分析維度</th>
                            <th>觀點與數據</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="font-semibold text-slate-600">13F報告</td>
                            <td>波克夏(巴菲特)Q3的13F報告揭露，已斥資49億美元建倉Alphabet (GOOGL)，顯示「聰明錢」的認可。</td>
                        </tr>
                        <tr>
                            <td class="font-semibold text-slate-600">AI生態系</td>
                            <td>谷歌即將推出Gemini 3.0，挑戰ChatGPT。同時阿里巴巴「千問」APP公測，亦採用谷歌的AI生態技術。</td>
                        </tr>
                        <tr>
                            <td class="font-semibold text-slate-600">估值優勢</td>
                            <td>相較於輝達等硬體廠，Alphabet的AI軟體服務被認為更具長期護城河，且目前估值相對合理。</td>
                        </tr>
                         <tr>
                            <td class="font-semibold text-slate-600">
                                <div class="link-button-container">
                                    <a href="https://tw.tradingview.com/symbols/NASDAQ-GOOGL/financials-overview/" target="_blank" class="link-button fundamental">
                                        基本面
                                        <span class="link-button-subtitle">按此看財務數據</span>
                                    </a>
                                    <a href="https://tw.tradingview.com/symbols/NASDAQ-GOOGL/technicals/" target="_blank" class="link-button technical">
                                        技術面
                                        <span class="link-button-subtitle">按此看技術圖表</span>
                                    </a>
                                </div>
                            </td>
                            <td>
                                波克夏建倉是對Alphabet在AI領域長期價值的強力背書。市場焦點逐漸從AI硬體的高估值，轉向AI軟體服務的實際變現能力。谷歌擁有強大的生態系、即將推出的Gemini 3.0，以及相對合理的估值，使其在AI競賽中具備防禦性與成長性。<br><br>
                                股價(11/17)下跌-0.65%，表現優於那斯達克指數。股價在巴菲特加持消息後跳空上漲，目前於高檔整理，技術型態相對強勢。
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <p class="text-xs text-right" style="color: #64748b; margin-top: 0.5rem;">資料來源: TradingView</p>

            <div class="analysis-block">
                <h4>深度分析:</h4>
                <div class="structured-analysis">
                    <p><strong>巴菲特建倉背書，Alphabet AI軟體價值浮現</strong><br>在市場擔憂AI硬體泡沫之際，波克夏建倉Alphabet (GOOGL.US) 是一個重要訊號，代表價值投資者開始認可AI軟體服務的長期護城河。相較於輝達面臨的估值與籌碼壓力，谷歌憑藉其Gemini模型、雲端服務及龐大生態系，被視為更穩健的AI投資標的，估值具備上修空間。</p>
                </div>
            </div>
        </div>

        <!-- 看空推薦第一檔 -->
        <div class="stock-recommendation bearish">
            <h3 class="recommendation-title bearish">[看空]:PC品牌 (以戴爾 (DELL.US)為例)</h3>

            <div class="overflow-x-auto">
                <table class="analysis-table">
                    <thead>
                        <tr>
                            <th>分析維度</th>
                            <th>觀點與數據</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="font-semibold text-slate-600">成本壓力</td>
                            <td>摩根士丹利(大摩)發布報告警告，記憶體(DRAM/NAND)價格飆升，將嚴重壓縮PC品牌廠的毛利率。</td>
                        </tr>
                        <tr>
                            <td class="font-semibold text-slate-600">評級下調</td>
                            <td>大摩因此下調戴爾(DELL)、惠普(HPQ)及慧與(HPE)等多家OEM/ODM廠的評級與目標價。</td>
                        </tr>
                        <tr>
                            <td class="font-semibold text-slate-600">需求疲軟</td>
                            <td>TrendForce亦下修消費性電子產業預估，認為記憶體漲價將抑制終端需求，PC/手機明年出貨恐衰退。</td>
                        </tr>
                         <tr>
                            <td class="font-semibold text-slate-600">
                                <div class="link-button-container">
                                    <a href="https://tw.tradingview.com/symbols/NYSE-DELL/financials-overview/" target="_blank" class="link-button fundamental">
                                        基本面
                                        <span class="link-button-subtitle">按此看財務數據</span>
                                    </a>
                                    <a href="https://tw.tradingview.com/symbols/NYSE-DELL/technicals/" target="_blank" class="link-button technical">
                                        技術面
                                        <span class="link-button-subtitle">按此看技術圖表</span>
                                    </a>
                                </div>
                            </td>
                            <td>
                                戴爾(DELL)雖受惠於AI伺服器需求，但其核心的PC業務正面臨嚴峻的成本壓力。記憶體價格飆漲，PC廠無法完全轉嫁成本，毛利率恐遭壓縮。大摩的降評報告反映了市場對此一結構性問題的擔憂，獲利前景面臨下修風險。<br><br>
                                股價(11/17)受降評衝擊及大盤拖累，重挫-4.10%，跌破月線支撐，技術面轉弱，空頭型態顯現。
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <p class="text-xs text-right" style="color: #64748b; margin-top: 0.5rem;">資料來源: TradingView</p>

            <div class="analysis-block">
                 <h4>深度分析:</h4>
                <div class="structured-analysis">
                    <p><strong>記憶體漲價反噬，大摩降評戴爾(DELL)，PC鏈毛利承壓</strong><br>記憶體漲價對產業鏈的影響並非全然正面。大摩報告點出，PC品牌廠如戴爾(DELL.US)將成為直接受害者。由於PC市場需求疲軟，漲價成本難以轉嫁給消費者，將導致毛利率被嚴重壓縮。TrendForce亦下修出貨預估，顯示上游漲價正反噬終端需求，戴爾的獲利能力面臨下修風險。</p>
                </div>
            </div>
        </div>

        <!-- 看空推薦第二檔 -->
        <div class="stock-recommendation bearish">
            <h3 class="recommendation-title bearish">[看空]:加密貨幣 (以比特幣 (BTC/USD)為例)</h3>

            <div class="overflow-x-auto">
                <table class="analysis-table">
                    <thead>
                        <tr>
                            <th>分析維度</th>
                            <th>觀點與數據</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="font-semibold text-slate-600">價格下跌</td>
                            <td>比特幣價格(11/17)跌破94,000美元，今年以來漲幅全數吐回，反映川普親加密幣政策的熱情消退。</td>
                        </tr>
                        <tr>
                            <td class="font-semibold text-slate-600">賣壓湧現</td>
                            <td>幣圈賣壓席捲，比特幣市值一個月內蒸發6000億美元。摩根大通雖喊觸底，但市場情緒極度恐慌。</td>
                        </tr>
                        <tr>
                            <td class="font-semibold text-slate-600">引擎熄火</td>
                            <td>華爾街三大引擎(ETF、薩爾瓦多、川普政策)突然熄火，市場缺乏新的利多催化劑，導致信心崩塌。</td>
                        </tr>
                         <tr>
                            <td class="font-semibold text-slate-600">
                                <div class="link-button-container">
                                    <a href="https://tw.tradingview.com/symbols/BTCUSD/financials-overview/" target="_blank" class="link-button fundamental">
                                        基本面
                                        <span class="link-button-subtitle">按此看財務數據</span>
                                    </a>
                                    <a href="https://tw.tradingview.com/symbols/BTCUSD/technicals/" target="_blank" class="link-button technical">
                                        技術面
                                        <span class="link-button-subtitle">按此看技術圖表</span>
                                    </a>
                                </div>
                            </td>
                            <td>
                                比特幣(BTC/USD)的牛市基礎正快速瓦解。先前推動上漲的三大引擎(ETF資金流入、薩爾瓦多國家採用、川普的政策預期)已全數熄火。市場情緒轉為極度恐慌，缺乏新的資金動能承接，導致價格持續探底，年初至今漲幅已全數回吐。<br><br>
                                價格(11/17)跌破9.4萬美元關鍵支撐，呈現破底走勢，所有均線下彎，空頭排列成形。在未出現明確底部訊號前，趨勢偏空。
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <p class="text-xs text-right" style="color: #64748b; margin-top: 0.5rem;">資料來源: TradingView</p>

            <div class="analysis-block">
                <h4>深度分析:</h4>
                <div class="structured-analysis">
                    <p><strong>三大引擎熄火，比特幣(BTC)年初漲幅全數回吐</strong><br>比特幣(BTC/USD)正經歷一場信心危機。在一個月內市值蒸發6000億美元後，價格已回吐2025年所有漲幅。市場分析指出，先前推動牛市的ETF資金、國家採用、政策紅利三大引擎已熄火。在Fed降息預期降溫、美元走強的宏觀環境下，加密貨幣等風險性資產面臨的賣壓加劇，短期趨勢不容樂觀。</p>
                </div>
            </div>
        </div>
    </section>


    <!-- 頁尾 -->
    <footer class="text-center" style="margin-top: 3rem; padding-top: 2rem; border-top: 1px solid #e2e8f0;">
        <p class="text-xs" style="color: #64748b;">© 2025 金融市場研究團隊 — 洞察•解構•透視全球資產</p>
        <p class="text-xs" style="color: #64748b; margin-top: 0.5rem;">本報告僅為資訊分享,不構成任何投資建議,投資人應秉持獨立判斷,審慎評估並自負投資風險。</p>
    </footer>

</div>

<!-- 回頂按鈕 -->
<button class="back-to-top" onclick="window.scrollTo({top: 0, behavior: 'smooth'})" title="回到頂部" style="display: none;">↑</button>

<script>
// 進度條功能
function updateProgressBar() {
    const winScroll = document.body.scrollTop || document.documentElement.scrollTop;
    const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
    const scrolled = (winScroll / height) * 100;
    const progressBar = document.getElementById("progressBar");
    if (progressBar) { // Check if progressBar exists
        progressBar.style.width = scrolled + "%";
        // Show progress bar only when scrolling starts
        progressBar.style.opacity = scrolled > 0 ? "1" : "0";
    }
}
window.onscroll = function() { updateProgressBar(); };


// --- 穩健性: 確保 DOM 載入後才綁定事件 ---
window.addEventListener('load', function() {

    // 智能下載功能
    const smartDownloadBtn = document.getElementById('smartDownloadBtn');
    if (smartDownloadBtn) {
        smartDownloadBtn.addEventListener('click', function() {
            const element = document.createElement('a');
            // --- v3.1.8 Use placeholder for date string ---
            const dateStr = '20251118'; // Use placeholder
            // CRITICAL: Download filename MUST be in 'yyyymmdd.html' format.
            const filename = dateStr + '.html'; // 強制要求 yyyymmdd.html 格式

            // Temporarily hide elements that shouldn't be in the downloaded file
            const progressBar = document.getElementById('progressBar');
            const backToTopButton = document.querySelector('.back-to-top');
            const originalProgressBarStyle = progressBar ? progressBar.style.display : '';
            const originalBackToTopStyle = backToTopButton ? backToTopButton.style.display : '';

            if (progressBar) progressBar.style.display = 'none';
            if (backToTopButton) backToTopButton.style.display = 'none';

            // Get the HTML content AFTER hiding elements
            const content = document.documentElement.outerHTML;

            // Restore elements
            if (progressBar) progressBar.style.display = originalProgressBarStyle;
            if (backToTopButton) backToTopButton.style.display = originalBackToTopStyle;


            const file = new Blob([content], {type: 'text/html;charset=utf-8'});
            element.href = URL.createObjectURL(file);
            element.download = filename; // Use dynamic filename
            document.body.appendChild(element);
            element.click();
            document.body.removeChild(element);
            URL.revokeObjectURL(element.href);
        });
    } // end if(smartDownloadBtn)

    // 平滑滾動導航
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute('href'));
            if (target) {
                const offset = 120; // Adjusted offset for sticky nav
                const bodyRect = document.body.getBoundingClientRect().top;
                const elementRect = target.getBoundingClientRect().top;
                const elementPosition = elementRect - bodyRect;
                const offsetPosition = elementPosition - offset;
                window.scrollTo({ top: offsetPosition, behavior: 'smooth' });
            }
        });
    });

    // 載入完成後隱藏進度條 (fade out effect)
    const progressBar = document.getElementById("progressBar");
     if (progressBar) { // Check if progressBar exists
        progressBar.style.transition = 'opacity 0.5s ease-out'; // Add fade out transition
        setTimeout(function() {
            progressBar.style.opacity = "0";
        }, 500); // Start fade out after 500ms
     }
}); // end window.load
</script>


</body></html>