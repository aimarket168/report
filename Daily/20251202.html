<html lang="zh-TW"><head><script>(function(firebaseConfig, initialAuthToken, appId) {
        window.__firebase_config = firebaseConfig;
        window.__initial_auth_token = initialAuthToken;
        window.__app_id = appId;
            })("\n{\n  \"apiKey\": \"AIzaSyCqyCcs2R2e7AegGjvFAwG98wlamtbHvZY\",\n  \"authDomain\": \"bard-frontend.firebaseapp.com\",\n  \"projectId\": \"bard-frontend\",\n  \"storageBucket\": \"bard-frontend.firebasestorage.app\",\n  \"messagingSenderId\": \"175205271074\",\n  \"appId\": \"1:175205271074:web:2b7bd4d34d33bf38e6ec7b\"\n}\n","eyJhbGciOiJSUzI1NiIsImtpZCI6IjExYjc0YTUyNzgwMDk5ZjEzNDY0MmNlZWM3ZGE4MjNkMTc4MDc2ZjIiLCJ0eXAiOiJKV1QifQ.eyJzdWIiOiJmaXJlYmFzZS1hZG1pbnNkay1mYnN2Y0BiYXJkLWZyb250ZW5kLmlhbS5nc2VydmljZWFjY291bnQuY29tIiwiYXVkIjoiaHR0cHM6Ly9pZGVudGl0eXRvb2xraXQuZ29vZ2xlYXBpcy5jb20vZ29vZ2xlLmlkZW50aXR5LmlkZW50aXR5dG9vbGtpdC52MS5JZGVudGl0eVRvb2xraXQiLCJ1aWQiOiIwMTYyNzg3NDM4ODM1OTc2Mjk5OCIsImlzcyI6ImZpcmViYXNlLWFkbWluc2RrLWZic3ZjQGJhcmQtZnJvbnRlbmQuaWFtLmdzZXJ2aWNlYWNjb3VudC5jb20iLCJjbGFpbXMiOnsiYXBwSWQiOiJjXzE0MDNkNGYzNTViMTk1NzlfMjAyNTEyMDIuaHRtbC04NTkifSwiZXhwIjoxNzY0NjMyNjMzLCJpYXQiOjE3NjQ2MjkwMzMsImFsZyI6IlJTMjU2In0.h7MJWwarTeob3itpxcBuuVkmwCqWyb1_TjM1WvJ2gvPMuBj_W2Atpy8Mx_003LwWtUrrtjY3mbSrR0c2CTj2mkTdnTkwZXF19Ba51sPhFfW2Dohyxjmap3abM2qiJf6dcc8InX282bQd1aGz2ny5WJ3zche2EKHf7txRdpRe1HRZY7qNFyRnzSIqHlUG-58NFC4b0MFwldy0WEXQwyJm86m0iizFPs96EfLz4B9cufixtu295i-ca1e2-idsfXJNyxTbznLC1jaZlCAVzkV_A5zyCEy5L18ocqnEExacrIqhVT_qOrMz7GMvgTedHOTWNTOPn8hkA9W_iKkHqmSFUA","c_1403d4f355b19579_20251202.html-859")</script><script>'use strict';var h=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,b,d){if(a==Array.prototype||a==Object.prototype)return a;a[b]=d.value;return a};function l(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var d=a[b];if(d&&d.Math==Math)return d}throw Error("Cannot find global object");}var n=l(this);
function p(a,b){if(b)a:{var d=n;a=a.split(".");for(var c=0;c<a.length-1;c++){var e=a[c];if(!(e in d))break a;d=d[e]}a=a[a.length-1];c=d[a];b=b(c);b!=c&&b!=null&&h(d,a,{configurable:!0,writable:!0,value:b})}}function r(a){function b(c){return a.next(c)}function d(c){return a.throw(c)}return new Promise(function(c,e){function f(g){g.done?c(g.value):Promise.resolve(g.value).then(b,d).then(f,e)}f(a.next())})}function t(a){return r(a())}
p("Object.values",function(a){return a?a:function(b){var d=[],c;for(c in b)Object.prototype.hasOwnProperty.call(b,c)&&d.push(b[c]);return d}});p("Array.prototype.includes",function(a){return a?a:function(b,d){var c=this;c instanceof String&&(c=String(c));var e=c.length;d=d||0;for(d<0&&(d=Math.max(d+e,0));d<e;d++){var f=c[d];if(f===b||Object.is(f,b))return!0}return!1}});/*

 MIT License

 Copyright (c) 2017-2023 W.Y.

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in
 all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 SOFTWARE.

*/
function u(a,b){const d=a.style;b.backgroundColor&&(d.backgroundColor=b.backgroundColor);b.width&&(d.width=`${b.width}px`);b.height&&(d.height=`${b.height}px`);const c=b.style;c!=null&&Object.keys(c).forEach(e=>{d[e]=c[e]})};var v=(()=>{let a=0;return()=>{a+=1;return`u${`0000${(Math.random()*1679616<<0).toString(36)}`.slice(-4)}${a}`}})();function w(a){const b=[];for(let d=0,c=a.length;d<c;d++)b.push(a[d]);return b}let x=null;function y(a={}){return x?x:a.l?x=a.l:x=w(window.getComputedStyle(document.documentElement))}function z(a,b){return(a=(a.ownerDocument.defaultView||window).getComputedStyle(a).getPropertyValue(b))?parseFloat(a.replace("px","")):0}
function A(a,b={}){var d;if(!(d=b.width)){d=z(a,"border-left-width");var c=z(a,"border-right-width");d=a.clientWidth+d+c}(b=b.height)||(b=z(a,"border-top-width"),c=z(a,"border-bottom-width"),b=a.clientHeight+b+c);return{width:d,height:b}}function B(a){return new Promise((b,d)=>{const c=new Image;c.onload=()=>{c.decode().then(()=>{requestAnimationFrame(()=>b(c))})};c.onerror=d;c.crossOrigin="anonymous";c.decoding="async";c.src=a})}
function C(a){return t(function*(){return Promise.resolve().then(()=>(new XMLSerializer).serializeToString(a)).then(encodeURIComponent).then(b=>`data:image/svg+xml;charset=utf-8,${b}`)})}
function D(a,b,d){return t(function*(){const c=document.createElementNS("http://www.w3.org/2000/svg","svg"),e=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");c.setAttribute("width",`${b}`);c.setAttribute("height",`${d}`);c.setAttribute("viewBox",`0 0 ${b} ${d}`);e.setAttribute("width","100%");e.setAttribute("height","100%");e.setAttribute("x","0");e.setAttribute("y","0");e.setAttribute("externalResourcesRequired","true");c.appendChild(e);e.appendChild(a);return C(c)})}
var E=(a,b)=>{if(a instanceof b)return!0;a=Object.getPrototypeOf(a);return a===null?!1:a.constructor.name===b.name||E(a,b)};function F(a,b){return y(b).map(d=>{const c=a.getPropertyValue(d),e=a.getPropertyPriority(d);return`${d}: ${c}${e?" !important":""};`}).join(" ")}
function G(a,b,d,c){a=window.getComputedStyle(a,d);var e=a.getPropertyValue("content");if(e!==""&&e!=="none"){var f=v();try{b.className=`${b.className} ${f}`}catch(k){return}e=document.createElement("style");var g=e.appendChild;d=`.${f}:${d}`;a.cssText?(c=a.getPropertyValue("content"),c=`${a.cssText} content: '${c.replace(/'|"/g,"")}';`):c=F(a,c);g.call(e,document.createTextNode(`${d}{${c}}`));b.appendChild(e)}};function H(a){return a.search(/^(data:)/)!==-1}function I(a,b,d){return t(function*(){const c=yield fetch(a,b);if(c.status===404)throw Error(`Resource "${c.url}" not found`);const e=yield c.blob();return new Promise((f,g)=>{const k=new FileReader;k.onerror=g;k.onloadend=()=>{try{f(d({o:c,result:k.result}))}catch(m){g(m)}};k.readAsDataURL(e)})})}const J={};function K(a,b,d){let c=a.replace(/\?.*/,"");d&&(c=a);/ttf|otf|eot|woff2?/i.test(c)&&(c=c.replace(/.*\//,""));return b?`[${b}]${c}`:c}
function L(a,b,d){return t(function*(){const c=K(a,b,d.C);if(J[c]!=null)return J[c];d.u&&(a+=(/\?/.test(a)?"&":"?")+(new Date).getTime());let e;try{const f=yield I(a,d.i,({o:g,result:k})=>{b||(b=g.headers.get("Content-Type")||"");return k.split(/,/)[1]});e=`data:${b};base64,${f}`}catch(f){e=d.B||""}return J[c]=e})};const M={P:"application/font-woff",R:"application/font-woff",N:"application/font-truetype",v:"application/vnd.ms-fontobject",H:"image/png",F:"image/jpeg",D:"image/jpeg",A:"image/gif",M:"image/tiff",L:"image/svg+xml",O:"image/webp"};function N(a){return(a=/\.([^./]*?)$/g.exec(a))?a[1]:""};function O(a){return t(function*(){const b=a.toDataURL();return b==="data:,"?a.cloneNode(!1):B(b)})}function aa(a,b){return t(function*(){if(a.currentSrc){var d=document.createElement("canvas");const c=d.getContext("2d");d.width=a.clientWidth;d.height=a.clientHeight;c==null||c.drawImage(a,0,0,d.width,d.height);d=d.toDataURL();return B(d)}d=a.poster;d=yield L(d,M[N(d).toLowerCase()]||"",b);return B(d)})}
function ba(a,b){return t(function*(){try{let d;if(a==null?0:(d=a.contentDocument)==null?0:d.body)return yield P(a.contentDocument.body,b,!0)}catch(d){}return a.cloneNode(!1)})}function ca(a,b){return t(function*(){return E(a,HTMLCanvasElement)?O(a):E(a,HTMLVideoElement)?aa(a,b):E(a,HTMLIFrameElement)?ba(a,b):a.cloneNode(a.tagName!=null&&a.tagName.toUpperCase()==="SVG")})}
function da(a,b,d){return t(function*(){if(b.tagName!=null&&b.tagName.toUpperCase()==="SVG")return b;let c=[];if(a.tagName!=null&&a.tagName.toUpperCase()==="SLOT"&&a.assignedNodes)c=w(a.assignedNodes());else{let e;if(E(a,HTMLIFrameElement)&&((e=a.contentDocument)==null?0:e.body))c=w(a.contentDocument.body.childNodes);else{let f;c=w(((f=a.shadowRoot)!=null?f:a).childNodes)}}if(c.length===0||E(a,HTMLVideoElement))return b;yield c.reduce((e,f)=>e.then(()=>P(f,d)).then(g=>{g&&b.appendChild(g)}),Promise.resolve());
return b})}function ea(a,b,d){const c=b.style;if(c){var e=window.getComputedStyle(a);e.cssText?(c.cssText=e.cssText,c.transformOrigin=e.transformOrigin):y(d).forEach(f=>{let g=e.getPropertyValue(f);f==="font-size"&&g.endsWith("px")&&(g=`${Math.floor(parseFloat(g.substring(0,g.length-2)))-.1}px`);E(a,HTMLIFrameElement)&&f==="display"&&g==="inline"&&(g="block");f==="d"&&b.getAttribute("d")&&(g=`path(${b.getAttribute("d")})`);c.setProperty(f,g,e.getPropertyPriority(f))})}}
function fa(a,b){E(a,HTMLSelectElement)&&(b=Array.from(b.children).find(d=>a.value===d.getAttribute("value")))&&b.setAttribute("selected","")}
function ha(a,b){return t(function*(){var d=a.querySelectorAll?a.querySelectorAll("use"):[];if(d.length===0)return a;var c={};for(var e=0;e<d.length;e++){var f=d[e].getAttribute("xlink:href");if(f){const g=document.querySelector(f);a.querySelector(f)||!g||c[f]||(c[f]=yield P(g,b,!0))}}d=Object.values(c);if(d.length){c=document.createElementNS("http://www.w3.org/1999/xhtml","svg");c.setAttribute("xmlns","http://www.w3.org/1999/xhtml");c.style.position="absolute";c.style.width="0";c.style.height="0";
c.style.overflow="hidden";c.style.display="none";e=document.createElementNS("http://www.w3.org/1999/xhtml","defs");c.appendChild(e);for(f=0;f<d.length;f++)e.appendChild(d[f]);a.appendChild(c)}return a})}
function P(a,b,d){return t(function*(){return d||!b.filter||b.filter(a)?Promise.resolve(a).then(c=>ca(c,b)).then(c=>da(a,c,b)).then(c=>{E(c,Element)&&(ea(a,c,b),G(a,c,":before",b),G(a,c,":after",b),E(a,HTMLTextAreaElement)&&(c.textContent=a.value),E(a,HTMLInputElement)&&c.setAttribute("value",a.value),fa(a,c));return c}).then(c=>ha(c,b)):null})};const Q=/url\((['"]?)([^'"]+?)\1\)/g,ia=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,ja=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function ka(a){const b=[];a.replace(Q,(d,c,e)=>{b.push(e);return d});return b.filter(d=>!H(d))}
function la(a,b,d,c){return t(function*(){try{const e=d?(new URL(b,d||void 0)).toString():b;let f;f=yield L(e,M[N(b).toLowerCase()]||"",c);return a.replace(new RegExp(`(url\\(['"]?)(${b.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")})(['"]?\\))`,"g"),`$1${f}$3`)}catch(e){}return a})}function ma(a,{I:b}){return b?a.replace(ja,d=>{for(;;){const [c,,e]=ia.exec(d)||[],f=c,g=e;if(!g)return"";if(g===b)return`src: ${f};`}}):a}
function R(a,b,d){return t(function*(){if(a.search(Q)===-1)return a;const c=ma(a,d);return ka(c).reduce((e,f)=>e.then(g=>la(g,f,b,d)),Promise.resolve(c))})};function S(a,b,d){return t(function*(){var c;const e=(c=b.style)==null?void 0:c.getPropertyValue(a);return e?(c=yield R(e,null,d),b.style.setProperty(a,c,b.style.getPropertyPriority(a)),!0):!1})}function na(a,b){return t(function*(){(yield S("background",a,b))||(yield S("background-image",a,b));(yield S("mask",a,b))||(yield S("-webkit-mask",a,b))||(yield S("mask-image",a,b))||(yield S("-webkit-mask-image",a,b))})}
function oa(a,b){return t(function*(){const d=E(a,HTMLImageElement);if(d&&!H(a.src)||E(a,SVGImageElement)&&!H(a.href.baseVal)){var c=d?a.src:a.href.baseVal,e=yield L(c,M[N(c).toLowerCase()]||"",b);yield new Promise((f,g)=>{a.onload=f;a.onerror=b.m?(...k)=>{try{f(b.m(...k))}catch(m){g(m)}}:g;a.decode&&(a.decode=f);a.loading==="lazy"&&(a.loading="eager");d?(a.srcset="",a.src=e):a.href.baseVal=e})}})}
function pa(a,b){return t(function*(){const d=w(a.childNodes).map(c=>T(c,b));yield Promise.all(d).then(()=>a)})}function T(a,b){return t(function*(){E(a,Element)&&(yield na(a,b),yield oa(a,b),yield pa(a,b))})};const U={};function V(a){return t(function*(){var b=U[a];if(b!=null)return b;b=yield(yield fetch(a)).text();b={url:a,cssText:b};return U[a]=b})}function W(a,b){return t(function*(){let d=a.cssText;const c=/url\(["']?([^"')]+)["']?\)/g,e=(d.match(/url\([^)]+\)/g)||[]).map(f=>t(function*(){let g=f.replace(c,"$1");g.startsWith("https://")||(g=(new URL(g,a.url)).href);return I(g,b.i,({result:k})=>{d=d.replace(f,`url(${k})`);return[f,k]})}));return Promise.all(e).then(()=>d)})}
function X(a){if(a==null)return[];const b=[];a=a.replace(/(\/\*[\s\S]*?\*\/)/gi,"");for(var d=RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");;){var c=d.exec(a);if(c===null)break;b.push(c[0])}a=a.replace(d,"");d=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi;for(c=RegExp("((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})","gi");;){let e=d.exec(a);if(e===null)if(e=c.exec(a),e===null)break;else d.lastIndex=c.lastIndex;else c.lastIndex=
d.lastIndex;b.push(e[0])}return b}
function qa(a,b){return t(function*(){const d=[],c=[];a.forEach(e=>{if("cssRules"in e)try{w(e.cssRules||[]).forEach((f,g)=>{if(f.type===CSSRule.IMPORT_RULE){let k=g+1;f=V(f.href).then(m=>W(m,b)).then(m=>X(m).forEach(q=>{try{e.insertRule(q,q.startsWith("@import")?k+=1:e.cssRules.length)}catch(Da){}})).catch(()=>{});c.push(f)}})}catch(f){const g=a.find(k=>k.href==null)||document.styleSheets[0];e.href!=null&&c.push(V(e.href).then(k=>W(k,b)).then(k=>X(k).forEach(m=>{g.insertRule(m,g.cssRules.length)})).catch(()=>
{}))}});return Promise.all(c).then(()=>{a.forEach(e=>{if("cssRules"in e)try{w(e.cssRules||[]).forEach(f=>{d.push(f)})}catch(f){}});return d})})}function ra(a){return a.filter(b=>b.type===CSSRule.FONT_FACE_RULE).filter(b=>b.style.getPropertyValue("src").search(Q)!==-1)}function sa(a,b){return t(function*(){if(a.ownerDocument==null)throw Error("Provided element is not within a Document");var d=w(a.ownerDocument.styleSheets);d=yield qa(d,b);return ra(d)})}
function ta(a){function b(c){(c.style.fontFamily||getComputedStyle(c).fontFamily).split(",").forEach(e=>{d.add(e.trim().replace(/["']/g,""))});Array.from(c.children).forEach(e=>{e instanceof HTMLElement&&b(e)})}const d=new Set;b(a);return d}function ua(a,b){return t(function*(){const d=yield sa(a,b),c=ta(a);return(yield Promise.all(d.filter(e=>c.has(e.style.fontFamily.trim().replace(/["']/g,""))).map(e=>R(e.cssText,e.parentStyleSheet?e.parentStyleSheet.href:null,b)))).join("\n")})}
function va(a,b){return t(function*(){const d=b.j!=null?b.j:b.K?null:yield ua(a,b);if(d){const c=document.createElement("style");c.appendChild(document.createTextNode(d));a.firstChild?a.insertBefore(c,a.firstChild):a.appendChild(c)}})};function wa(a,b={}){return t(function*(){const {width:d,height:c}=A(a,b),e=yield P(a,b,!0);yield va(e,b);yield T(e,b);u(e,b);return yield D(e,d,c)})}
function xa(a,b={}){return t(function*(){const {width:d,height:c}=A(a,b);var e=yield wa(a,b);e=yield B(e);const f=document.createElement("canvas"),g=f.getContext("2d"),k=b.G||window.devicePixelRatio||1,m=b.h||d,q=b.g||c;f.width=m*k;f.height=q*k;!b.J&&(f.width>16384||f.height>16384)&&(f.width>16384&&f.height>16384?f.width>f.height?(f.height*=16384/f.width,f.width=16384):(f.width*=16384/f.height,f.height=16384):f.width>16384?(f.height*=16384/f.width,f.width=16384):(f.width*=16384/f.height,f.height=
16384));f.style.width=`${m}`;f.style.height=`${q}`;b.backgroundColor&&(g.fillStyle=b.backgroundColor,g.fillRect(0,0,f.width,f.height));g.drawImage(e,0,0,f.width,f.height);return f})}function ya(a,b={}){return t(function*(){return(yield xa(a,b)).toDataURL()})};const za=["gemini.google.com","corp.google.com","proxy.googlers.com"];function Y(){return document.body.querySelectorAll('[class*="animate"]').length>0}function Z(a){return t(function*(){try{return yield ya(a,{h:a.offsetWidth,g:a.offsetHeight})}catch(d){var b=a.offsetHeight;const c=document.createElement("canvas");c.width=a.offsetWidth;c.height=b;return c.toDataURL("image/png")}})}
function Aa(){return t(function*(){const a=document.body.offsetWidth,b=document.body.offsetHeight,d=document.body.cloneNode(!0);d.querySelectorAll('[class*="animate"]').forEach(c=>{c.classList.remove(...Array.from(c.classList).filter(e=>e.startsWith("animate")))});d.style.width=`${a}px`;d.style.height=`${b}px`;return d})}
function Ba(a){return t(function*(){let b=document.body;if(Y()){var d=yield Aa();b=d;document.body.appendChild(d)}d=yield Z(b);Y()&&document.body.removeChild(b);window.parent.postMessage({type:"SEND_SCREENSHOT",image:d,topOffset:document.documentElement.scrollTop},a.origin)})}function Ca(a){return t(function*(){const b={type:"SEND_SCREENSHOT_FOR_DATA_VISUALIZATION",image:yield Z(document.body),topOffset:0};window.parent.postMessage(b,a.origin)})}
window.addEventListener("message",a=>t(function*(){if(za.some(d=>a.origin.includes(d))){var b=a.data;b&&(b.type==="MAKE_SCREENSHOT"&&(yield Ba(a)),b.type==="MAKE_SCREENSHOT_FOR_DATA_VISUALIZATION"&&(yield Ca(a)))}}));
</script><script>(function() {
  // Ensure this script is executed only once
  if (window.firebaseAuthBridgeScriptLoaded) {
    return;
  }
  window.firebaseAuthBridgeScriptLoaded = true;

  let nextTokenPromiseId = 0;

  // Stores { resolve, reject } for ongoing token requests
  const pendingTokenPromises = {};

  // Listen for messages from the Host Application
  window.addEventListener('message', function(event) {

    const messageData = event.data;

  if (messageData && messageData.type === 'RESOLVE_NEW_FIREBASE_TOKEN') {
      const { success, token, error, promiseId } = messageData ?? {};
      if (pendingTokenPromises[promiseId]) {
        if (success) {
          pendingTokenPromises[promiseId].resolve(token);
        } else {
          pendingTokenPromises[promiseId].reject(new Error(error || 'Token refresh failed from host.'));
        }
        delete pendingTokenPromises[promiseId];
      }
    }
  });

  // Expose a function for the Generated App to request a new Firebase token
  window.requestNewFirebaseToken = function() {
    const currentPromiseId = nextTokenPromiseId++;
    const promise = new Promise((resolve, reject) => {
      pendingTokenPromises[currentPromiseId] = { resolve, reject };
    });
    if (window.parent && window.parent !== window) {
      window.parent.postMessage({
        type: 'REQUEST_NEW_FIREBASE_TOKEN',
        promiseId: currentPromiseId
      }, '*');
    } else {
      pendingTokenPromises[currentPromiseId].reject(new Error('No parent window to request token from.'));
      delete pendingTokenPromises[currentPromiseId];
    }
    return promise;
  };
})();</script><script>
let realOriginalGetUserMedia = null;
if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
  realOriginalGetUserMedia = navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);
}

(function() {
  if (navigator.mediaDevices && navigator.mediaDevices.__proto__) {
    try {
      Object.defineProperty(navigator.mediaDevices.__proto__, 'getUserMedia', {
        get: function() {
          return undefined; // Or throw an error
        },
        configurable: false
      });
    } catch (error) {
      console.error("Error defining prototype getter:", error);
    }
  }
})();

(function() {
  const pendingMediaResolvers = {};
  let nextMediaPromiseId = 0;

  function requestMediaPermissions(constraints) {
    const mediaPromiseId = nextMediaPromiseId++;
    const promise = new Promise((resolve, reject) => {
      pendingMediaResolvers[mediaPromiseId] = (granted) => {
        delete pendingMediaResolvers[mediaPromiseId];
        resolve(granted);
      };
    });

    window.parent.postMessage({
      type: 'requestMediaPermission',
      constraints: constraints,
      promiseId: mediaPromiseId,
    }, '*');

    return promise;
  }

  let originalGetUserMedia = realOriginalGetUserMedia;

  function interceptGetUserMedia() {
    if (navigator.mediaDevices) {
      Object.defineProperty(navigator.mediaDevices, 'getUserMedia', {
        value: function(constraints) {
          return requestMediaPermissions(constraints).then((granted) => {
            if (granted) {
              if (originalGetUserMedia) {
                return originalGetUserMedia(constraints);
              } else {
                throw new Error("Original getUserMedia not available.");
              }
            } else {
              throw new DOMException('Permission denied', 'NotAllowedError');
            }
          });
        },
        writable: false,
        configurable: false
      });
    }
  }

  interceptGetUserMedia();

  const observer = new MutationObserver(function(mutationsList, observer) {
    for (const mutation of mutationsList) {
      if (mutation.type === 'reconfigured' && mutation.name === 'getUserMedia' && mutation.object === navigator.mediaDevices) {
        interceptGetUserMedia();
      } else if (mutation.type === 'attributes' && mutation.attributeName === 'getUserMedia' && mutation.target === navigator.mediaDevices) {
        interceptGetUserMedia();
      } else if (mutation.type === 'childList' && mutation.addedNodes) {
        mutation.addedNodes.forEach(node => {
          if (node === navigator.mediaDevices) {
            interceptGetUserMedia();
          }
        });
      }
    }
  });

  function interceptSpeechRecognition() {
    if (!window.SpeechRecognition && !window.webkitSpeechRecognition) {
      return;
    }

    const OriginalSpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;

    const SpeechRecognitionWrapper = function(...args) {
      const recognizer = new OriginalSpeechRecognition(...args);
      const originalStart = recognizer.start.bind(recognizer);

      recognizer.start = function() {
        requestMediaPermissions({ audio: true }).then(granted => {
          if (granted) {
            originalStart();
          } else {
            const errorEvent = new SpeechRecognitionErrorEvent('error');
            errorEvent.error = 'not-allowed'; // This is the standard error for permission denial.
            recognizer.dispatchEvent(errorEvent);
          }
        });
      };

      return recognizer;
    };

    SpeechRecognitionWrapper.prototype = OriginalSpeechRecognition.prototype;
    SpeechRecognitionWrapper.prototype.constructor = SpeechRecognitionWrapper;

    if (window.SpeechRecognition) {
      window.SpeechRecognition = SpeechRecognitionWrapper;
    }
    if (window.webkitSpeechRecognition) {
      window.webkitSpeechRecognition = SpeechRecognitionWrapper;
    }
  }

  interceptSpeechRecognition();

  window.addEventListener('message', function(event) {
    if (event.data) {
      if (event.data.type === 'resolveMediaPermission') {
        const { promiseId, granted } = event.data;
        if (pendingMediaResolvers[promiseId]) {
          pendingMediaResolvers[promiseId](granted);
        }
      }
    }
  });

})();</script><script>((function(modelInformation) {
  const originalFetch = window.fetch;
  // TODO: b/421908508 - Move these out of the script and match all generative AI model calls.
  let googleLlmBaseApiUrls = [
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.textModelName + ':streamGenerateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.textModelName + ':generateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageModelName + ':predict',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageModelName + ':predictLongRunning',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageEditModelName + ':generateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageTransformModelName + ':generateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.videoModelName + ':predict',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.videoModelName + ':predictLongRunning',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.ttsModelName + ':generateContent',
  ];
  modelInformation.deprecatedTextModelNames.forEach((modelName) => {
    googleLlmBaseApiUrls.push(
      'https://generativelanguage.googleapis.com/v1beta/models/' + modelName + ':streamGenerateContent',
      'https://generativelanguage.googleapis.com/v1beta/models/' + modelName + ':generateContent',
    );
  });
  modelInformation.deprecatedImageModelNames.forEach((modelName) => {
    googleLlmBaseApiUrls.push(
      'https://generativelanguage.googleapis.com/v1beta/models/' + modelName + ':predict',
      'https://generativelanguage.googleapis.com/v1beta/models/' + modelName + ':predictLongRunning',
    );
  });

  const pendingFetchResolvers = {};
  let nextPromiseId = 0;

  function handleStringInput(input, optionsArgument) {
    const actualUrl = input;
    const fetchCallArgs = [actualUrl, optionsArgument];
    const effectiveOptions = optionsArgument || {};
    const bodyForApiKeyCheck = effectiveOptions.body;
    const bodyForPostMessage = effectiveOptions.body;
    return { actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage };
  }

  function handleRequestInput(input, optionsArgument) {
    const actualUrl = input.url;
    const fetchCallArgs = [input, optionsArgument];
    const effectiveOptions = { method: input.method, headers: new Headers(input.headers) };
    let bodyForApiKeyCheck;
    let bodyForPostMessage;

    if (optionsArgument) {
      if (optionsArgument.method) effectiveOptions.method = optionsArgument.method;
      if (optionsArgument.headers) effectiveOptions.headers = new Headers(optionsArgument.headers);
      if ('body' in optionsArgument) {
        bodyForApiKeyCheck = optionsArgument.body;
        bodyForPostMessage = optionsArgument.body;
      } else {
        bodyForApiKeyCheck = undefined;
        bodyForPostMessage = input.body;
      }
    } else {
      bodyForApiKeyCheck = undefined;
      bodyForPostMessage = input.body;
    }
    return { actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage };
  }

  window.fetch = function(input, optionsArgument) {
    let actualUrl;
    let fetchCallArgs;
    let effectiveOptions = {};
    let bodyForApiKeyCheck;
    let bodyForPostMessage;

    if (typeof input === 'string') {
      ({actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage} = handleStringInput(input, optionsArgument));
    } else if (input instanceof Request) {
      ({actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage} = handleRequestInput(input, optionsArgument));
    } else {
      return originalFetch.apply(window, [input, optionsArgument]);
    }

    effectiveOptions.method = effectiveOptions.method || 'GET';
    if (!effectiveOptions.headers) {
      effectiveOptions.headers = new Headers();
    }


    if (typeof actualUrl === 'string' && googleLlmBaseApiUrls.some((url) => actualUrl.startsWith(url))) {
      let apiKeyIsNull = true;

      const regex = new RegExp("models/([^:]+)");
      const modelNameMatch = actualUrl.match(regex);
      const modelName = modelNameMatch ? modelNameMatch[1] : 'unspecified';


      try {
        const urlObject = new URL(actualUrl);  // Use URL object for robust parsing
        const apiKeyParam = urlObject.searchParams.get('key');
        if (apiKeyParam) {
          apiKeyIsNull = false;
        }
      } catch (e) {
        // Continue checks even if URL parsing fails
      }

      if (apiKeyIsNull && effectiveOptions.headers) {
        const h = new Headers(effectiveOptions.headers);
        const apiKeyHeaderValue = h.get('X-API-Key') || h.get('x-api-key');
        if (apiKeyHeaderValue) {
          apiKeyIsNull = false;
          return originalFetch.apply(window, fetchCallArgs);
        }
      }

      if (apiKeyIsNull && effectiveOptions.method && ['POST', 'PUT', 'PATCH'].includes(effectiveOptions.method.toUpperCase()) && typeof bodyForApiKeyCheck === 'string') {
        try {
          const bodyData = JSON.parse(bodyForApiKeyCheck);
          if (bodyData && bodyData.apiKey) {
            apiKeyIsNull = false;
            return originalFetch.apply(window, fetchCallArgs);
          }
        } catch (e) {
          // Ignore JSON parsing errors
        }
      }

      if(apiKeyIsNull) {
        const promiseId = nextPromiseId++;
        const promise = new Promise((resolve) => {
          pendingFetchResolvers[promiseId] = (resolvedResponse) => {
            delete pendingFetchResolvers[promiseId];
            resolve(resolvedResponse);
          };
        });

        let serializedBodyForPostMessage;
        if (typeof bodyForPostMessage === 'string' || bodyForPostMessage == null) {
            serializedBodyForPostMessage = bodyForPostMessage;
        } else if (bodyForPostMessage instanceof ReadableStream) {
            serializedBodyForPostMessage = null;
        } else {
            try {
                serializedBodyForPostMessage = JSON.stringify(bodyForPostMessage);
            } catch (e) {
                serializedBodyForPostMessage = null;
            }
        }

        const messageOptions = {
            method: effectiveOptions.method,
            headers: Object.fromEntries(new Headers(effectiveOptions.headers).entries()),
            body: serializedBodyForPostMessage
        };

        window.parent.postMessage({
          type: 'requestFetch',
          url: actualUrl,
          modelName: modelName,
          options: messageOptions,
          promiseId: promiseId,
        }, '*');

        return promise;
      }
      return originalFetch.apply(window, fetchCallArgs);
    }
    return originalFetch.apply(window, fetchCallArgs);
  };

  window.addEventListener('message', function(event) {
    if (event.data && event.data.type === 'resolveFetch') {
      const { promiseId, response } = event.data;
      if (pendingFetchResolvers[promiseId]) {
        try {
          const reconstructedResponse = new Response(response.body, {
            status: response.status,
            statusText: response.statusText,
            headers: new Headers(response.headers),
          });
          pendingFetchResolvers[promiseId](reconstructedResponse);
        } catch (error) {
          pendingFetchResolvers[promiseId](new Response(null, { status: 500, statusText: "Interceptor Response Reconstruction Error" }));
        }
      }
    }
  });

}))({"textModelName":"gemini-2.5-flash-preview-09-2025","imageModelName":"imagen-4.0-generate-001","imageEditModelName":"gemini-2.5-flash-image-preview","imageTransformModelName":"gemini-2.5-flash-image-preview","videoModelName":"veo-2.0-generate-001","ttsModelName":"gemini-2.5-flash-preview-tts","deprecatedTextModelNames":["gemini-2.0-flash","gemini-2.5-flash-preview-04-17","gemini-2.5-flash-preview-05-20"],"deprecatedImageModelNames":["imagen-3.0-generate-001","imagen-3.0-generate-002"]})</script><script>(function() {
  const originalConsoleLog = console.log;
  const originalConsoleError = console.error;

    /**
   * Normalizes an error event or a promise rejection reason into a structured error object.
   * @param {*} errorEventOrReason The error object or reason.
   * @return {object} Structured error data { message, name, stack }.
   */
  function getErrorObject(errorEventOrReason) {
    if (errorEventOrReason instanceof Error) {
      return {
        message: errorEventOrReason.message,
        name: errorEventOrReason.name,
        stack: errorEventOrReason.stack,
      };
    }
    // Fallback for non-Error objects.
    try {
      return {
        message: JSON.stringify(errorEventOrReason),
        name: 'UnknownErrorType',
        stack: null,
      };
    } catch (e) {
      return {
        message: String(errorEventOrReason),
        name: 'UnknownErrorTypeNonStringifiable',
        stack: null,
      };
    }
  }

  /**
   * Converts an array of arguments (from log/error) into a single string.
   * Handles Error objects specially to include their message and stack.
   * @param {Array<*>} args - Arguments passed to console methods.
   * @return {string} A string representation of the arguments.
   */
  function stringifyArgs(args) {
    return args
      .map((arg) => {
        if (arg instanceof Error) {
          const {message, stack} = arg;
          return `Error: ${message}${stack ? ('\nStack: ' + stack) : ''}`;
        }
        if (typeof arg === 'object' && arg !== null) {
          try {
            return JSON.stringify(arg);
          } catch (error) {
            return '[Circular Object]';
          }
        } else {
          return String(arg);
        }
      })
      .join(' ');
  }

  console.log = function(...args) {
    const logString = stringifyArgs(args);
    window.parent.postMessage({ type: 'log', message: logString }, '*');
    originalConsoleLog.apply(console, args);
  };

  console.error = function(...args) {
    let errorData;
    if (args.length > 0 && args[0] instanceof Error) {
      const err = args[0];
      // If the first arg is an Error, capture its details.
      errorData = {
        type: 'error',
        source: 'CONSOLE_ERROR',
        ...getErrorObject(err),
        rawArgsString: stringifyArgs(args.slice(1)),
        timestamp: new Date().toISOString(),
      };
    } else {
      // If not an Error object, treat all args as a general error message.
      errorData = {
        type: 'error',
        source: 'CONSOLE_ERROR',
        message: stringifyArgs(args),
        name: 'ConsoleLoggedError',
        stack: null,
        timestamp: new Date().toISOString(),
      };
    }
    window.parent.postMessage(errorData, '*');
    originalConsoleError.apply(console, args);
  };

  // Listen for global unhandled synchronous errors.
  window.addEventListener('error', function(event) {
    const errorDetails = event.error ? getErrorObject(event.error) : {
      message: event.message,
      name: 'GlobalError',
      stack: null,
      filename: event.filename,
      lineno: event.lineno,
      colno: event.colno,
    };

    window.parent.postMessage({
      type: 'error',
      source: 'global',
      ...errorDetails,
      message: errorDetails.message || event.message,
      timestamp: new Date().toISOString(),
    }, '*');
  });

  // Listen for unhandled promise rejections (asynchronous errors).
  window.addEventListener('unhandledrejection', function(event) {
    const errorDetails = getErrorObject(event.reason);

    window.parent.postMessage({
      type: 'error',
      source: 'unhandledrejection',
      ...errorDetails,
      message: errorDetails.message || 'Unhandled Promise Rejection',
      timestamp: new Date().toISOString(),
    }, '*');
  });

})();</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2025年12月02日 金融市場日報|洞察•解構•透視全球資產</title>
    <meta name="description" content="2025年12月02日 金融市場日報|洞察•解構•透視全球資產">

    <style>
        /* 系統字體堆疊 */
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Noto Sans TC", Roboto, "Helvetica Neue", Arial, sans-serif;
            background: #f8fafc;
            line-height: 1.6;
            color: #1e293b;
            margin: 0;
            padding: 0;
        }

        /* 標題階層 */
        .main-title {
            font-size: 2.5rem;
            font-weight: 700;
            color: #1e293b;
            text-align: center;
            margin-bottom: 0.5rem;
            background: linear-gradient(to right, #4f46e5, #ec4899);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .sub-title {
            font-size: 3.125rem;
            font-weight: 600;
            color: #2563eb;
            text-align: center;
            margin-top: 0.5rem;
            display: block;
            margin-left: auto;
            margin-right: auto;
        }

        @media (max-width: 768px) {
            .main-title { font-size: 1.5rem; }
            .sub-title { font-size: 1.875rem; }
        }

        /* 章節與容器 */
        section { scroll-margin-top: 120px; }
        h2 {
            font-size: 1.5rem;
            font-weight: 700;
            margin: 0.5rem 0 1.5rem 0;
            display: flex;
            align-items: center;
        }
        h3.table-title {
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: 1rem;
            text-align: left;
            color: #374151;
        }

        .container {
            max-width: 80rem;
            margin: 0 auto;
            padding: 1rem;
        }
        @media (min-width: 768px) {
            .container { padding: 2rem; }
        }

        /* 表格樣式 */
        .table-styled {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            margin: 1rem 0;
        }
        .table-styled caption {
            padding: 1rem;
            font-weight: 600;
            text-align: left;
            background: #f8fafc;
            border-bottom: 1px solid #e2e8f0;
            caption-side: top;
        }
        .table-styled thead th {
            background: #f1f5f9;
            padding: 0.75rem;
            font-weight: 600;
            color: #374151;
            border-bottom: 2px solid #e5e7eb;
            position: sticky;
            top: 0;
            text-align: center;
        }
        .table-styled thead th:first-child {
            text-align: left;
        }
        .table-styled tbody td {
            padding: 0.75rem;
            border-bottom: 1px solid #f1f5f9;
            font-weight: 400;
            text-align: center;
        }
        .table-styled tbody td:first-child {
            text-align: left;
            font-weight: 500;
        }
        .table-styled tbody td strong {
             font-weight: normal !important;
        }
         .table-styled tbody tr.summary-row td {
            font-weight: 600 !important;
            border-top: 2px solid #e5e7eb;
         }

        /* 漲跌顏色 */
        .text-up { color: #dc2626; font-weight: 600; }
        .text-down { color: #059669; font-weight: 600; }
        .text-flat { color: #6b7280; font-weight: 500; }

        /* 熱度條 */
        .heat-container {
            margin: 1rem 0;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        .heat-item {
            display: flex;
            align-items: center;
            background: #f1f5f9;
            border-radius: 8px;
            overflow: hidden;
            position: relative;
            height: 2.5rem;
        }
        .heat-bar {
            display: flex;
            align-items: center;
            justify-content: flex-start;
            padding: 0.5rem 1rem;
            font-weight: 700;
            font-size: 1rem;
            color: white;
            height: 100%;
            border-radius: 8px 0 0 8px;
            transition: all 0.3s ease;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .heat-bar-1 { background: #dc2626; width: 100%; border-radius: 8px; }
        .heat-bar-2 { background: #dc2626; width: 92%; }
        .heat-bar-3 { background: #ea580c; width: 84%; }
        .heat-bar-4 { background: #ea580c; width: 76%; }
        .heat-bar-5 { background: #d97706; width: 68%; }
        .heat-bar-6 { background: #d97706; width: 60%; }
        .heat-bar-7 { background: #eab308; width: 52%; color: #1f2937; }
        .heat-bar-8 { background: #eab308; width: 44%; color: #1f2937; }
        .heat-bar-9 { background: #84cc16; width: 36%; color: #1f2937; }
        .heat-bar-10 { background: #84cc16; width: 28%; color: #1f2937; }

        /* 卡片 */
        .section-card {
            background: white;
            border-radius: 16px;
            padding: 2rem;
            margin: 2rem 0;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            border-left: 4px solid transparent;
            transition: all 0.3s ease;
        }
        .section-card:first-child { margin-top: 0.5rem; }
        .section-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
            border-left-color: #4f46e5;
        }

        /* 導覽列 */
        .nav-sticky {
            position: sticky;
            top: 0;
            z-index: 50;
            background: rgba(255, 255, 255, 0.95);
            border-bottom: 1px solid #e2e8f0;
            padding: 1rem;
            backdrop-filter: blur(8px);
        }
        .nav-content {
            max-width: 80rem;
            margin: 0 auto;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow-x: auto;
            scroll-behavior: smooth;
            scrollbar-width: none;
        }
        .nav-content::-webkit-scrollbar { display: none; }
        .nav-links-group {
            display: flex;
            gap: 1rem;
            font-size: 0.875rem;
            white-space: nowrap;
            align-items: center;
            min-width: fit-content;
        }
        .nav-links-group a {
            padding: 0.5rem 1rem;
            border-radius: 8px;
            text-decoration: none;
            background: #dc2626;
            color: white;
            font-weight: 700;
            transition: all 0.2s ease;
            white-space: nowrap;
            flex-shrink: 0;
        }
        .nav-links-group a:hover {
            background: #b91c1c;
            transform: translateY(-1px);
        }
        .nav-links-group .download-btn {
            background: #059669;
            color: white;
            border: none;
            border-radius: 8px;
            padding: 0.5rem 1rem;
            font-size: 0.875rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            white-space: nowrap;
            flex-shrink: 0;
        }
        .nav-links-group .download-btn:hover {
            background: #047857;
            transform: translateY(-1px);
        }

        /* 時間軸標籤 */
        .timeline-tag {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-right: 0.75rem;
            vertical-align: top;
        }
        .timeline-tag-taiwan { background: #f1f5f9; color: #1e293b; }
        .timeline-tag-us { background: #f1f5f9; color: #dc2626; }
        .timeline-container p {
            margin: 0;
            padding: 0.125rem 0;
            line-height: 1.4;
        }

        /* 深度分析樣式 */
        .analysis-block {
            background: #fffbeb;
            border-left: 4px solid #f59e0b;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 8px;
        }
        .analysis-block h4 {
            font-weight: 600;
            color: #92400e;
            margin-bottom: 1rem;
            font-size: 1.125rem;
        }
        .structured-analysis p {
            line-height: 1.75;
            margin-bottom: 1rem;
        }
        .structured-analysis p:last-child {
            margin-bottom: 0;
        }
        .structured-analysis strong {
             display: inline;
             margin-right: 0.5em;
             color: #92400e;
             font-size: 1rem;
             font-weight: 700;
        }
         .structured-analysis br {
            display: none;
         }

        /* 市場數據卡片 */
        .market-overview-custom { margin: 1.5rem 0; }
        .market-overview-row-1 {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }
        .grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }
        .grid-cols-1 { grid-template-columns: repeat(1, minmax(0, 1fr)); }
        @media (min-width: 1024px) {
          .lg\:grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }
        }

        .market-overview-row-2 {
            display: grid;
            grid-template-columns: 1fr 3fr;
            gap: 1.5rem;
        }
        .market-card-new {
            background: white;
            border-radius: 12px;
            padding: 1.25rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            transition: all 0.2s ease;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            min-height: 120px;
        }
        .market-card-new:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }
        .market-card-new.us-stock { border-left: 4px solid #dc2626; }
        .market-card-new.tw-stock { border-left: 4px solid #059669; }
        .market-card-new.bond { border-left: 4px solid #2563eb; }
        .market-card-new.commodity { border-left: 4px solid #f59e0b; }
        .market-card-new.fx { border-left: 4px solid #0891b2; }
        .market-card-title-new {
            font-size: 0.875rem;
            font-weight: 600;
            color: #6b7280;
            margin-bottom: 0.5rem;
        }
        .market-card-value-new {
            font-size: 1.125rem;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 0.5rem;
        }
         .market-card-value-new strong { font-weight: 700 !important; }
        .market-card-change-new {
            font-size: 0.75rem;
            font-weight: 500;
            margin-top: auto;
        }
         .market-card-change-new strong { font-weight: bold !important; }


        /* 產業分析表格 */
        .analysis-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            margin: 1rem 0;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            border-spacing: 0;
            table-layout: fixed;
        }
        .analysis-table th:first-child, .analysis-table td:first-child {
            width: 30%;
            padding-left: 0.75rem;
            vertical-align: top;
        }
        .analysis-table th:last-child, .analysis-table td:last-child {
            width: 70%;
            padding-right: 0.75rem;
            vertical-align: top;
        }
        .analysis-table td {
            padding-top: 0.75rem;
            padding-bottom: 0.75rem;
            border-bottom: 1px solid #f1f5f9;
            word-wrap: break-word;
            text-align: left;
            font-weight: 400 !important;
        }
        .analysis-table th {
            background: #f8fafc;
            padding-top: 0.75rem;
            padding-bottom: 0.75rem;
            font-weight: 600;
            text-align: left;
            color: #374151;
        }
        .analysis-table td strong { font-weight: normal !important; }
        .analysis-table .font-semibold { font-weight: 600 !important; }


        /* 個股推薦卡片 */
        .stock-recommendation {
            background: white;
            border-radius: 12px;
            padding: 2rem;
            margin: 2rem 0;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        .stock-recommendation.bullish { border-left: 4px solid #059669; }
        .stock-recommendation.bearish { border-left: 4px solid #dc2626; }
        .recommendation-title {
            font-size: 1.125rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
        }
        .recommendation-title.bullish { color: #059669; }
        .recommendation-title.bearish { color: #dc2626; }


        /* 連結按鈕 */
        .link-button-container {
             display: flex;
             flex-direction: column;
             gap: 0.5rem;
             width: 100%;
             align-items: flex-start;
        }
        .link-button {
            display: block;
            padding: 0.6rem 0.8rem;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.2s ease;
            text-align: center;
            width: 95%;
            max-width: 150px;
            margin: 0;
            font-size: 0.875rem;
            box-sizing: border-box;
        }
        .link-button.fundamental { background: #2563eb; color: white; }
        .link-button.fundamental:hover { background: #1d4ed8; }
        .link-button.technical { background: #374151; color: white; }
        .link-button.technical:hover { background: #111827; }
        .link-button-subtitle {
            display: block;
            font-size: 0.75rem;
            font-weight: 400;
            opacity: 0.9;
            margin-top: 0.25rem;
        }


        /* 回頂按鈕 */
        .back-to-top {
            position: fixed;
            left: 1.5rem;
            bottom: 1.5rem;
            background: #4f46e5;
            color: white;
            border: none;
            border-radius: 50%;
            width: 48px;
            height: 48px;
            font-size: 1.125rem;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 40;
            transition: all 0.2s ease;
        }
        .back-to-top:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
        }

        /* 進度條 */
        .progress-bar {
            height: 3px;
            background: #4f46e5;
            position: fixed;
            top: 0;
            left: 0;
            z-index: 100;
            transition: width 0.3s ease;
        }

        /* 網格佈局 (通用) */
        .grid { display: grid; }
        .gap-8 { gap: 2rem; }

        /* TL;DR區塊 */
        .tldr-block {
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1.5rem;
        }
        .tldr-block ul {
            list-style: none;
            padding: 0;
            margin: 0;
            font-size: 1rem;
        }
        .tldr-block li {
            margin: 0.75rem 0;
            padding-left: 1rem;
            position: relative;
        }
        .tldr-block li::before {
            content: "•";
            position: absolute;
            left: 0;
            font-weight: 700;
        }
         .tldr-block li strong {
            font-weight: 700 !important;
         }

        /* 響應式 */
        @media (max-width: 1024px) {
            .market-overview-row-1 { grid-template-columns: repeat(2, 1fr); }
        }
        @media (max-width: 768px) {
            .grid-cols-2, .lg\:grid-cols-2 { grid-template-columns: 1fr; }
            .market-overview-row-1,
            .market-overview-row-2 { grid-template-columns: 1fr; }
            .back-to-top { left: 1rem; bottom: 5rem; }
            .analysis-table th:first-child, .analysis-table td:first-child {
                width: 40%;
            }
            .analysis-table th:last-child, .analysis-table td:last-child {
                width: 60%;
            }

            .nav-content {
                justify-content: flex-start;
                padding-left: 0.5rem;
                padding-right: 0.5rem;
            }
            .nav-links-group { gap: 0.75rem; }
        }

        /* 工具類 */
        .text-center { text-align: center; }
        .text-right { text-align: right; }
        .font-semibold { font-weight: 600; }
        .text-xs { font-size: 0.75rem; }
        .mt-4 { margin-top: 1rem; }
        .overflow-x-auto { overflow-x: auto; }

        @media print {
            .nav-sticky, .back-to-top, .download-btn, .progress-bar { display: none; }
        }
    </style>
</head>
<body>

<!-- 進度條 -->
<div class="progress-bar" id="progressBar" style="width: 0%; opacity: 0; transition: opacity 0.5s ease-out; display: none;"></div>

<!-- 導覽工具列 -->
<div class="nav-sticky">
    <div class="nav-content">
        <div class="nav-links-group">
            <a href="#sec-1">市場總覽</a>
            <a href="#sec-2">歐美股市</a>
            <a href="#sec-3">債券市場</a>
            <a href="#sec-4">大宗商品</a>
            <a href="#sec-5">台股解析</a>
            <a href="#sec-6">匯率市場</a>
            <a href="#sec-7">產業展望</a>
            <button class="download-btn" id="smartDownloadBtn">🔥 下載日報</button>
        </div>
    </div>
</div>

<div class="container">

    <!-- 標題 -->
    <header style="text-align: center; margin: 0;">
        <h1 class="main-title" style="margin: 0; margin-bottom: 0.125rem;">2025年12月02日 金融市場日報</h1>
        <p class="sub-title" style="margin: 0;">外資賣台股跌，PMI弱美股跌，金價勁揚避險增溫</p>
    </header>

    <!-- 第1章:市場總覽與重點 -->
    <section id="sec-1" class="section-card">
        <h2 style="color: #015fb4;"><span style="margin-right: 0.75rem;">📋</span>第1章｜市場總覽與重點</h2>

        <div class="tldr-block" style="background: #f0f9ff;">
            <h3 class="table-title">市場三大要點</h3>
            <ul>
                <li style="color: #015fb4;"><strong>經濟降溫：</strong>美國製造業PMI續疲，新訂單與就業指數滑落，經濟軟著陸變數仍存。</li>
                <li style="color: #015fb4;"><strong>金價狂飆：</strong>地緣政治風險與降息預期共振，黃金期貨大漲3.54%創歷史新高。</li>
                <li style="color: #015fb4;"><strong>台股修正：</strong>外資大舉賣超243億元，權值股遭提款，加權指數下跌283點痛失月線。</li>
            </ul>
        </div>

        <div class="market-overview-custom">
            <h3 class="table-title">市場核心數據速覽</h3>
            <div class="market-overview-row-1">
                <div class="market-card-new us-stock">
                    <div class="market-card-title-new">美股市場</div>
                    <div class="market-card-value-new">標普500 <strong>6,812.63</strong></div>
                    <div class="market-card-change-new text-down">▼ <strong>-0.53%</strong> • 製造業數據疲軟，經濟放緩擔憂壓抑股市表現。</div>
                </div>
                <div class="market-card-new tw-stock">
                    <div class="market-card-title-new">台股市場</div>
                    <div class="market-card-value-new">加權 <strong>27,342.53</strong></div>
                    <div class="market-card-change-new text-down">▼ <strong>-1.03%</strong> • 外資大賣243億，權值股修正拖累指數。</div>
                </div>
                <div class="market-card-new bond">
                    <div class="market-card-title-new">債券市場</div>
                    <div class="market-card-value-new">10年期殖利率 <strong>4.10%</strong></div>
                    <div class="market-card-change-new text-up">▲ <strong>+7.9 bps</strong> • 債市拋售壓力湧現，殖利率顯著反彈。</div>
                </div>
                <div class="market-card-new commodity">
                    <div class="market-card-title-new">大宗商品</div>
                    <div class="market-card-value-new">黃金期貨 <strong>4,236.90</strong></div>
                    <div class="market-card-change-new text-up">▲ <strong>+3.54%</strong> • 避險買盤湧入支撐，WTI +1.14%。</div>
                </div>
            </div>
            <div class="market-overview-row-2">
                <div class="market-card-new fx">
                    <div class="market-card-title-new">匯率市場</div>
                    <div class="market-card-value-new">美元指數 <strong>99.42</strong></div>
                    <div class="market-card-change-new text-down">▼ <strong>-0.04%</strong> • 降息預期與避險情緒拉鋸，指數狹幅震盪。</div>
                </div>
                <div></div>
            </div>
        </div>

         <!-- --- v3.1.3 修正: 並排斷點改為 lg --- -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <div>
                <h3 class="table-title">Top 10 市場熱點事件榜</h3>
                <div class="heat-container">
                    <div class="heat-item"><div class="heat-bar heat-bar-1">金價創高</div></div>
                    <div class="heat-item"><div class="heat-bar heat-bar-2">台股重挫</div></div>
                    <div class="heat-item"><div class="heat-bar heat-bar-3">外資大賣</div></div>
                    <div class="heat-item"><div class="heat-bar heat-bar-4">比特幣崩</div></div>
                    <div class="heat-item"><div class="heat-bar heat-bar-5">美債息揚</div></div>
                    <div class="heat-item"><div class="heat-bar heat-bar-6">製造業弱</div></div>
                    <div class="heat-item"><div class="heat-bar heat-bar-7">輝達入股</div></div>
                    <div class="heat-item"><div class="heat-bar heat-bar-8">勞退大賺</div></div>
                    <div class="heat-item"><div class="heat-bar heat-bar-9">日銀放鷹</div></div>
                    <div class="heat-item"><div class="heat-bar heat-bar-10">空巴暴跌</div></div>
                </div>
                <p class="text-xs" style="color: #64748b; margin-top: 0.5rem;">*熱度基於過去24小時新聞與社群討論量標準化</p>
            </div>
            <div>
                <h3 class="table-title">市場關鍵時間軸</h3>
                <div class="structured-analysis space-y-4 timeline-container">
                    <p><span class="timeline-tag timeline-tag-taiwan">台股盤中 09:51</span>亞洲股市表現不佳，台股開盤偏弱下跌逾百點，電子權值股承壓。</p>
                    <p><span class="timeline-tag timeline-tag-taiwan">台股盤中 11:30</span>上游電子材料需求旺，南亞股價逆勢抗跌漲逾半根停板，創近期新高。</p>
                    <p><span class="timeline-tag timeline-tag-taiwan">台股盤中 13:17</span>勞動基金10月獲利衝破3006億元，前十月收益率亮眼，為台股提供下檔支撐。</p>
                    <p><span class="timeline-tag timeline-tag-taiwan">台股盤後 14:17</span>台積電尾盤遭大單調節收跌30元，加權指數終場下跌284點失守月線。</p>
                    <p><span class="timeline-tag timeline-tag-taiwan">台股盤後 17:20</span>外資單日賣超243億元，主要提款台積電與權值股，籌碼面轉趨保守。</p>
                    <p><span class="timeline-tag timeline-tag-us">美股盤前 21:00</span>市場關注聯準會十二月會議決策，官員對通膨與降息路徑看法分歧，增添不確定性。</p>
                    <p><span class="timeline-tag timeline-tag-us">美股盤中 22:41</span>美股主要指數十二月開局走弱，比特幣價格回檔拖累風險情緒，科技股普遍修正。</p>
                    <p><span class="timeline-tag timeline-tag-us">美股盤中 23:00</span>輝達宣布入股新思科技深化AI合作，軟硬體整合趨勢明確，支撐半導體長線展望。</p>
                    <p><span class="timeline-tag timeline-tag-us">美股盤後 00:11</span>美國十一月製造業PMI數據不如預期，新訂單與就業分項轉弱，經濟放緩擔憂升溫。</p>
                    <p><span class="timeline-tag timeline-tag-us">美股盤後 03:00</span>比特幣價格重挫失守九萬五千美元，拖累MicroStrategy等加密貨幣概念股股價大跌。</p>
                </div>
            </div>
        </div>
    </section>

    <!-- 第2章:歐美股市 -->
    <section id="sec-2" class="section-card">
        <h2 style="color: #dc2626;"><span style="margin-right: 0.75rem;">📈</span>第2章｜歐美股市</h2>

        <div class="tldr-block" style="background: #fef2f2;">
            <ul>
                <li style="color: #dc2626;"><strong>經濟隱憂：</strong>美國11月製造業數據持續疲軟，新訂單與就業分項指標滑落，引發市場對經濟放緩的擔憂。</li>
                <li style="color: #dc2626;"><strong>科技修正：</strong>比特幣與加密貨幣概念股大幅回調，拖累那斯達克與半導體類股表現，費半指數微幅收跌。</li>
                <li style="color: #dc2626;"><strong>避險升溫：</strong>市場風險偏好下降，資金流向防禦性板塊與黃金，道瓊與標普500指數同步收黑。</li>
            </ul>
        </div>

        <h3 class="table-title">歐美主要股市行情</h3>
        <div class="overflow-x-auto">
            <table class="table-styled">
                <caption>歐美主要股市指數漲跌概覽</caption>
                <thead>
                    <tr>
                        <th>指標名稱</th>
                        <th>最新收盤價</th>
                        <th>日漲跌</th>
                        <th>五日漲跌</th>
                        <th>月漲跌</th>
                        <th>季漲跌</th>
                        <th>年初至今</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>道瓊工業指數</td>
                        <td><strong>47,289.33</strong></td>
                        <td class="text-down"><strong>-0.90%</strong></td>
                        <td class="text-up"><strong>+2.26%</strong></td>
                        <td class="text-down"><strong>-0.58%</strong></td>
                        <td class="text-up"><strong>+3.83%</strong></td>
                        <td class="text-up"><strong>+11.15%</strong></td>
                    </tr>
                    <tr>
                        <td>標普500</td>
                        <td><strong>6,812.63</strong></td>
                        <td class="text-down"><strong>-0.53%</strong></td>
                        <td class="text-up"><strong>+3.17%</strong></td>
                        <td class="text-down"><strong>-0.40%</strong></td>
                        <td class="text-up"><strong>+5.45%</strong></td>
                        <td class="text-up"><strong>+15.83%</strong></td>
                    </tr>
                    <tr>
                        <td>那斯達克</td>
                        <td><strong>23,275.92</strong></td>
                        <td class="text-down"><strong>-0.38%</strong></td>
                        <td class="text-up"><strong>+4.50%</strong></td>
                        <td class="text-down"><strong>-1.89%</strong></td>
                        <td class="text-up"><strong>+8.48%</strong></td>
                        <td class="text-up"><strong>+20.53%</strong></td>
                    </tr>
                    <tr>
                        <td>費城半導體指數</td>
                        <td><strong>7,020.53</strong></td>
                        <td class="text-down"><strong>-0.07%</strong></td>
                        <td class="text-up"><strong>+9.59%</strong></td>
                        <td class="text-down"><strong>-2.88%</strong></td>
                        <td class="text-up"><strong>+23.84%</strong></td>
                        <td class="text-up"><strong>+40.98%</strong></td>
                    </tr>
                    <tr>
                        <td>羅素2000</td>
                        <td><strong>2,469.13</strong></td>
                        <td class="text-down"><strong>-1.25%</strong></td>
                        <td class="text-up"><strong>+4.20%</strong></td>
                        <td class="text-down"><strong>-0.41%</strong></td>
                        <td class="text-up"><strong>+4.34%</strong></td>
                        <td class="text-up"><strong>+10.72%</strong></td>
                    </tr>
                    <tr>
                        <td>道瓊歐洲50</td>
                        <td><strong>5,667.48</strong></td>
                        <td class="text-down"><strong>-0.01%</strong></td>
                        <td class="text-up"><strong>+2.76%</strong></td>
                        <td class="text-up"><strong>+0.10%</strong></td>
                        <td class="text-up"><strong>+5.90%</strong></td>
                        <td class="text-up"><strong>+16.39%</strong></td>
                    </tr>
                </tbody>
            </table>
        </div>
        <p class="text-xs text-right" style="color: #64748b; margin-top: 0.5rem;">資料來源: Yahoo Finance</p>

        <!-- --- v3.1.9 替換: 深度分析區塊使用 v2.8 格式 --- -->
        <div class="analysis-block">
            <h4>深度分析:</h4>
            <div class="structured-analysis">
                 <p><strong>製造業數據疲軟，經濟衰退擔憂重燃</strong><br>美國11月製造業PMI數據表現不如預期，新訂單與就業指數雙雙滑落，顯示製造業活動持續萎縮。傳導機制在於經濟數據疲軟引發市場對硬著陸的擔憂，資金從風險資產撤出，轉向黃金等避險標的。道瓊工業指數下跌<strong>0.90%</strong>，反映出傳統週期性板塊對經濟前景的敏感度。</p>
                 <p><strong>比特幣回檔衝擊信心，關注科技股支撐</strong><br>當前最大風險在於加密貨幣市場的大幅波動是否會擴散至更廣泛的科技股。關鍵訊號是比特幣價格失守關鍵支撐，拖累相關概念股與高估值科技股表現。深層解讀指出，雖然短期市場情緒受壓，但輝達等AI領頭羊的基本面依然穩健，若經濟數據未進一步惡化，科技股在修正後仍具備反彈契機。</p>
            </div>
        </div>
    </section>

    <!-- 第3章:債券市場 -->
    <section id="sec-3" class="section-card">
        <h2 style="color: #2563eb;"><span style="margin-right: 0.75rem;">🏛️</span>第3章｜債券市場</h2>

        <div class="tldr-block" style="background: #eff6ff;">
            <ul>
                <li style="color: #2563eb;"><strong>殖利率反彈：</strong>儘管經濟數據疲軟，但受日本央行升息預期及企業發債潮影響，10年期美債殖利率上揚7.9 bps至4.10%。</li>
                <li style="color: #2563eb;"><strong>長債賣壓：</strong>30年期公債殖利率同步走高，顯示市場對長期通膨與供給壓力的擔憂仍存，殖利率曲線陡峭化。</li>
                <li style="color: #2563eb;"><strong>信用利差：</strong>高收益債ETF(HYG)下跌0.64%，顯示在風險趨避情緒下，資金流出信用債市場，信用利差有擴大跡象。</li>
            </ul>
        </div>

        <h3 class="table-title">主要債券與殖利率行情</h3>
        <div class="overflow-x-auto">
            <table class="table-styled">
                <caption>主要債券與殖利率變動概覽</caption>
                <thead>
                    <tr>
                        <th>指標名稱</th>
                        <th>最新殖利率/價格</th>
                        <th>日變動</th>
                        <th>五日變動</th>
                        <th>月變動</th>
                        <th>季變動</th>
                        <th>年初至今變動</th>
                    </tr>
                </thead>
                <!-- --- v3.1.2 修正: 補齊表格行佔位符 --- -->
                <tbody>
                    <tr>
                        <td>美國3月期殖利率</td>
                        <td><strong>3.69%</strong></td>
                        <td class="text-down"><strong>-0.4 bps</strong></td>
                        <td class="text-down"><strong>-4.7 bps</strong></td>
                        <td class="text-down"><strong>-2.5 bps</strong></td>
                        <td class="text-down"><strong>-35.0 bps</strong></td>
                        <td class="text-down"><strong>-51.5 bps</strong></td>
                    </tr>
                    <tr>
                        <td>美國5年期殖利率</td>
                        <td><strong>3.67%</strong></td>
                        <td class="text-up"><strong>+7.3 bps</strong></td>
                        <td class="text-up"><strong>+5.5 bps</strong></td>
                        <td class="text-down"><strong>-4.4 bps</strong></td>
                        <td class="text-down"><strong>-2.6 bps</strong></td>
                        <td class="text-down"><strong>-70.7 bps</strong></td>
                    </tr>
                    <tr>
                        <td>美國10年期殖利率</td>
                        <td><strong>4.10%</strong></td>
                        <td class="text-up"><strong>+7.9 bps</strong></td>
                        <td class="text-up"><strong>+3.3 bps</strong></td>
                        <td class="text-down"><strong>-0.5 bps</strong></td>
                        <td class="text-down"><strong>-13.1 bps</strong></td>
                        <td class="text-down"><strong>-47.7 bps</strong></td>
                    </tr>
                    <tr>
                        <td>美國30年期殖利率</td>
                        <td><strong>4.74%</strong></td>
                        <td class="text-up"><strong>+7.9 bps</strong></td>
                        <td class="text-up"><strong>+2.9 bps</strong></td>
                        <td class="text-up"><strong>+7.4 bps</strong></td>
                        <td class="text-down"><strong>-17.3 bps</strong></td>
                        <td class="text-down"><strong>-4.2 bps</strong></td>
                    </tr>
                    <tr>
                        <td>高收益債券ETF(HYG)</td>
                        <td><strong>80.47</strong></td>
                        <td class="text-down"><strong>-0.64%</strong></td>
                        <td class="text-up"><strong>+0.12%</strong></td>
                        <td class="text-down"><strong>-0.41%</strong></td>
                        <td class="text-down"><strong>-0.48%</strong></td>
                        <td class="text-up"><strong>+2.31%</strong></td>
                    </tr>
                    <tr>
                        <td>新興市場美元債ETF(EMB)</td>
                        <td><strong>96.02</strong></td>
                        <td class="text-down"><strong>-0.73%</strong></td>
                        <td class="text-down"><strong>-0.14%</strong></td>
                        <td class="text-down"><strong>-0.67%</strong></td>
                        <td class="text-up"><strong>+2.02%</strong></td>
                        <td class="text-up"><strong>+7.84%</strong></td>
                    </tr>
                </tbody>
            </table>
        </div>
        <p class="text-xs text-right" style="color: #64748b; margin-top: 0.5rem;">資料來源: Yahoo Finance</p>

        <!-- --- v3.1.9 替換: 深度分析區塊使用 v2.8 格式 --- -->
        <div class="analysis-block">
            <h4>深度分析:</h4>
            <div class="structured-analysis">
                <p><strong>供給壓力與外部衝擊，推升美債殖利率</strong><br>雖然美國製造業數據疲軟理論上應壓低殖利率，但10年期公債殖利率不跌反升至<strong>4.10%</strong>。這主要受到企業債券發行量大增，以及日本央行可能升息導致日資流出美債的預期影響。雙重打擊下，債市賣壓湧現，長端利率顯著反彈，抵銷了降息預期帶來的利多。</p>
                <p><strong>信用風險浮現，高收益債面臨修正</strong><br>隨著股市回檔與經濟前景不確定性增加，高收益債ETF(HYG)下跌<strong>0.64%</strong>，新興市場債ETF(EMB)亦下跌<strong>0.73%</strong>。深層解讀顯示，市場開始重新定價信用風險，資金從高風險債券撤出轉向更安全的資產。可驗證指標為信用利差走勢，若持續擴大，將對企業融資成本構成壓力。</p>
            </div>
        </div>
    </section>

    <!-- 第4章:大宗商品 -->
    <section id="sec-4" class="section-card">
        <h2 style="color: #cc4e01;"><span style="margin-right: 0.75rem;">🔥</span>第4章｜大宗商品</h2>

        <div class="tldr-block" style="background: #fffbeb;">
            <ul>
                <li style="color: #cc4e01;"><strong>金價狂飆：</strong>避險需求大爆發，黃金期貨單日大漲3.54%，突破4200美元大關，創下歷史新高，布蘭特 -0.09%。</li>
                <li style="color: #cc4e01;"><strong>油價震盪：</strong>WTI原油受美國LNG出口創高與部分買盤支撐上漲1.14%，但布蘭特原油微跌，油市多空持續拉鋸。</li>
                <li style="color: #cc4e01;"><strong>金屬持穩：</strong>供應擔憂支撐基本金屬價格，基礎金屬ETF(DBB)微幅上漲0.14%，表現相對平穩。</li>
            </ul>
        </div>

        <h3 class="table-title">能源與商品市場行情</h3>
        <div class="overflow-x-auto">
            <table class="table-styled">
                <caption>能源與商品市場價格變動概覽</caption>
                <thead>
                    <tr>
                        <th>指標名稱</th>
                        <th>最新價格</th>
                        <th>日漲跌</th>
                        <th>五日漲跌</th>
                        <th>月漲跌</th>
                        <th>季漲跌</th>
                        <th>年初至今</th>
                    </tr>
                </thead>
                 <!-- --- v3.1.2 修正: 補齊表格行佔位符 --- -->
                <tbody>
                    <tr>
                        <td>WTI原油</td>
                        <td><strong>59.51</strong></td>
                        <td class="text-up"><strong>+1.14%</strong></td>
                        <td class="text-up"><strong>+2.50%</strong></td>
                        <td class="text-down"><strong>-2.41%</strong></td>
                        <td class="text-down"><strong>-7.03%</strong></td>
                        <td class="text-down"><strong>-17.02%</strong></td>
                    </tr>
                    <tr>
                        <td>布蘭特原油</td>
                        <td><strong>63.31</strong></td>
                        <td class="text-down"><strong>-0.09%</strong></td>
                        <td class="text-up"><strong>+1.20%</strong></td>
                        <td class="text-down"><strong>-2.70%</strong></td>
                        <td class="text-down"><strong>-7.06%</strong></td>
                        <td class="text-down"><strong>-15.18%</strong></td>
                    </tr>
                    <tr>
                        <td>黃金期貨</td>
                        <td><strong>4,236.90</strong></td>
                        <td class="text-up"><strong>+3.54%</strong></td>
                        <td class="text-up"><strong>+3.93%</strong></td>
                        <td class="text-up"><strong>+6.40%</strong></td>
                        <td class="text-up"><strong>+21.97%</strong></td>
                        <td class="text-up"><strong>+61.15%</strong></td>
                    </tr>
                    <tr>
                        <td>基礎金屬ETF (DBB)</td>
                        <td><strong>22.01</strong></td>
                        <td class="text-up"><strong>+0.14%</strong></td>
                        <td class="text-up"><strong>+3.28%</strong></td>
                        <td class="text-up"><strong>+0.27%</strong></td>
                        <td class="text-up"><strong>+11.67%</strong></td>
                        <td class="text-up"><strong>+16.76%</strong></td>
                    </tr>
                </tbody>
            </table>
        </div>
        <p class="text-xs text-right" style="color: #64748b; margin-top: 0.5rem;">資料來源: Yahoo Finance</p>

        <!-- --- v3.1.9 替換: 深度分析區塊使用 v2.8 格式 --- -->
        <div class="analysis-block">
            <h4>深度分析:</h4>
            <div class="structured-analysis">
                <p><strong>避險情緒與降息預期共振，金價大漲創高</strong><br>黃金期貨勁升<strong>3.54%</strong>，收在<strong>4,236.90美元</strong>，創下歷史新高。驅動因子包括美元指數疲軟、美債殖利率曲線變化引發的不確定性，以及全球地緣政治風險，布蘭特 -0.09%。機構投資者與央行的持續買盤，加上技術面突破，推升金價加速上行，成為市場最亮眼的資產類別。</p>
                <p><strong>能源市場多空交錯，油價區間整理</strong><br>WTI原油上漲<strong>1.14%</strong>，主要受美國LNG出口創新高及部分逢低買盤帶動。然而，布蘭特原油微跌，顯示市場對明年供過於求的擔憂揮之不去。深層解讀指出，在缺乏強勁需求復甦訊號下，油價仍將受制於庫存數據與OPEC+產量政策，短期內難以走出明確趨勢。</p>
            </div>
        </div>
    </section>

    <!-- 第5章:台股解析 -->
    <section id="sec-5" class="section-card">
        <h2 style="color: #059669;"><span style="margin-right: 0.75rem;">🗻</span>第5章｜台股解析</h2>

        <div class="tldr-block" style="background: #f0fdf4;">
            <ul>
                <li style="color: #059669;"><strong>外資大賣：</strong>外資單日大舉賣超243億元，權值股成為提款重心，加權指數下跌283點，失守月線支撐。</li>
                <li style="color: #059669;"><strong>投信獨木：</strong>投信逆勢買超77億元，展現內資撐盤意願，但難敵外資龐大賣壓，市場氣氛轉趨保守。</li>
                <li style="color: #059669;"><strong>技術轉弱：</strong>指數跌破重要均線，日KD指標高檔交叉向下，短線技術面轉弱，整理時間恐拉長。</li>
            </ul>
        </div>

        <div class="overflow-x-auto">
            <table class="table-styled">
                <caption>亞洲主要股市指數漲跌概覽</caption>
                <thead>
                    <tr>
                        <th>指標名稱</th>
                        <th>最新收盤價</th>
                        <th>日漲跌</th>
                        <th>五日漲跌</th>
                        <th>月漲跌</th>
                        <th>季漲跌</th>
                        <th>年初至今</th>
                    </tr>
                </thead>
                 <!-- --- v3.1.2 修正: 補齊表格行佔位符 --- -->
                <tbody>
                    <tr>
                        <td>台灣加權指數</td>
                        <td><strong>27,342.53</strong></td>
                        <td class="text-down"><strong>-1.03%</strong></td>
                        <td class="text-up"><strong>+3.43%</strong></td>
                        <td class="text-down"><strong>-3.16%</strong></td>
                        <td class="text-up"><strong>+12.83%</strong></td>
                        <td class="text-up"><strong>+18.70%</strong></td>
                    </tr>
                    <tr>
                        <td>日經225</td>
                        <td><strong>49,303.28</strong></td>
                        <td class="text-down"><strong>-1.89%</strong></td>
                        <td class="text-up"><strong>+1.39%</strong></td>
                        <td class="text-down"><strong>-5.93%</strong></td>
                        <td class="text-up"><strong>+15.41%</strong></td>
                        <td class="text-up"><strong>+23.58%</strong></td>
                    </tr>
                    <tr>
                        <td>香港恆生指數</td>
                        <td><strong>26,033.26</strong></td>
                        <td class="text-up"><strong>+0.67%</strong></td>
                        <td class="text-up"><strong>+3.22%</strong></td>
                        <td class="text-up"><strong>+0.49%</strong></td>
                        <td class="text-up"><strong>+3.81%</strong></td>
                        <td class="text-up"><strong>+29.78%</strong></td>
                    </tr>
                    <tr>
                        <td>韓國KOSPI</td>
                        <td><strong>3,920.37</strong></td>
                        <td class="text-down"><strong>-0.16%</strong></td>
                        <td class="text-up"><strong>+1.74%</strong></td>
                        <td class="text-down"><strong>-4.56%</strong></td>
                        <td class="text-up"><strong>+23.05%</strong></td>
                        <td class="text-up"><strong>+63.38%</strong></td>
                    </tr>
                    <tr>
                        <td>印度SENSEX</td>
                        <td><strong>85,641.90</strong></td>
                        <td class="text-down"><strong>-0.08%</strong></td>
                        <td class="text-up"><strong>+0.48%</strong></td>
                        <td class="text-up"><strong>+2.03%</strong></td>
                        <td class="text-up"><strong>+7.31%</strong></td>
                        <td class="text-up"><strong>+9.60%</strong></td>
                    </tr>
                </tbody>
            </table>
        </div>
        <p class="text-xs text-right" style="color: #64748b; margin-top: 0.5rem;">資料來源: Yahoo Finance</p>

        <h3 class="table-title" style="margin-top: 2rem;">台股三大法人買賣超 (2025年12月01日)</h3>
        <div class="overflow-x-auto">
            <table class="table-styled">
                <caption>台股三大法人買賣超統計</caption>
                <thead>
                    <tr>
                        <th>法人別</th>
                        <th>當日淨額(億)</th>
                        <th>5日累計(億)</th>
                        <th>20日累計(億)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>外資</td>
                        <td class="text-down"><strong>-243.49</strong></td>
                        <td class="text-down"><strong>-116.05</strong></td>
                        <td class="text-down"><strong>-3907.36</strong></td>
                    </tr>
                    <tr>
                        <td>投信</td>
                        <td class="text-up"><strong>+77.15</strong></td>
                        <td class="text-up"><strong>+297.93</strong></td>
                        <td class="text-up"><strong>+168.17</strong></td>
                    </tr>
                    <tr>
                        <td>自營商</td>
                        <td class="text-down"><strong>-21.90</strong></td>
                        <td class="text-up"><strong>+136.49</strong></td>
                        <td class="text-down"><strong>-705.79</strong></td>
                    </tr>
                    <tr class="summary-row">
                        <td>總計</td>
                        <td class="text-down"><strong>-188.24</strong></td>
                        <td class="text-up"><strong>+318.37</strong></td>
                        <td class="text-down"><strong>-4444.98</strong></td>
                    </tr>
                </tbody>
            </table>
        </div>
        <p class="text-xs text-right" style="color: #64748b; margin-top: 0.5rem;">資料來源: 交易所資料整理</p>

        <!-- --- v3.1.9 替換: 深度分析區塊使用 v2.8 格式 --- -->
        <div class="analysis-block">
            <h4>深度分析:</h4>
            <div class="structured-analysis">
                <p><strong>外資大舉提款，台股修正失守月線</strong><br>受美股電子盤走弱與亞洲股市普遍回檔影響，台股下跌<strong>1.03%</strong>收在<strong>27,342點</strong>。外資單日賣超<strong>243.49億元</strong>，成為殺盤主力，台積電尾盤遭摜壓，加重指數跌勢。雖然投信積極買超<strong>77.15億元</strong>，試圖撐盤，但內資力道難敵外資賣壓，電子權值股成為重災區。</p>
                <p><strong>籌碼面轉趨保守，留意季線支撐力道</strong><br>當前最大風險在於外資賣超的延續性與國際股市的波動。關鍵訊號是融資餘額是否隨指數下跌而減少，以及外資期貨空單變化。深層解讀指出，在缺乏強勁利多刺激下，台股短線可能回測季線支撐。可驗證指標為新台幣匯率，若持續貶值，恐加重外資匯出壓力，不利指數反彈。</p>
            </div>
        </div>
    </section>

    <!-- 第6章:匯率市場 -->
    <section id="sec-6" class="section-card">
        <h2 style="color: #0891b2;"><span style="margin-right: 0.75rem;">💱</span>第6章｜匯率市場</h2>

        <div class="tldr-block" style="background: #ecfeff;">
            <ul>
                <li style="color: #0891b2;"><strong>美元震盪：</strong>美國經濟數據疲軟壓抑美元，但避險情緒提供支撐，美元指數微跌0.04%至99.42，維持低檔整理。</li>
                <li style="color: #0891b2;"><strong>日圓升值：</strong>日本央行總裁發出升息訊號，加上避險資金流入，日圓兌美元升值0.53%，表現相對強勢。</li>
                <li style="color: #0891b2;"><strong>台幣回貶：</strong>受台股重挫與外資匯出影響，台幣兌美元貶值0.26%，收在31.395，呈現股匯雙殺格局。</li>
            </ul>
        </div>

        <h3 class="table-title">主要貨幣兌美元匯率</h3>
        <div class="overflow-x-auto">
            <table class="table-styled">
                <caption>主要貨幣兌美元匯率變動概覽</caption>
                <thead>
                    <tr>
                        <th>指標名稱</th>
                        <th>最新匯率</th>
                        <th>日漲跌</th>
                        <th>五日漲跌</th>
                        <th>月漲跌</th>
                        <th>季漲跌</th>
                        <th>年初至今</th>
                    </tr>
                </thead>
                 <!-- --- v3.1.2 修正: 補齊表格行佔位符 --- -->
                <tbody>
                    <tr>
                        <td>美元指數</td>
                        <td><strong>99.42</strong></td>
                        <td class="text-down"><strong>-0.04%</strong></td>
                        <td class="text-down"><strong>-0.76%</strong></td>
                        <td class="text-down"><strong>-0.38%</strong></td>
                        <td class="text-up"><strong>+1.68%</strong></td>
                        <td class="text-down"><strong>-8.36%</strong></td>
                    </tr>
                    <tr>
                        <td>美元兌台幣</td>
                        <td><strong>31.3950</strong></td>
                        <td class="text-up"><strong>+0.26%</strong></td>
                        <td class="text-up"><strong>+0.14%</strong></td>
                        <td class="text-up"><strong>+2.16%</strong></td>
                        <td class="text-up"><strong>+2.96%</strong></td>
                        <td class="text-down"><strong>-4.17%</strong></td>
                    </tr>
                    <tr>
                        <td>歐元兌美元</td>
                        <td><strong>1.1612</strong></td>
                        <td class="text-up"><strong>+0.10%</strong></td>
                        <td class="text-up"><strong>+0.67%</strong></td>
                        <td class="text-up"><strong>+0.34%</strong></td>
                        <td class="text-down"><strong>-0.60%</strong></td>
                        <td class="text-up"><strong>+11.59%</strong></td>
                    </tr>
                    <tr>
                        <td>美元兌日圓</td>
                        <td><strong>155.4540</strong></td>
                        <td class="text-down"><strong>-0.53%</strong></td>
                        <td class="text-down"><strong>-1.22%</strong></td>
                        <td class="text-up"><strong>+1.01%</strong></td>
                        <td class="text-up"><strong>+5.90%</strong></td>
                        <td class="text-down"><strong>-0.98%</strong></td>
                    </tr>
                </tbody>
            </table>
        </div>
        <p class="text-xs text-right" style="color: #64748b; margin-top: 0.5rem;">資料來源: Yahoo Finance</p>

        <!-- --- v3.1.9 替換: 深度分析區塊使用 v2.8 格式 --- -->
        <div class="analysis-block">
            <h4>深度分析:</h4>
            <div class="structured-analysis">
                <p><strong>日銀放鷹與避險升溫，日圓強勢升值</strong><br>日圓兌美元升值<strong>0.53%</strong>至<strong>155.45</strong>，主要受到日本央行總裁植田和男暗示可能升息的言論激勵。同時，全球股市波動加劇也推升了日圓的避險需求。美元指數在降息預期與避險買盤間拉鋸，微跌<strong>0.04%</strong>，維持在100下方整理。</p>
                <p><strong>外資匯出壓力增，台幣轉弱貶值</strong><br>台幣兌美元貶值<strong>0.26%</strong>至<strong>31.395</strong>，與台股大跌同步。深層解讀顯示，外資在現貨市場大幅賣超並匯出資金，是導致台幣轉弱的主因。若外資持續提款，台幣短線仍面臨貶值壓力，31.5元關卡將是重要觀察點，需留意央行是否進場調節。</p>
            </div>
        </div>
    </section>

    <!-- --- v3.1.9 替換: 整個第7章區塊使用 v2.8 格式 --- -->
    <!-- --- v3.1.10 修正: 將 [買進] 改為 [看多], [賣出] 改為 [看空], class buy -> bullish, sell -> bearish --- -->
    <section id="sec-7" class="section-card">
        <h2 style="color: #7c3aed;">
            <span style="margin-right: 0.75rem;">🏭</span>第7章｜產業多空展望
        </h2>

        <!-- TL;DR -->
        <div class="tldr-block" style="background: #faf5ff;">
            <ul>
                <li style="color: #7c3aed;"><strong>[看多]</strong> AI軟體 (SNPS.US): 輝達入股深化AI合作，技術實力獲背書，長期成長動能強勁。</li>
                <li style="color: #7c3aed;"><strong>[看多]</strong> AI生態 (GOOGL.US): 與亞馬遜聯手推多雲服務，股價創新高，聯合創辦人高點捐贈顯示信心。</li>
                <li style="color: #7c3aed;"><strong>[看空]</strong> 加密貨幣 (MSTR.US): 比特幣重挫拖累股價崩跌，市場避險情緒升溫，短線面臨修正壓力。</li>
                <li style="color: #7c3aed;"><strong>[看空]</strong> 航太製造 (EADSY.US): A320爆發軟體瑕疵衝擊股價，品質疑慮揮之不去，恐影響交機目標。</li>
            </ul>
        </div>

        <!-- 看多推薦第一檔 -->
        <div class="stock-recommendation bullish">
            <h3 class="recommendation-title bullish">[看多]:AI軟體 (以Synopsys (SNPS.US)為例)</h3>

            <div class="overflow-x-auto">
                <table class="analysis-table">
                    <thead>
                        <tr>
                            <th>分析維度</th>
                            <th>觀點與數據</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="font-semibold text-slate-600">強強聯手</td>
                            <td>輝達宣布投資20億美元入股，深化雙方在AI晶片設計軟體領域的合作。</td>
                        </tr>
                        <tr>
                            <td class="font-semibold text-slate-600">技術背書</td>
                            <td>獲得AI龍頭輝達的資金與技術支持，進一步鞏固其在EDA市場的領導地位。</td>
                        </tr>
                        <tr>
                            <td class="font-semibold text-slate-600">長期展望</td>
                            <td>隨著AI晶片設計需求爆炸性成長，Synopsys將是主要受惠者之一。</td>
                        </tr>
                        <tr>
                            <td class="font-semibold text-slate-600">
                                <div class="link-button-container">
                                    <a href="https://tw.tradingview.com/symbols/NASDAQ-SNPS/financials-overview/" target="_blank" class="link-button fundamental">
                                        基本面
                                        <span class="link-button-subtitle">按此看財務數據</span>
                                    </a>
                                    <a href="https://tw.tradingview.com/symbols/NASDAQ-SNPS/" target="_blank" class="link-button technical">
                                        技術面
                                        <span class="link-button-subtitle">按此看技術圖表</span>
                                    </a>
                                </div>
                            </td>
                            <td>
                                Synopsys (SNPS.US) 獲得輝達入股是極大的利多訊號，確認了其在AI生態系中的關鍵地位。這不僅帶來資金，更重要的是技術整合的綜效。新聞指出雙方將共同開發新一代AI設計工具，這將為未來的營收成長奠定堅實基礎。<br><br>
                                股價受利多激勵可望挑戰新高，中長線趨勢看好。
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <p class="text-xs text-right" style="color: #64748b; margin-top: 0.5rem;">資料來源: TradingView</p>

            <div class="analysis-block">
                <h4>深度分析:</h4>
                <div class="structured-analysis">
                    <p><strong>輝達重金入股，Synopsys護城河再升級</strong><br>Synopsys (SNPS.US) 與輝達的結盟將加速AI晶片設計自動化的進程。在晶片複雜度日益增加的趨勢下，EDA工具的重要性不可言喻。輝達的入股不僅是財務投資，更是策略綁定，確保Synopsys在未來的AI運算競賽中立於不敗之地，為股價提供強力支撐。</p>
                </div>
            </div>
        </div>

        <!-- 看多推薦第二檔 -->
        <div class="stock-recommendation bullish">
            <h3 class="recommendation-title bullish">[看多]:AI生態 (以Alphabet (GOOGL.US)為例)</h3>

            <div class="overflow-x-auto">
                <table class="analysis-table">
                    <thead>
                        <tr>
                            <th>分析維度</th>
                            <th>觀點與數據</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="font-semibold text-slate-600">雲端結盟</td>
                            <td>與亞馬遜AWS聯手推出多雲端網路服務，強化企業雲端架構的可靠性。</td>
                        </tr>
                        <tr>
                            <td class="font-semibold text-slate-600">股價創高</td>
                            <td>股價近期創下歷史新高，顯示市場對其AI與雲端業務的信心回升。</td>
                        </tr>
                        <tr>
                            <td class="font-semibold text-slate-600">創辦人動作</td>
                            <td>聯合創辦人布林捐贈股票，通常發生在股價表現強勁之時，側面印證公司價值。</td>
                        </tr>
                         <tr>
                            <td class="font-semibold text-slate-600">
                                <div class="link-button-container">
                                    <a href="https://tw.tradingview.com/symbols/NASDAQ-GOOGL/financials-overview/" target="_blank" class="link-button fundamental">
                                        基本面
                                        <span class="link-button-subtitle">按此看財務數據</span>
                                    </a>
                                    <a href="https://tw.tradingview.com/symbols/NASDAQ-GOOGL/" target="_blank" class="link-button technical">
                                        技術面
                                        <span class="link-button-subtitle">按此看技術圖表</span>
                                    </a>
                                </div>
                            </td>
                            <td>
                                Alphabet (GOOGL.US) 在AI與雲端領域動作頻頻。與競爭對手亞馬遜的合作顯示出市場擴大的可能性。新聞指出其股價創新高後創辦人捐款，顯示內部人對公司價值的肯定。TPU供應鏈的擴大也進一步鞏固其硬體實力。<br><br>
                                技術面呈現強勢多頭排列，基本面與消息面同步偏多。
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <p class="text-xs text-right" style="color: #64748b; margin-top: 0.5rem;">資料來源: TradingView</p>

            <div class="analysis-block">
                <h4>深度分析:</h4>
                <div class="structured-analysis">
                    <p><strong>雲端競合策略靈活，Alphabet續創新高</strong><br>Alphabet (GOOGL.US) 透過與亞馬遜的合作，展現了在多雲環境下的靈活策略，有助於爭取更多企業客戶。同時，其在自研晶片與AI模型的持續投入，正在轉化為實質的市場競爭力。股價創高反映了資金對其重返榮耀的期待，後市仍具上漲空間。</p>
                </div>
            </div>
        </div>

        <!-- 看空推薦第一檔 -->
        <div class="stock-recommendation bearish">
            <h3 class="recommendation-title bearish">[看空]:加密貨幣 (以MicroStrategy (MSTR.US)為例)</h3>

            <div class="overflow-x-auto">
                <table class="analysis-table">
                    <thead>
                        <tr>
                            <th>分析維度</th>
                            <th>觀點與數據</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="font-semibold text-slate-600">幣價重挫</td>
                            <td>比特幣失守9.5萬美元關卡，連帶拖累持有大量比特幣的MicroStrategy股價崩跌。</td>
                        </tr>
                        <tr>
                            <td class="font-semibold text-slate-600">槓桿風險</td>
                            <td>公司高度槓桿操作比特幣，在幣價下跌時面臨資產減值與融資壓力。</td>
                        </tr>
                        <tr>
                            <td class="font-semibold text-slate-600">避險情緒</td>
                            <td>市場風險偏好下降，資金撤離高波動資產，加密貨幣概念股首當其衝。</td>
                        </tr>
                         <tr>
                            <td class="font-semibold text-slate-600">
                                <div class="link-button-container">
                                    <a href="https://tw.tradingview.com/symbols/NASDAQ-MSTR/financials-overview/" target="_blank" class="link-button fundamental">
                                        基本面
                                        <span class="link-button-subtitle">按此看財務數據</span>
                                    </a>
                                    <a href="https://tw.tradingview.com/symbols/NASDAQ-MSTR/" target="_blank" class="link-button technical">
                                        技術面
                                        <span class="link-button-subtitle">按此看技術圖表</span>
                                    </a>
                                </div>
                            </td>
                            <td>
                                MicroStrategy (MSTR.US) 的股價與比特幣高度連動。新聞指出比特幣跌慘，導致其股價跟著崩跌。在加密貨幣市場回檔修正之際，MSTR的高溢價與高槓桿特性使其面臨巨大的下行風險。<br><br>
                                技術面出現頭部訊號，股價跌破短期均線，建議避開。
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <p class="text-xs text-right" style="color: #64748b; margin-top: 0.5rem;">資料來源: TradingView</p>

            <div class="analysis-block">
                 <h4>深度分析:</h4>
                <div class="structured-analysis">
                    <p><strong>幣圈寒冬降臨，MicroStrategy資產縮水風險增</strong><br>MicroStrategy (MSTR.US) 過度押注比特幣的策略在牛市時是助燃劑，但在熊市時則成為致命傷。隨著比特幣價格大幅回調，市場對其償債能力與資產價值的擔憂升溫。在避險情緒主導下，資金將持續流出此類高波動標的，股價修正壓力沉重。</p>
                </div>
            </div>
        </div>

        <!-- 看空推薦第二檔 -->
        <div class="stock-recommendation bearish">
            <h3 class="recommendation-title bearish">[看空]:航太製造 (以Airbus (EADSY.US)為例)</h3>

            <div class="overflow-x-auto">
                <table class="analysis-table">
                    <thead>
                        <tr>
                            <th>分析維度</th>
                            <th>觀點與數據</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="font-semibold text-slate-600">產品瑕疵</td>
                            <td>熱銷機型A320再次爆發軟體瑕疵，引發市場對其品質控管的疑慮。</td>
                        </tr>
                        <tr>
                            <td class="font-semibold text-slate-600">股價暴跌</td>
                            <td>受負面消息衝擊，股價單日暴跌逾9%，顯示投資人信心潰散。</td>
                        </tr>
                        <tr>
                            <td class="font-semibold text-slate-600">交機變數</td>
                            <td>頻繁的技術問題可能影響年度交機目標的達成，進而衝擊營收與獲利。</td>
                        </tr>
                         <tr>
                            <td class="font-semibold text-slate-600">
                                <div class="link-button-container">
                                    <a href="https://tw.tradingview.com/symbols/OTC-EADSY/financials-overview/" target="_blank" class="link-button fundamental">
                                        基本面
                                        <span class="link-button-subtitle">按此看財務數據</span>
                                    </a>
                                    <a href="https://tw.tradingview.com/symbols/OTC-EADSY/" target="_blank" class="link-button technical">
                                        技術面
                                        <span class="link-button-subtitle">按此看技術圖表</span>
                                    </a>
                                </div>
                            </td>
                            <td>
                                Airbus (EADSY.US) 作為航太巨頭，近期頻頻出現品質問題。新聞指出軟體Bug剛修完又爆瑕疵，重創市場信心。在波音面臨困境之際，空巴本應受惠，但自身問題頻傳使其錯失擴大市占良機。<br><br>
                                股價長黑摜破支撐，空方力道強勁，建議觀望。
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <p class="text-xs text-right" style="color: #64748b; margin-top: 0.5rem;">資料來源: TradingView</p>

            <div class="analysis-block">
                <h4>深度分析:</h4>
                <div class="structured-analysis">
                    <p><strong>品質風暴再起，空巴飛安信譽蒙塵</strong><br>Airbus (EADSY.US) 的A320瑕疵事件不僅影響短期股價，更可能損害航空公司的採購意願。在航空業復甦的關鍵時刻，任何交機延誤都可能導致訂單流失。市場對其管理層解決問題的能力產生質疑，在問題徹底解決前，股價恐難有表現。</p>
                </div>
            </div>
        </div>
    </section>


    <!-- 頁尾 -->
    <footer class="text-center" style="margin-top: 3rem; padding-top: 2rem; border-top: 1px solid #e2e8f0;">
        <p class="text-xs" style="color: #64748b;">© 2025 金融市場研究團隊 — 洞察•解構•透視全球資產</p>
        <p class="text-xs" style="color: #64748b; margin-top: 0.5rem;">本報告僅為資訊分享,不構成任何投資建議,投資人應秉持獨立判斷,審慎評估並自負投資風險。</p>
    </footer>

</div>

<!-- 回頂按鈕 -->
<button class="back-to-top" onclick="window.scrollTo({top: 0, behavior: 'smooth'})" title="回到頂部" style="display: none;">↑</button>

<script>
// 進度條功能
function updateProgressBar() {
    const winScroll = document.body.scrollTop || document.documentElement.scrollTop;
    const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
    const scrolled = (winScroll / height) * 100;
    const progressBar = document.getElementById("progressBar");
    if (progressBar) { 
        progressBar.style.width = scrolled + "%";
        progressBar.style.opacity = scrolled > 0 ? "1" : "0";
    }
}
window.onscroll = function() { updateProgressBar(); };


// --- 穩健性: 確保 DOM 載入後才綁定事件 ---
window.addEventListener('load', function() {

    // 智能下載功能
    const smartDownloadBtn = document.getElementById('smartDownloadBtn');
    if (smartDownloadBtn) {
        smartDownloadBtn.addEventListener('click', function() {
            const element = document.createElement('a');
            const dateStr = '20251202'; 
            const filename = dateStr + '.html'; 

            // Temporarily hide elements that shouldn't be in the downloaded file
            const progressBar = document.getElementById('progressBar');
            const backToTopButton = document.querySelector('.back-to-top');
            const originalProgressBarStyle = progressBar ? progressBar.style.display : '';
            const originalBackToTopStyle = backToTopButton ? backToTopButton.style.display : '';

            if (progressBar) progressBar.style.display = 'none';
            if (backToTopButton) backToTopButton.style.display = 'none';

            // Get the HTML content AFTER hiding elements
            const content = document.documentElement.outerHTML;

            // Restore elements
            if (progressBar) progressBar.style.display = originalProgressBarStyle;
            if (backToTopButton) backToTopButton.style.display = originalBackToTopStyle;


            const file = new Blob([content], {type: 'text/html;charset=utf-8'});
            element.href = URL.createObjectURL(file);
            element.download = filename; 
            document.body.appendChild(element);
            element.click();
            document.body.removeChild(element);
            URL.revokeObjectURL(element.href);
        });
    } 

    // 平滑滾動導航
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute('href'));
            if (target) {
                const offset = 120; 
                const bodyRect = document.body.getBoundingClientRect().top;
                const elementRect = target.getBoundingClientRect().top;
                const elementPosition = elementRect - bodyRect;
                const offsetPosition = elementPosition - offset;
                window.scrollTo({ top: offsetPosition, behavior: 'smooth' });
            }
        });
    });

    // 載入完成後隱藏進度條 (fade out effect)
    const progressBar = document.getElementById("progressBar");
     if (progressBar) { 
        progressBar.style.transition = 'opacity 0.5s ease-out'; 
        setTimeout(function() {
            progressBar.style.opacity = "0";
        }, 500); 
     }
}); 
</script>


</body></html>